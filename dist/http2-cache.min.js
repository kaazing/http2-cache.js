!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).http2Cache=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var http2=require("http2.js");function Http2CacheAgent(){http2.Agent.apply(this,arguments)}Http2CacheAgent.prototype=Object.create(http2.Agent.prototype,{}),exports.Agent=Http2CacheAgent},{"http2.js":51}],2:[function(require,module,exports){var EventEmitter=require("events").EventEmitter,util=require("util"),redefine=require("./utils").redefine;function CacheListener(configuration){var cl=this;redefine(configuration.cache,"put",function(k,v){var self=this;return new Promise(function(resolve,reject){self._put(k,v).then(function(){self.debug&&self._log.debug("Cached response: "+k.href),cl.emit("cached",k.href),resolve()}).catch(reject)})}),redefine(configuration.cache,"match",function(k){var self=this;return new Promise(function(resolve,reject){self._match(k).then(function(response){self.debug&&(response?self._log.debug("Using cached response for request to: "+k.href):self._log.debug("Cache miss for request: "+k.href)),resolve(response)}).catch(reject)})}),EventEmitter.call(this)}util.inherits(CacheListener,EventEmitter),module.exports={CacheListener:CacheListener}},{"./utils":7,events:45,util:124}],3:[function(require,module,exports){var Dict=require("collections/dict"),logger=require("./logger"),Map=(require("object-keys"),require("collections/map"));var PARSE_CACHE_CONTROL_REG=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g;function parseCacheControl(field){if("string"!=typeof field)return null;var header={},error=field.replace(PARSE_CACHE_CONTROL_REG,function($0,$1,$2,$3){var value=$2||$3;return header[$1]=!value||value.toLowerCase(),""}),maxAgeHeaderName=function(header){return header["max-age"]&&header["s-maxage"]&&parseInt(header["max-age"],10)<parseInt(header["s-maxage"],10)?"s-maxage":"max-age"}(header),maxAge=header[maxAgeHeaderName];if(maxAge){if(maxAge=function(maxAge){return"number"==typeof maxAge?maxAge:parseInt(maxAge,10)}(maxAge),isNaN(maxAge))return null;maxAge&&(header["s-maxage"]&&(header["s-maxage"]=maxAge),header["max-age"]=maxAge)}return error?null:header}function getCacheControlHeaders(response){return response.headers["cache-control"]}var RequestInfo=function(method,href,headers){this.method=method,this.href=href,this.headers=function(requestInfo,headers){if(headers instanceof Map){var headerMap=headers;headers={},headerMap.forEach(function(value,key){headers[key]=value})}var requestInfoHeaders=requestInfo.headers||{};return headers&&Object.keys(headers).forEach(function(key){Object.defineProperty(requestInfoHeaders,key,{configurable:!1,writable:!1,value:headers[key]})}),requestInfoHeaders}(this,headers);var cacheControlHeader=getCacheControlHeaders(this);this.cacheDirectives=parseCacheControl(cacheControlHeader),this.hash=this.method+"^"+this.href};function Cache(options){options=options||{},this.debug=options.debug,this._log=options.log||(this.debug?logger.consoleLogger:logger.defaultLogger),this._requestInfoToResponses=new Dict,this._requestInfoRevalidating=new Dict}var cp=Cache.prototype;function getExpireTime(response,cacheDirectives,revalidating){var maxAgeAt=-1,staleButRevalidateAt=-1,date=response.headers.date;return date=date?new Date(date).getTime():(new Date).getTime(),cacheDirectives["max-age"]&&(maxAgeAt=date+1e3*cacheDirectives["max-age"]),revalidating&&cacheDirectives["stale-while-revalidate"]&&(staleButRevalidateAt=date+1e3*cacheDirectives["stale-while-revalidate"]),staleButRevalidateAt<maxAgeAt?maxAgeAt:staleButRevalidateAt}function satisfiesRequest(requestInfo,candidate,candidateHash,revalidating){var currentTime=(new Date).getTime();return getExpireTime(candidate,parseCacheControl(getCacheControlHeaders(candidate)),revalidating)>currentTime&&requestInfo.hash===candidateHash}cp.setDebug=function(debug){this._debug=debug};var CACHEABLE_BY_DEFAULT_STATUS_CODES=[200,203,204,206,300,301,404,405,410,414,501];function isCacheableResponse(response,cacheResponseDirectives){if(-1===CACHEABLE_BY_DEFAULT_STATUS_CODES.indexOf(response.statusCode))return!1;var cacheControlHeaders=getCacheControlHeaders(response);if(cacheControlHeaders){if((cacheResponseDirectives=cacheResponseDirectives||parseCacheControl(cacheControlHeaders))["max-age"])return!0;if(cacheResponseDirectives["stale-while-revalidate"])return!0}return!1}cp.match=function(requestInfo){var self=this;return new Promise(function(resolve,reject){var response=null;if(requestInfo instanceof RequestInfo){var requestCacheDirectives=requestInfo.cacheDirectives,requestIsRevalidating=self.isRevalidating(requestInfo);if(null===requestCacheDirectives||!requestCacheDirectives["no-cache"]&&!requestCacheDirectives["no-store"])for(var candidate,candidateHash,candidates=self._requestInfoToResponses.get(requestInfo.hash)||new Dict,cadidatesHashs=candidates.keys();null===response&&(candidateHash=cadidatesHashs.next())&&!1===candidateHash.done;)(candidate=candidateHash.value&&candidates.get(candidateHash.value))&&satisfiesRequest(requestInfo,candidate,candidateHash.value,requestIsRevalidating)&&(response=candidate);resolve(response)}else reject(new TypeError("Invalid requestInfo argument"))})},cp.clearExpired=function(){var self=this;self._requestInfoToResponses.forEach(function(candidates){candidates.forEach(function(response,requestInfoHash){(function(candidate,currentTime){return getExpireTime(candidate,parseCacheControl(getCacheControlHeaders(candidate)))<currentTime})(response,(new Date).getTime())&&(self._debug&&self._log.debug("Evicted Response from cache for requestInfo Hash: "+requestInfoHash),self._requestInfoToResponses.delete(requestInfoHash))})})},cp.clearRevalidates=function(){this._requestInfoRevalidating=new Dict},cp.isRevalidating=function(requestInfo){return!!this._requestInfoRevalidating.get(requestInfo.hash)},cp.revalidate=function(requestInfo){var revalidate=this._requestInfoRevalidating.get(requestInfo.hash)||0;this._requestInfoRevalidating.get(requestInfo.hash)?this._debug&&this._log.debug("Updated requestInfo for revalidating with hash: "+requestInfo.hash):this._debug&&this._log.debug("Added requestInfo to revalidate with hash: "+requestInfo.hash),revalidate++,this._requestInfoRevalidating.set(requestInfo.hash,revalidate)},cp.validated=function(requestInfo){var revalidate=this._requestInfoRevalidating.get(requestInfo.hash)||0;0<revalidate&&(revalidate--,this._debug&&this._log.debug("Evicted requestInfo from revalidate with hash: "+requestInfo.hash),0<revalidate?this._requestInfoRevalidating.set(requestInfo.hash,revalidate):this._requestInfoRevalidating.delete(requestInfo.hash))},cp.put=function(requestInfo,response){var self=this;return new Promise(function(resolve,reject){if(requestInfo instanceof RequestInfo){var cacheResponseDirectives=parseCacheControl(getCacheControlHeaders(response));if(!1===isCacheableResponse(response,cacheResponseDirectives))reject(new Error("Not Cacheable response"));else{var candidates=self._requestInfoToResponses.get(requestInfo.hash)||new Dict,responseHash=requestInfo.hash;self._debug&&self._log.debug("Adding cache entry to:"+requestInfo.hash+"/"+responseHash),candidates.set(responseHash,response),self._requestInfoToResponses.set(requestInfo.hash,candidates),resolve()}}else reject(new TypeError("Invalid requestInfo argument"))})},module.exports={RequestInfo:RequestInfo,Cache:Cache,parseCacheControl:parseCacheControl,satisfiesRequest:satisfiesRequest,isCacheableResponse:isCacheableResponse}},{"./logger":6,"collections/dict":24,"collections/map":33,"object-keys":65}],4:[function(require,module,exports){var websocket=require("websocket-stream"),keys=require("object-keys"),assign=require("object-assign"),http2=require("http2.js"),util=require("util"),EventEmitter=require("events").EventEmitter,InvalidStateError=require("./errors.js").InvalidStateError,RequestInfo=require("./cache.js").RequestInfo,Cache=require("./cache.js").Cache,Agent=require("./agent").Agent,logger=require("./logger"),parseUrl=require("./utils").parseUrl,getOrigin=require("./utils.js").getOrigin,mergeTypedArrays=require("./utils.js").mergeTypedArrays,CacheListener=(require("./utils.js").defaultPort,require("./cache-listener").CacheListener);function Configuration(options){this.options=assign({},this.defaultOptions),this.setOptions(options),EventEmitter.call(this),this._proxyMap={},this._pushRequests={},this._activeConfigurationCnt=0,this._activeTransportConnections={},this._log=logger.consoleLogger,this.setDebugLevel(this.options.clientLogLevel||this.options.debug),this.cache=options.cache||new Cache({debug:this.debug,log:this._log}),this.cacheListener=new CacheListener(this),this.agent=new Agent({log:this._log})}util.inherits(Configuration,EventEmitter);var confProto=Configuration.prototype;confProto.defaultOptions={debug:!1,reconnect:!0,reconnectInterval:100,maximumReconnectInterval:4e3,accelerationStrategy:"always"},confProto.setOptions=function(options){return assign(this.options,options),this},confProto.debug=!1,confProto.setDebugLevel=function(level){level="string"==typeof level?level:!0===level?"info":null,this._log&&this._log.hasOwnProperty("debugLevel")&&(this._log.debugLevel=level),this.options.debug=level,this.debug=!!this.options.debug},confProto.configuring=function(){this._activeConfigurationCnt++},confProto.configured=function(){this._activeConfigurationCnt--,0===this._activeConfigurationCnt&&this.emit("completed")},confProto.isConfiguring=function(){return 0<this._activeConfigurationCnt},confProto.getTransport=function(url){var that=this,uri=parseUrl(url),activeTransportConnections=that._activeTransportConnections,hasExistingTransport=activeTransportConnections.hasOwnProperty(uri.href),hasActiveTransport=hasExistingTransport&&!!activeTransportConnections[uri.href].writable;if(!1===hasExistingTransport||!1===hasActiveTransport){if(hasExistingTransport?(that.debug&&that._log.info("Re-Opening transport: "+uri.href),that.cache.clearRevalidates()):that.debug&&that._log.info("Opening transport: "+uri.href),"ws:"===uri.protocol||"wss:"===uri.protocol)activeTransportConnections[uri.href]=websocket(uri.href,"h2",{perMessageDeflate:!1===that.debug});else{if("tcp:"!==uri.protocol)throw new Error("Unrecognized transport protocol: "+uri.protocol+", for transport: "+uri.href);activeTransportConnections[uri.href]=require("net").connect({host:uri.hostname,port:uri.port})}var transport=activeTransportConnections[uri.href];transport.on("error",function(){if("connected"===that.options.accelerationStrategy){var proxyUrls=that.getTransportUrls(url);proxyUrls.forEach(that.removeTransportUrl.bind(that)),transport.on("open",function(){that.addTransportUrls(proxyUrls,url)})}})}return activeTransportConnections[uri.href]},confProto.addTransportUrl=function(url,transport){var uri=parseUrl(url);return this._proxyMap[uri.href]=transport,this},confProto.addTransportUrls=function(urls,transport){var that=this;return urls.forEach(function(url){that.addTransportUrl(url,transport)}),this},confProto.removeTransportUrl=function(url){var uri=parseUrl(url);return delete this._proxyMap[uri.href],this},confProto.getTransportUrl=function(url){var uri=parseUrl(url),proxyUrl=keys(this._proxyMap).reduce(function(result,value){return 0===uri.href.indexOf(value)?value:result},!1);return proxyUrl&&this._proxyMap[proxyUrl]},confProto.getTransportUrls=function(transport){var _proxyMap=this._proxyMap;return keys(_proxyMap).filter(function(url){return transport===_proxyMap[url]})},confProto.onPush=function(pushRequest){var that=this,cache=that.cache,origin=getOrigin(pushRequest.scheme+"://"+pushRequest.headers.host);pushRequest.href=origin+pushRequest.url,that.debug&&that._log.info("Received push promise for: "+pushRequest.href);var requestInfo=new RequestInfo(pushRequest.method,pushRequest.href,pushRequest.headers);cache.revalidate(requestInfo),pushRequest.on("response",function(response){response.on("data",function(data){response.data=mergeTypedArrays(response.data,data)}),response.on("end",function(){cache.put(requestInfo,response).then(function(){that._log.debug("Cache updated via push for proxied XHR("+pushRequest.href+")")},function(cacheError){that._log.debug("Cache error via push for proxied XHR("+pushRequest.href+"):"+cacheError.message)}).then(function(){cache.validated(requestInfo)})}),response.on("error",function(e){that._log.warn("Server push stream error: "+e),cache.validated(requestInfo)})})},confProto.openH2StreamForPush=function(pushUrl,proxyTransportUrl){var that=this,options=that.options,pushUri=parseUrl(pushUrl);that._log.debug("Opening h2 channel for Push Promises: "+pushUri.href);var transport=that.getTransport(proxyTransportUrl),pushRequest=that._pushRequests[pushUri.href]=that._pushRequests[pushUri.href]||{failures:[],reconnectTimer:null,opened:!1,connecting:!1},reopenH2StreamForPush=function(reason){if(that._log.info(pushUrl+" push channel closed."),pushRequest.opened=!1,that.cache.clearRevalidates(),reason)if(that._log.warn("Push channel stream reason: "+reason),pushRequest.failures.push(reason),options.reconnect&&!pushRequest.connecting){var reOpendelay=Math.min(pushRequest.failures.length*options.reconnectInterval,options.maximumReconnectInterval);that._log.info("Push channel stream will re-open in "+reOpendelay+"ms ."),clearTimeout(pushRequest.reconnectTimer),pushRequest.reconnectTimer=setTimeout(that.openH2StreamForPush.bind(that,pushUrl,proxyTransportUrl),reOpendelay)}else that._log.warn("Push channel stream already connecting.")};return function(){if(that._log.info("Push channel will open: "+pushUri.href),pushRequest.opened)throw new Error("Server push stream already opened for push "+pushUri.href);if(pushRequest.connecting)throw new Error("Server push stream is already connecting for push "+pushUri.href);pushRequest.connecting=!0,pushRequest.opened=!1;var request=http2.raw.request({hostname:pushUri.hostname,port:pushUri.port,path:pushUri.path,transportUrl:proxyTransportUrl,transport:transport,agent:that.agent},function(response){that._log.debug("Push channel connected: "+pushUri.href),pushRequest.connecting=!1,response.on("open",function(){pushRequest.opened=!0,pushRequest.failures.length=0}),response.on("finish",function(err){reopenH2StreamForPush(err)}),response.on("close",function(err){reopenH2StreamForPush(err)}),response.on("error",function(err){that._log.error("Push channel response closed: ",err),reopenH2StreamForPush(err)})});return request.on("error",function(err){that._log.error("Push channel request error: ",err),pushRequest.connecting=!1,reopenH2StreamForPush(err)}),request.on("push",function(request){that._log.debug("Push channel received: "+request),that.onPush(request),that.emit("push",request)}),request.end(),transport.on("close",function(err){that._log.debug("Push channel request transport closed: ",err),pushRequest.connecting=!1,reopenH2StreamForPush(err)}),pushRequest.request=request,pushRequest.request}()},confProto.parseConfig=function(config){try{config="string"==typeof config?JSON.parse(config):config}catch(JsonErr){throw new Error("Unable to parse config: "+config)}return config},confProto.addConfig=function(config){var that=this;if((config=that.parseConfig(config)).pushURL&&(that._log.warn('XMLHttpRequest Http2-Cache configuration "pushURL" is now "push"'),config.push=config.pushURL,delete config.pushURL),config.hasOwnProperty("clientLogLevel")&&(that.setDebugLevel(config.clientLogLevel),that.options.clientLogLevel=config.clientLogLevel),keys(that.defaultOptions).forEach(function(configOption){config.hasOwnProperty(configOption)&&(config.options=config.options||{},config.options[configOption]=config[configOption])}),config.hasOwnProperty("options")&&config.options&&that.setOptions(config.options),config.hasOwnProperty("transport")&&config.transport)try{var transportUri=parseUrl(config.transport);config.hasOwnProperty("proxy")&&that.addTransportUrls(config.proxy,transportUri),config.hasOwnProperty("push")&&config.push&&that.openH2StreamForPush(parseUrl(config.push),transportUri)}catch(err){that._log.error('XMLHttpRequest Http2-Cache configuration "transport" error',err)}},confProto.fetchConfig=function(url){var that=this,xhr=new XMLHttpRequest;xhr._open("GET",url),that.configuring(),xhr.addEventListener("load",function(){if(xhr.readyState===XMLHttpRequest.DONE){var status=xhr.status;if(200!==status)throw that.configured(),new InvalidStateError("Failed to load configuration "+url+", status code: "+status);that.addConfig(xhr.response),that.configured()}},!0),xhr._send()},confProto.configure=function(urls){if(!(urls instanceof Array))throw new SyntaxError("Invalid arg: "+urls);for(var cntI=urls.length,i=0;i<cntI;i++)if("string"==typeof urls[i])this.fetchConfig(urls[i]);else{if("object"!=typeof urls[i])throw new SyntaxError("Invalid arg: "+urls);this.configuring(),this.addConfig(urls[i]),this.configured()}},module.exports=Configuration},{"./agent":1,"./cache-listener":2,"./cache.js":3,"./errors.js":5,"./logger":6,"./utils":7,"./utils.js":7,events:45,"http2.js":51,net:16,"object-assign":64,"object-keys":65,util:124,"websocket-stream":126}],5:[function(require,module,exports){module.exports={InvalidStateError:function(message){this.name="InvalidStateError",this.message=message,this.stack=(new Error).stack},TypeError:function(message){this.name="TypeError",this.message=message,this.stack=(new Error).stack}}},{}],6:[function(require,module,exports){function noop(){}var defaultLogger={fatal:noop,error:noop,warn:noop,info:noop,debug:noop,trace:noop,child:function(){return this}},consoleLogger={debugLevel:"info",fatal:console.error,error:console.error,warn:console.warning||console.info,info:function(data,ctx){var debug=console.debug||console.info;if("info"===consoleLogger.debugLevel||"trace"===consoleLogger.debugLevel||"debug"===consoleLogger.debugLevel){var args="string"==typeof ctx?[ctx,data]:arguments;debug.apply(console,args)}},debug:function(data,ctx){var debug=console.debug||console.info;if("trace"===consoleLogger.debugLevel||"debug"===consoleLogger.debugLevel){var args="string"==typeof ctx?[ctx,data]:arguments;debug.apply(console,args)}},trace:function(data,ctx){console.debug||console.info;"trace"===consoleLogger.debugLevel&&consoleLogger.debug(data,ctx)},child:function(msg){return"trace"===consoleLogger.debugLevel&&console.info(msg),this}};module.exports={consoleLogger:consoleLogger,defaultLogger:defaultLogger}},{}],7:[function(require,module,exports){var url=require("url"),util=require("util"),InvalidStateError=require("./errors").InvalidStateError,resolvePort=function(u){var port=(u=u instanceof url.constructor?u:url.parse(u)).port;return null===port&&(port="ws:"===u.protocol||"http:"===u.protocol?80:443),port},parseUrl=function(href){var uri=href instanceof url.constructor?href:url.parse(href);return uri.port=resolvePort(uri),null===uri.hostname&&"undefined"!=typeof window&&(uri.protocol=window.location.protocol,uri.hostname=window.location.hostname,uri.port=window.location.port,uri.host=uri.hostname+":"+uri.port,uri.href=uri.protocol+"//"+uri.host+uri.href),uri.origin=uri.hostname+":"+uri.port,uri.host!==uri.origin&&(uri.href=uri.href.replace(uri.protocol+"//"+uri.host,uri.protocol+"//"+uri.origin),uri.host=uri.hostname+":"+uri.port),uri};require("string.fromcodepoint");var Utf8ArrayToStr=function(array){for(var c,char2,char3,char4,out="",len=array.length,i=0;i<len;)switch((c=array[i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=array[i++],out+=String.fromCharCode((31&c)<<6|63&char2);break;case 14:char2=array[i++],char3=array[i++],out+=String.fromCharCode((15&c)<<12|(63&char2)<<6|(63&char3)<<0);break;case 15:char2=array[i++],char3=array[i++],char4=array[i++],out+=String.fromCodePoint((7&c)<<18|(63&char2)<<12|(63&char3)<<6|63&char4)}return out};module.exports={parseUrl:parseUrl,redefine:function(obj,prop,value){obj[prop]&&(obj["_"+prop]=obj[prop]),Object.defineProperty(obj,prop,{value:value,enumerable:obj.propertyIsEnumerable(prop),configurable:!0})},defineGetter:function(obj,prop,getter){obj[prop]&&(obj["_"+prop]=obj[prop]),Object.defineProperty(obj,prop,{enumerable:!0,configurable:!0,get:getter})},definePrivate:function(obj,prop,value){Object.defineProperty(obj,prop,{value:value,enumerable:!1,configurable:!0})},definePublic:function(obj,prop,value){Object.defineProperty(obj,prop,{value:value,enumerable:!0,configurable:!0})},resolvePort:resolvePort,getOrigin:function(u){return(u=u instanceof url.constructor?u:parseUrl(u)).protocol+"//"+u.hostname+":"+resolvePort(u)},dataToType:function(data,type){switch(type){case"":case"text":return data instanceof Uint8Array?Utf8ArrayToStr(data):data;case"json":return JSON.parse(data);case"arraybuffer":return function(buf){for(var ab=new ArrayBuffer(buf.length),view=new Uint8Array(ab),i=0;i<buf.length;++i)view[i]=buf[i];return ab}(data);case"blob":if("undefined"!=typeof Blob)return new Blob(data);throw new InvalidStateError("Unsupported Response Type: "+type);case"document":if("undefined"!=typeof document&&void 0!==document.implementation&&"function"==typeof document.implementation.createDocument)return document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",data);throw new InvalidStateError("Unsupported Response Type: "+type);default:throw new InvalidStateError("Unexpected Response Type: "+type)}},defaultPort:function(u,port){var parse=u instanceof url.constructor?u:parseUrl(u);return port||(port=resolvePort(u)),(u=u instanceof url.constructor?u:parseUrl(u)).protocol+"//"+u.hostname+":"+port+parse.path},serializeXhrBody:function(headers,body){if("object"==typeof body){var pairEntry,bodyParts=[];if("function"==typeof body.entries){var key,value,iterator=body.entries(),boundary="----webkitformboundary";for(boundary+=body._TestBoundary||(+new Date).toString(16);(pairEntry=iterator.next())&&!1===pairEntry.done;){if(value=pairEntry.value[1],key=pairEntry.value[0],"string"!=typeof value)throw new Error("FormData limited support, only string supported ("+typeof value+")");var field=util.format("\r\n--%s\r\n",boundary);field+=util.format('Content-Disposition: form-data; name="%s"\r\n\r\n',key),field+=value,bodyParts.push(field)}bodyParts.push(util.format("\r\n--%s--",boundary)),body=bodyParts.join(""),headers.set("Content-Type","multipart/form-data; boundary="+boundary)}else Object.keys(body).forEach(function(key){var value=body[key];if("string"!=typeof value)throw new Error("FormData limited support, only string supported ("+typeof value+")");bodyParts.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}),body=bodyParts.join("&")}return body},caseInsensitiveEquals:function(str1,str2){return str1.toUpperCase()===str2.toUpperCase()},mergeTypedArrays:function(a,b){if(!a&&!b)throw"Please specify valid arguments for parameters a and b.";if(!b||0===b.length)return a;if(!a||0===a.length)return b;if(Object.prototype.toString.call(a)!==Object.prototype.toString.call(b))throw"The types of the two arguments passed for parameters a and b do not match.";var c=new a.constructor(a.length+b.length);return 0<c.set.length?(c.set(a,0),c.set(b,a.length)):(a.forEach(function(byte,index){c[index]=byte}),b.forEach(function(byte,index){c[a.length+index]=byte})),c},Utf8ArrayToStr:Utf8ArrayToStr}},{"./errors":5,"string.fromcodepoint":115,url:120,util:124}],8:[function(require,module,exports){var WeakMap=require("collections/weak-map"),XhrInfo=function(){this.storage=new WeakMap};XhrInfo.prototype.get=function(k,p,d){return this.storage.has(k)?this.storage.get(k,d)[p]:null},XhrInfo.prototype.put=function(k,p,v){return this.storage.has(k)||this.storage.set(k,{}),this.storage.get(k)[p]=v},XhrInfo.prototype.clean=function(k){this.storage.delete(k)},module.exports=XhrInfo},{"collections/weak-map":40}],9:[function(require,module,exports){var http2=require("http2.js"),keys=require("object-keys"),redefine=require("./utils").redefine,defineGetter=require("./utils").defineGetter,definePublic=require("./utils").definePublic,definePrivate=require("./utils").definePrivate,dataToType=require("./utils").dataToType,defaultPort=require("./utils").defaultPort,RequestInfo=require("./cache.js").RequestInfo,parseUrl=require("./utils").parseUrl,serializeXhrBody=require("./utils").serializeXhrBody,getOrigin=require("./utils").getOrigin,mergeTypedArrays=require("./utils").mergeTypedArrays,InvalidStateError=require("./errors.js").InvalidStateError,XhrInfo=require("./xhr-info.js"),Map=require("collections/map"),HTTP2_FORBIDDEN_HEADERS=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],HTTP_METHODS=["GET","OPTIONS","HEAD","POST","PUT","DELETE","TRACE","CONNECT"];function ProgressEvent(type){this.type=type,this.target=null}ProgressEvent.prototype.bubbles=!1,ProgressEvent.prototype.cancelable=!1,ProgressEvent.prototype.target=null,module.exports={enableXHROverH2:function(XMLHttpRequest,configuration){var xhrProto=XMLHttpRequest.prototype,xhrInfo=new XhrInfo;function redefineProtoInfo(xhrProto,xhrInfo,property,initalValue){var originalProperty="_"+property;Object.defineProperty(xhrProto,originalProperty,Object.getOwnPropertyDescriptor(xhrProto,property)),Object.defineProperty(xhrProto,property,{get:function(){return xhrInfo.get(this,property)||this[originalProperty]||initalValue},set:function(value){xhrInfo.put(this,property,value)}})}function defineXhrResponse(xhr,response){defineGetter(xhr,"response",function(){var responseType=xhrInfo.get(xhr,"responseType")||"";return dataToType(response.data,responseType)}),defineGetter(xhr,"responseText",function(){var responseType=xhrInfo.get(xhr,"responseType")||"";if(""!==responseType&&"text"!==responseType)throw new InvalidStateError("Failed to read the 'responseText' property from 'XMLHttpRequest': The value is only accessible if the object's 'responseType' is '' or 'text' (was '"+responseType+"')");return dataToType(response.data,"text")})}definePublic(XMLHttpRequest,"configuration",configuration),definePublic(XMLHttpRequest,"proxy",function(configs){return configuration.configure(configs)}),redefineProtoInfo(xhrProto,xhrInfo,"responseType",""),redefineProtoInfo(xhrProto,xhrInfo,"readyState",0),redefineProtoInfo(xhrProto,xhrInfo,"timeout"),redefine(xhrProto,"open",function(method,url,async,username,password){if(method=method.toUpperCase(),HTTP_METHODS.indexOf(method.toUpperCase())<0)throw new SyntaxError("Invalid method: "+method);var parseurl=parseUrl(url);if(void 0===async)async=!0;else if(!1===async)throw new SyntaxError("Synchronous is not supported");xhrInfo.put(this,"method",method),xhrInfo.put(this,"url",url),xhrInfo.put(this,"async",async),xhrInfo.put(this,"headers",new Map),parseurl.host&&username&&password&&(xhrInfo.put(this,"username",username),xhrInfo.put(this,"password",password));var self=this;if(self.onreadystatechange){var orscDelegate=self.onreadystatechange;self.onreadystatechange=function(){1===xhrInfo.get(this,"lastreadystate")&&1===self.readyState||(xhrInfo.put(this,"lastreadystate",self.readyState),orscDelegate())}}xhrInfo.put(this,"lastreadystate",XMLHttpRequest.OPENED),this._changeState(XMLHttpRequest.OPENED)}),redefine(xhrProto,"setRequestHeader",function(name,value){if(2<this.readyState)throw new InvalidStateError("Can not setRequestHeader on unopened XHR");var lcname=name.toLowerCase();if(0<HTTP2_FORBIDDEN_HEADERS.indexOf(lcname)||0===lcname.lastIndexOf("sec-",0)&&0<lcname.replace("sec-","").indexOf(lcname)||0===lcname.lastIndexOf("proxy-",0)&&0<lcname.replace("proxy-","").indexOf(lcname))throw new SyntaxError("Forbidden Header: "+name);var headers=xhrInfo.get(this,"headers");headers||(headers=new Map,xhrInfo.put(this,"headers",headers)),headers.set(lcname,value)}),definePrivate(xhrProto,"_changeState",function(state,options){switch(state){case XMLHttpRequest.UNSENT:case XMLHttpRequest.OPENED:break;case XMLHttpRequest.HEADERS_RECEIVED:!function(xhr,statusCode){defineGetter(xhr,"status",function(){return statusCode});var statusMessage=http2.STATUS_CODES[statusCode];statusMessage?xhr.statusText=statusMessage:configuration._log.warn("Unknown STATUS CODE: "+statusCode)}(this,options.response.statusCode);break;case XMLHttpRequest.LOADING:this.__dispatchEvent(new ProgressEvent("progress"));break;case XMLHttpRequest.DONE:redefine(this,"getResponseHeader",function(header){return options.response.headers[header.toLowerCase()]}),redefine(this,"getAllResponseHeaders",function(){var responseHeaders=options.response.headers;return keys(responseHeaders).filter(function(responseHeader){return"toString"!==responseHeader}).map(function(responseHeader){return responseHeader+": "+responseHeaders[responseHeader]}).join("\n")}),this.__dispatchEvent(new ProgressEvent("load")),this.__dispatchEvent(new ProgressEvent("loadend"));break;default:throw new InvalidStateError("Unexpected XHR _changeState: "+state)}switch(state){case XMLHttpRequest.UNSENT:case XMLHttpRequest.OPENED:break;default:if(this.readyState=state,this.readyState!==state)throw new Error("Unable to update readyState "+this.readyState+" vs "+state)}this.__dispatchEvent(new ProgressEvent("readystatechange"))}),definePrivate(xhrProto,"_sendViaHttp2",function(destination,body,proxyTransportUrl){var self=this,options=configuration.options,cache=configuration.cache,requestUrl=getOrigin(destination.href)+destination.path,requestMethod=xhrInfo.get(self,"method"),requestHeaders=xhrInfo.get(self,"headers"),requestInfo=new RequestInfo(requestMethod,requestUrl,requestHeaders);cache.match(requestInfo).then(function(cachedResponse){var cachedResponseHeader=null!==cachedResponse?cachedResponse.headers:null,revalidateResponse=cachedResponseHeader&&cachedResponseHeader.hasOwnProperty("etag");if(null!==cachedResponse&&!1===revalidateResponse)configuration.debug&&configuration._log.debug("Using cache result for XHR("+destination.href+")"),defineXhrResponse(self,cachedResponse),self.__dispatchEvent(new ProgressEvent("loadstart")),self._changeState(XMLHttpRequest.HEADERS_RECEIVED,{response:cachedResponse}),self._changeState(XMLHttpRequest.LOADING,{response:cachedResponse}),self._changeState(XMLHttpRequest.DONE,{response:cachedResponse});else{null!==cachedResponse&&!0===revalidateResponse&&(cachedResponseHeader.etag&&!1===requestHeaders.has("if-none-match")&&!1===requestHeaders.has("if-match")&&requestHeaders.set("if-none-match",cachedResponseHeader.etag),!0===requestHeaders.has("if-none-match")&&!1===requestHeaders.has("if-unmodified-since")&&!1===requestHeaders.has("if-modified-since")&&(-1!==["GET","HEAD"].indexOf(requestMethod)?requestHeaders.set("if-modified-since",cachedResponseHeader.date):requestHeaders.set("if-unmodified-since",cachedResponseHeader.date))),body&&("undefined"!=typeof HTMLElement&&body instanceof HTMLElement?(requestHeaders.has("content-encoding")||requestHeaders.set("content-encoding","UTF-8"),requestHeaders.has("content-type")||requestHeaders.set("content-type","text/html; charset=utf-8")):requestHeaders.has("content-encoding")||requestHeaders.set("content-encoding","UTF-8"),requestHeaders.set("content-length",body.toString().length));var timeout=xhrInfo.get(self,"timeout"),timeoutTimer=xhrInfo.get(self,"timeoutTimer");if(timeout){var otoDelegate=self.ontimeout;self.ontimeout=function(){cache.validated(requestInfo),xhrInfo.put(self,"timeoutOccured",!0),otoDelegate()},clearTimeout(timeoutTimer),xhrInfo.put(self,"timeoutOccured",!1),timeoutTimer=setTimeout(self.ontimeout,timeout),xhrInfo.put(self,"timeoutTimer",timeoutTimer)}var transport=configuration.getTransport(proxyTransportUrl),request=http2.raw.request({agent:configuration.agent,hostname:destination.hostname,port:destination.port,path:destination.path,method:requestMethod,headers:requestHeaders.toObject(),transport:transport,transportUrl:proxyTransportUrl},function(newResponse){var timeoutOccured=xhrInfo.get(self,"timeoutOccured"),timeoutTimer=xhrInfo.get(self,"timeoutTimer");timeoutOccured||(clearTimeout(timeoutTimer),null!==cachedResponse&&!0===revalidateResponse&&304===newResponse.statusCode?(defineXhrResponse(self,cachedResponse),self._changeState(XMLHttpRequest.HEADERS_RECEIVED,{response:cachedResponse}),self._changeState(XMLHttpRequest.LOADING,{response:cachedResponse}),!0===newResponse.headers.hasOwnProperty("cache-control")&&(cachedResponse.headers["cache-control"]=newResponse.headers["cache-control"]),!0===newResponse.headers.hasOwnProperty("date")&&(cachedResponse.headers.date=newResponse.headers.date),self._changeState(XMLHttpRequest.DONE,{response:cachedResponse})):(defineXhrResponse(self,newResponse),self._changeState(XMLHttpRequest.HEADERS_RECEIVED,{response:newResponse}),newResponse.on("data",function(data){newResponse.data=mergeTypedArrays(newResponse.data,data),self._changeState(XMLHttpRequest.LOADING,{response:newResponse})}),newResponse.on("finish",function(){configuration.debug&&configuration._log.debug("Got response for proxied XHR("+destination.href+")"),cache.put(requestInfo,newResponse).then(function(cachedResponse){configuration._log.debug("Cache updated for proxied XHR("+destination.href+")")}).catch(function(cacheError){configuration._log.debug("Cache error for proxied XHR("+destination.href+"):"+cacheError.message)}).then(function(){self._changeState(XMLHttpRequest.DONE,{response:newResponse}),cache.validated(requestInfo)})})))});request.on("error",function(){cache.validated(requestInfo),"always"===options.accelerationStrategy&&self.__dispatchEvent(new ProgressEvent("error"))}),transport.on("error",function(){self.readyState===XMLHttpRequest.UNSENT&&"connected"===options.accelerationStrategy&&self.send()}),request.on("push",function(respo){configuration.onPush(respo)}),request.end(body||null),cache.revalidate(requestInfo),self.__dispatchEvent(new ProgressEvent("loadstart"))}})}),redefine(xhrProto,"send",function(body){var self=this,url=xhrInfo.get(self,"url"),headers=xhrInfo.get(self,"headers");if(configuration.isConfiguring())configuration.debug&&configuration._log.debug("Delaying XHR("+url+") until configuration completes"),configuration.once("completed",function(){self.send(body)});else{var destination=parseUrl(url),proxyTransportUrl=configuration.getTransportUrl(destination);proxyTransportUrl?(configuration.debug&&configuration._log.debug("Proxying XHR("+url+") via "+proxyTransportUrl),body&&"object"==typeof body&&(body=serializeXhrBody(headers,body)),self._sendViaHttp2(destination,body,proxyTransportUrl)):(configuration.debug&&configuration._log.debug("Sending XHR("+url+") via native stack"),self._open(xhrInfo.get(self,"method"),url,xhrInfo.get(self,"async"),xhrInfo.get(self,"username"),xhrInfo.get(self,"password")),self._responseType=xhrInfo.get(self,"responseType")||"",body&&"undefined"==typeof FormData&&(body=serializeXhrBody(headers,body)),headers.forEach(function(value,key){self._setRequestHeader(key,value)},self),self._send(body))}}),redefine(xhrProto,"addEventListener",function(eventType,listener){this.__listeners||(this.__listeners={},this.__listenedToEvents=new Set),eventType=eventType.toLowerCase(),this.__listeners[eventType]||(this.__listeners[eventType]=[]),this.__listeners[eventType].push(listener),this.__listenedToEvents.add(eventType),this._addEventListener(eventType,listener)}),redefine(xhrProto,"removeEventListener",function(eventType,listener){var index;eventType=eventType.toLowerCase(),this.__listeners[eventType]&&-1!==(index=this.__listeners[eventType].indexOf(listener))&&this.__listeners[eventType].splice(index,1),this._removeEventListener(eventType,listener)}),definePrivate(xhrProto,"__dispatchEvent",function(event){var eventType,j,len,listener,listeners;if(event.currentTarget=event.target=this,eventType=event.type,this.__listeners&&(listeners=this.__listeners[eventType]))for(j=0,len=listeners.length;j<len;j++)(listener=listeners[j]).call(this,event);(listener=this["on"+eventType])&&listener.call(this,event)}),definePrivate(xhrProto,"subscribe",function(cb){var url=defaultPort(xhrInfo.get(this,"url")),subscription=function(requestUrl){requestUrl===url&&cb()};configuration.cacheListener.on("cached",subscription),definePrivate(xhrProto,"unsubscribe",function(){configuration.cacheListener.removeListener("cached",subscription)})})}}},{"./cache.js":3,"./errors.js":5,"./utils":7,"./xhr-info.js":8,"collections/map":33,"http2.js":51,"object-keys":65}],10:[function(require,module,exports){(function(global){"use strict";function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}var util=require("util/"),hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames="foo"===function(){}.name;function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer))))}var assert=module.exports=ok,regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(util.isFunction(func)){if(functionsHaveNames)return func.name;var match=func.toString().match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!util.isFunction(something))return util.inspect(something);var rawname=getName(something);return"[Function"+(rawname?": "+rawname:"")+"]"}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(util.isDate(actual)&&util.isDate(expected))return actual.getTime()===expected.getTime();if(util.isRegExp(actual)&&util.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;var actualIndex=(memos=memos||{actual:[],expected:[]}).actual.indexOf(actual);return-1!==actualIndex&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),function(a,b,strict,actualVisitedObjects){if(null==a||null==b)return!1;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,strict);var key,i,ka=objectKeys(a),kb=objectKeys(b);if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;0<=i;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;0<=i;i--)if(key=ka[i],!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return!1;return!0}(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&!0===expected.call({},actual)}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=function(block){var error;try{block()}catch(e){error=e}return error}(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnexpectedException=!shouldThrow&&actual&&!expected;if((!shouldThrow&&util.isError(actual)&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}assert.AssertionError=function(options){var self;this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=truncate(inspect((self=this).actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(0<=idx){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)},assert.strictEqual=function(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":13}],11:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],12:[function(require,module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],13:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(len<=i)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(!0===process.noDeprecation)return fn;var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return 3<=arguments.length&&(ctx.depth=arguments[2]),4<=arguments.length&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(0<=keys.indexOf("message")||0<=keys.indexOf("description")))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value))&&(base=" [Function"+(value.name?": "+value.name:"")+"]");return isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),function(output,base,braces){if(60<output.reduce(function(prev,cur){return 0,0<=cur.indexOf("\n")&&0,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0))return braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?-1<(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},(exports.inspect=inspect).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){var d,time;console.log("%s - %s",(d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":"),[d.getDate(),months[d.getMonth()],time].join(" ")),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":12,_process:89,inherits:11}],14:[function(require,module,exports){"use strict";exports.byteLength=function(b64){var lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1];return 3*(validLen+placeHoldersLen)/4-placeHoldersLen},exports.toByteArray=function(b64){for(var tmp,lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1],arr=new Arr(function(b64,validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(0,validLen,placeHoldersLen)),curByte=0,len=0<placeHoldersLen?validLen-4:validLen,i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,len2<i+16383?len2:i+16383));1===extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(0<len%4)throw new Error("Invalid string. Length must be a multiple of 4");var validLen=b64.indexOf("=");return-1===validLen&&(validLen=len),[validLen,validLen===len?0:4-validLen%4]}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],15:[function(require,module,exports){},{}],16:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments)},{dup:15}],17:[function(require,module,exports){"use strict";var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;function createBuffer(length){if(K_MAX_LENGTH<length)throw new RangeError("Invalid typed array length");var buf=new Uint8Array(length);return buf.__proto__=Buffer.prototype,buf}function Buffer(arg,encodingOrOffset,length){if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}function from(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return isArrayBuffer(value)||value&&isArrayBuffer(value.buffer)?function(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');var buf;buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);return buf.__proto__=Buffer.prototype,buf}(value,encodingOrOffset,length):"string"==typeof value?function(string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var length=0|byteLength(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);actual!==length&&(buf=buf.slice(0,actual));return buf}(value,encodingOrOffset):function(obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(len);return 0===buf.length||obj.copy(buf,0,0,len),buf}if(obj){if(ArrayBuffer.isView(obj)||"length"in obj)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function checked(length){if(K_MAX_LENGTH<=length)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isArrayBuffer(string))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):2147483647<byteOffset?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),numberIsNaN(byteOffset=+byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;arrLength/=indexSize=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(arrLength<byteOffset+valLength&&(byteOffset=arrLength-valLength),i=byteOffset;0<=i;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?remaining<(length=Number(length))&&(length=remaining):length=remaining;var strLen=string.length;strLen/2<length&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=239<firstByte?4:223<firstByte?3:191<firstByte?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&127<(tempCodePoint=(31&firstByte)<<6|63&secondByte)&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&2047<(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)&&(tempCodePoint<55296||57343<tempCodePoint)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&65535<(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):65535<codePoint&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}exports.kMaxLength=K_MAX_LENGTH,(Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{get:function(){if(this instanceof Buffer)return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{get:function(){if(this instanceof Buffer)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return function(size,fill,encoding){return assertSize(size),size<=0?createBuffer(size):void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)}(size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)},Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(i=length=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(ArrayBuffer.isView(buf)&&(buf=Buffer.from(buf)),!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toLocaleString=Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):function(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return 0<this.length&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisEnd<=thisStart&&end<=start)return 0;if(thisEnd<=thisStart)return-1;if(end<=start)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||remaining<length)&&(length=remaining),0<string.length&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||len<end)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(length<offset+ext)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(max<value||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var len=this.length;(start=~~start)<0?(start+=len)<0&&(start=0):len<start&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):len<end&&(end=len),end<start&&(end=start);var newBuf=this.subarray(start,end);return newBuf.__proto__=Buffer.prototype,newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;0<byteLength&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];0<i&&(mul*=256);)val+=this[offset+--i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){(value=+value,offset>>>=0,byteLength>>>=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){(value=+value,offset>>>=0,byteLength>>>=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),0<end&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var len=end-start;if(this===target&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(targetStart,start,end);else if(this===target&&start<targetStart&&targetStart<end)for(var i=len-1;0<=i;--i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);if(1===val.length){var code=val.charCodeAt(0);("utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code)}}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if(55295<(codePoint=string.charCodeAt(i))&&codePoint<57344){if(!leadSurrogate){if(56319<codePoint){-1<(units-=3)&&bytes.push(239,191,189);continue}if(i+1===length){-1<(units-=3)&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){-1<(units-=3)&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&-1<(units-=3)&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||null!=obj&&null!=obj.constructor&&"ArrayBuffer"===obj.constructor.name&&"number"==typeof obj.byteLength}function numberIsNaN(obj){return obj!=obj}},{"base64-js":14,ieee754:60}],18:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],19:[function(require,module,exports){"use strict";require("./shim");var GenericCollection=require("./generic-collection"),GenericMap=require("./generic-map");function Dict(values,getDefault){if(!(this instanceof Dict))return new Dict(values,getDefault);getDefault=getDefault||Function.noop,this.getDefault=getDefault,this.store=Object.create(null),this.length=0,this.addEach(values)}(module.exports=Dict).Dict=Dict,Object.addEach(Dict.prototype,GenericCollection.prototype),Object.addEach(Dict.prototype,GenericMap.prototype),Dict.from=GenericCollection.from,Dict.prototype.constructClone=function(values){return new this.constructor(values,this.getDefault)},Dict.prototype.assertString=function(key){if("string"!=typeof key)throw new TypeError("key must be a string but Got "+key)},Object.defineProperty(Dict.prototype,"$__proto__",{writable:!0}),Object.defineProperty(Dict.prototype,"_hasProto",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this._protoValue}}),Object.defineProperty(Dict.prototype,"_protoValue",{get:function(){return this.$__proto__},set:function(value){this.$__proto__=value}}),Object.defineProperty(Dict.prototype,"size",GenericCollection._sizePropertyDescriptor),Dict.prototype.get=function(key,defaultValue){return this.assertString(key),"__proto__"===key?this._hasProto?this._protoValue:1<arguments.length?defaultValue:this.getDefault(key):key in this.store?this.store[key]:1<arguments.length?defaultValue:this.getDefault(key)},Dict.prototype.set=function(key,value){this.assertString(key);var isProtoKey="__proto__"===key;return(isProtoKey?this._hasProto:key in this.store)?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,isProtoKey?this._protoValue:this.store[key]),isProtoKey?this._protoValue=value:this.store[key]=value,this.dispatchesMapChanges&&this.dispatchMapChange(key,value),!1):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,void 0),this.length++,isProtoKey?this._protoValue=value:this.store[key]=value,this.dispatchesMapChanges&&this.dispatchMapChange(key,value),!0)},Dict.prototype.has=function(key){return this.assertString(key),"__proto__"===key?this._hasProto:key in this.store},Dict.prototype.delete=function(key){return this.assertString(key),"__proto__"===key?!!this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,this._protoValue),this._protoValue=void 0,this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(key,void 0),!0):key in this.store&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,this.store[key]),delete this.store[key],this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(key,void 0),!0)},Dict.prototype.clear=function(){var key;for(key in this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange("__proto__",this._protoValue),this._protoValue=void 0,this.dispatchesMapChanges&&this.dispatchMapChange("__proto__",void 0)),this.store)this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,this.store[key]),delete this.store[key],this.dispatchesMapChanges&&this.dispatchMapChange(key,void 0);this.length=0},Dict.prototype.reduce=function(callback,basis,thisp){this._hasProto&&(basis=callback.call(thisp,basis,"$__proto__","__proto__",this));var store=this.store;for(var key in this.store)basis=callback.call(thisp,basis,store[key],key,this);return basis},Dict.prototype.reduceRight=function(callback,basis,thisp){var self=this,store=this.store;return basis=Object.keys(this.store).reduceRight(function(basis,key){return callback.call(thisp,basis,store[key],key,self)},basis),this._hasProto?callback.call(thisp,basis,this._protoValue,"__proto__",self):basis},Dict.prototype.one=function(){var key;for(key in this.store)return this.store[key];return this._protoValue},Dict.prototype.toJSON=function(){return this.toObject()}},{"./generic-collection":25,"./generic-map":26,"./shim":38}],20:[function(require,module,exports){"use strict";require("./shim");var Dict=require("./_dict"),List=require("./_list"),GenericCollection=require("./generic-collection"),GenericSet=require("./generic-set"),TreeLog=require("./tree-log");Object.prototype.hasOwnProperty;function FastSet(values,equals,hash,getDefault){if(!(this instanceof FastSet))return new FastSet(values,equals,hash,getDefault);equals=equals||Object.equals,hash=hash||Object.hash,getDefault=getDefault||Function.noop,this.contentEquals=equals,this.contentHash=hash,this.getDefault=getDefault;var self=this;this.buckets=new this.Buckets(null,function(){return new self.Bucket}),this.length=0,this.addEach(values)}(module.exports=FastSet).FastSet=FastSet,Object.addEach(FastSet.prototype,GenericCollection.prototype),Object.addEach(FastSet.prototype,GenericSet.prototype),FastSet.from=GenericCollection.from,FastSet.prototype.Buckets=Dict,FastSet.prototype.Bucket=List,FastSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)},FastSet.prototype.has=function(value){var hash=this.contentHash(value);return this.buckets.get(hash).has(value)},FastSet.prototype.get=function(value,equals){if(equals)throw new Error("FastSet#get does not support second argument: equals");var hash=this.contentHash(value),buckets=this.buckets;return buckets.has(hash)?buckets.get(hash).get(value):this.getDefault(value)},FastSet.prototype.delete=function(value,equals){if(equals)throw new Error("FastSet#delete does not support second argument: equals");var hash=this.contentHash(value),buckets=this.buckets;if(buckets.has(hash)){var bucket=buckets.get(hash);if(bucket.delete(value))return this.length--,0===bucket.length&&buckets.delete(hash),!0}return!1},FastSet.prototype.clear=function(){this.buckets.clear(),this.length=0},FastSet.prototype.add=function(value){var hash=this.contentHash(value),buckets=this.buckets;return buckets.has(hash)||buckets.set(hash,new this.Bucket(null,this.contentEquals)),!buckets.get(hash).has(value)&&(buckets.get(hash).add(value),this.length++,!0)},FastSet.prototype.reduce=function(callback,basis){var thisp=arguments[2],buckets=this.buckets,index=0;return buckets.reduce(function(basis,bucket){return bucket.reduce(function(basis,value){return callback.call(thisp,basis,value,index++,this)},basis,this)},basis,this)},FastSet.prototype.one=function(){if(0<this.length)return this.buckets.one().one()},FastSet.prototype.iterate=function(){return this.buckets.valuesArray().flatten().iterate()},FastSet.prototype.log=function(charmap,logNode,callback,thisp){charmap=charmap||TreeLog.unicodeSharp,logNode=logNode||this.logNode,callback||(callback=console.log,thisp=console),callback=callback.bind(thisp);for(var hash,branch,leader,bucket,buckets=this.buckets,bucketsSize=buckets.size,mapIter=buckets.keys(),index=0;hash=mapIter.next().value;)index===bucketsSize-1?(branch=charmap.fromAbove,leader=" "):(branch=0===index?charmap.branchDown:charmap.fromBoth,leader=charmap.strafe),bucket=buckets.get(hash),callback.call(thisp,branch+charmap.through+charmap.branchDown+" "+hash),bucket.forEach(function(value,node){var branch,below,written;node===bucket.head.prev?(branch=charmap.fromAbove,below=" "):(branch=charmap.fromBoth,below=charmap.strafe),logNode(node,function(line){written?callback.call(thisp,leader+" "+below+"  "+line):(callback.call(thisp,leader+" "+branch+charmap.through+charmap.through+line),written=!0)},function(line){callback.call(thisp,leader+" "+charmap.strafe+"  "+line)})}),index++},FastSet.prototype.logNode=function(node,write){var value=node.value;Object(value)===value?JSON.stringify(value,null,4).split("\n").forEach(function(line){write(" "+line)}):write(" "+value)}},{"./_dict":19,"./_list":21,"./generic-collection":25,"./generic-set":28,"./shim":38,"./tree-log":39}],21:[function(require,module,exports){"use strict";module.exports=List;require("./shim");var GenericCollection=require("./generic-collection"),GenericOrder=require("./generic-order");function List(values,equals,getDefault){return List._init(List,this,values,equals,getDefault)}function ListIterator(head){this.head=head,this.at=head.next}function Node(value){this.value=value,this.prev=null,this.next=null}List._init=function(constructor,object,values,equals,getDefault){if(!(object instanceof constructor))return new constructor(values,equals,getDefault);var head=object.head=new object.Node;(head.next=head).prev=head,object.contentEquals=equals||Object.equals,object.getDefault=getDefault||Function.noop,object.length=0,object.addEach(values)},List.List=List,Object.addEach(List.prototype,GenericCollection.prototype),Object.addEach(List.prototype,GenericOrder.prototype),List.from=GenericCollection.from,List.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.getDefault)},List.prototype.find=function(value,equals,index){equals=equals||this.contentEquals;for(var head=this.head,at=this.scan(index,head.next);at!==head;){if(equals(at.value,value))return at;at=at.next}},List.prototype.findLast=function(value,equals,index){equals=equals||this.contentEquals;for(var head=this.head,at=this.scan(index,head.prev);at!==head;){if(equals(at.value,value))return at;at=at.prev}},List.prototype.has=function(value,equals){return!!this.find(value,equals)},List.prototype.get=function(value,equals){var found=this.find(value,equals);return found?found.value:this.getDefault(value)},List.prototype.delete=function(value,equals){var found=this.findLast(value,equals);return!!found&&(found.delete(),this.length--,!0)},List.prototype.deleteAll=function(value,equals){equals=equals||this.contentEquals;for(var head=this.head,at=head.next,count=0;at!==head;)equals(value,at.value)&&(at.delete(),count++),at=at.next;return this.length-=count,count},List.prototype.clear=function(){this.head.next=this.head.prev=this.head,this.length=0},List.prototype.add=function(value){var node=new this.Node(value);return this._addNode(node)},List.prototype._addNode=function(node){return this.head.addBefore(node),this.length++,!0},List.prototype.push=function(){for(var head=this.head,i=0;i<arguments.length;i++){var value=arguments[i],node=new this.Node(value);head.addBefore(node)}this.length+=arguments.length},List.prototype.unshift=function(){for(var at=this.head,i=0;i<arguments.length;i++){var value=arguments[i],node=new this.Node(value);at.addAfter(node),at=node}this.length+=arguments.length},List.prototype._shouldPop=function(){var value,head=this.head;return head.prev!==head&&(value=head.prev.value),value},List.prototype.pop=function(_before,_after){var value,head=this.head;if(head.prev!==head){value=head.prev.value;var index=this.length-1,popDispatchValueArray=_before?_before.call(this,value,index):void 0;head.prev.delete(),this.length--,_after&&_after.call(this,value,index,popDispatchValueArray)}return value},List.prototype.shift=function(_before,_after){var value,head=this.head;if(head.prev!==head){value=head.next.value;var dispatchValueArray=_before?_before.call(this,value,0):void 0;head.next.delete(),this.length--,_after&&_after.call(this,value,0,dispatchValueArray)}return value},List.prototype.peek=function(){if(this.head!==this.head.next)return this.head.next.value},List.prototype.poke=function(value){this.head!==this.head.next?this.head.next.value=value:this.push(value)},List.prototype.one=function(){return this.peek()},List.prototype.scan=function(at,fallback){var head=this.head;if("number"==typeof at){var count=at;if(0<=count)for(at=head.next;count&&(count--,(at=at.next)!=head););else for(at=head;count<0&&(count++,(at=at.prev)!=head););return at}return at||fallback},List.prototype.slice=function(at,end){var sliced=[],head=this.head;for(at=this.scan(at,head.next),end=this.scan(end,head);at!==end&&at!==head;)sliced.push(at.value),at=at.next;return sliced},List.prototype.splice=function(at,length){return this.swap(at,length,Array.prototype.slice.call(arguments,2))},List.prototype.swap=function(start,length,plus,_before,_after){var initial=start;start=this.scan(start,this.head),null==length&&(length=1/0),plus=Array.from(plus);for(var minus=[],at=start;length--&&0<=length&&at!==this.head;)minus.push(at.value),at=at.next;_before&&_before.call(this,start,plus,minus);at=start;var i=0;for(at=start;i<minus.length;i++,at=at.next)at.delete();null==initial&&at===this.head&&(at=this.head.next);for(i=0;i<plus.length;i++){var node=new this.Node(plus[i]);at.addBefore(node)}return this.length+=plus.length-minus.length,_after&&_after.call(this,start,plus,minus),minus},List.prototype.reverse=function(){var at=this.head;do{var temp=at.next;at.next=at.prev,at.prev=temp,at=at.next}while(at!==this.head);return this},List.prototype.sort=function(){this.swap(0,this.length,this.sorted.apply(this,arguments))},List.prototype.reduce=function(callback,basis){for(var thisp=arguments[2],head=this.head,at=head.next;at!==head;)basis=callback.call(thisp,basis,at.value,at,this),at=at.next;return basis},List.prototype.reduceRight=function(callback,basis){for(var thisp=arguments[2],head=this.head,at=head.prev;at!==head;)basis=callback.call(thisp,basis,at.value,at,this),at=at.prev;return basis},List.prototype.updateIndexes=function(node,index){for(;node!==this.head;)node.index=index++,node=node.next},List.prototype.iterate=function(){return new ListIterator(this.head)},ListIterator.prototype.__iterationObject=null,Object.defineProperty(ListIterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),ListIterator.prototype.next=function(){if(this.at===this.head)this._iterationObject.done=!0,this._iterationObject.value=void 0;else{var value=this.at.value;this.at=this.at.next,this._iterationObject.value=value}return this._iterationObject},(List.prototype.Node=Node).prototype.delete=function(){this.prev.next=this.next,this.next.prev=this.prev},Node.prototype.addBefore=function(node){var prev=this.prev;(((this.prev=node).prev=prev).next=node).next=this},Node.prototype.addAfter=function(node){var next=this.next;(((this.next=node).next=next).prev=node).prev=this}},{"./generic-collection":25,"./generic-order":27,"./shim":38}],22:[function(require,module,exports){(function(global){"use strict";require("./shim");var Map,GlobalMap,CollectionsMap,GenericCollection=require("./generic-collection");if(void 0!==global.Map&&"function"==typeof global.Set.prototype.values){var map_makeObservable;(GlobalMap=Map=module.exports=global.Map).Map=Map,map_makeObservable={}.__proto__===Object.prototype?function(){this.__proto__=ChangeDispatchMap}:function(){Object.defineProperties(this,observableSetProperties)},Object.defineProperty(Map.prototype,"makeObservable",{value:map_makeObservable,writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Map.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),Map.prototype.constructClone=function(values){return new this.constructor(values)},Map.prototype.isMap=!0,Map.prototype.addEach=function(values){if(values&&Object(values)===values)if("function"==typeof values.forEach)!0===values.isMap?values.forEach(function(value,key){this.set(key,value)},this):values.forEach(function(pair){this.set(pair[0],pair[1])},this);else if("number"==typeof values.length)for(var i=0;i<values.length;i++)this.add(values[i],i);else Object.keys(values).forEach(function(key){this.set(key,values[key])},this);else if(values&&"number"==typeof values.length)for(i=0;i<values.length;i++)this.add(values[i],i);return this},Map.prototype.add=function(value,key){return this.set(key,value)},Map.prototype.reduce=function(callback,basis){var thisp=arguments[2];return this.forEach(function(value,key,map){basis=callback.call(thisp,basis,value,key,this)}),basis},Map.prototype.reduceRight=function(callback,basis){for(var aKey,thisp=arguments[2],keysIterator=this.keys(),size=this.size,reverseOrder=new Array(this.size),i=0;aKey=keysIterator.next().value;)reverseOrder[--size]=aKey;for(;i++<size;)basis=callback.call(thisp,basis,this.get(reverseOrder[i]),reverseOrder[i],this);return basis},Map.prototype.equals=function(that,equals){return equals=equals||Object.equals,this===that||(that&&"function"==typeof that.every?that.size===this.size&&that.every(function(value,key){return equals(this.get(key),value)},this):Object.keys(that).length===this.size&&Object.keys(that).every(function(key){return equals(this.get(key),that[key])},this))};var _keysArrayFunction=function(value,key){return key};Map.prototype.keysArray=function(){return this.map(_keysArrayFunction)};var _valuesArrayFunction=function(value,key){return value};Map.prototype.valuesArray=function(){return this.map(_valuesArrayFunction)};var _entriesArrayFunction=function(value,key){return[key,value]};Map.prototype.entriesArray=function(){return this.map(_entriesArrayFunction)},Map.prototype.toJSON=function(){return this.entriesArray()},Map.prototype.items=function(){return this.entriesArray()},Map.from=function(value){var result=new this;return result.addEach(value),result},Object.defineProperty(Map.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0});var map_clear=Map.prototype.clear,map_set=Map.prototype.set,map_delete=Map.prototype.delete,observableMapProperties={clear:{value:function(){var keys;this.dispatchesMapChanges&&(this.forEach(function(value,key){this.dispatchBeforeMapChange(key,value)},this),keys=this.keysArray()),map_clear.call(this),this.dispatchesMapChanges&&keys.forEach(function(key){this.dispatchMapChange(key)},this)},writable:!0,configurable:!0},set:{value:function(key,value){var found=this.get(key);return found?this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,found):this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,void 0),map_set.call(this,key,value),this.dispatchesMapChanges&&this.dispatchMapChange(key,value),this},writable:!0,configurable:!0},delete:{value:function(key){return!!this.has(key)&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,this.get(key)),map_delete.call(this,key),this.dispatchesMapChanges&&this.dispatchMapChange(key,void 0),!0)}}};Object.addEach(Map.prototype,GenericCollection.prototype,!1);var ChangeDispatchMap=Object.create(Map.prototype,observableMapProperties)}var Set=require("./_set").CollectionsSet,GenericMap=require("./generic-map");CollectionsMap=Map=function Map(values,equals,hash,getDefault){if(!(this instanceof Map))return new Map(values,equals,hash,getDefault);equals=equals||Object.equals,hash=hash||Object.hash,getDefault=getDefault||Function.noop,this.contentEquals=equals,this.contentHash=hash,this.getDefault=getDefault,this.store=new Set(void 0,function(a,b){return equals(a.key,b.key)},function(item){return hash(item.key)}),this.length=0,this.addEach(values)},Map.Map=Map,Object.addEach(Map.prototype,GenericCollection.prototype),Object.addEach(Map.prototype,GenericMap.prototype),Object.defineProperty(Map.prototype,"size",GenericCollection._sizePropertyDescriptor),Map.from=GenericCollection.from,Map.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)},Map.prototype.log=function(charmap,logNode,callback,thisp){logNode=logNode||this.logNode,this.store.log(charmap,function(node,log,logBefore){logNode(node.value.value,log,logBefore)},callback,thisp)},Map.prototype.logNode=function(node,log){log(" key: "+node.key),log(" value: "+node.value)},GlobalMap?(module.exports=GlobalMap).CollectionsMap=CollectionsMap:module.exports=CollectionsMap}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_set":23,"./generic-collection":25,"./generic-map":26,"./shim":38}],23:[function(require,module,exports){(function(global){"use strict";require("./shim");var GlobalSet,CollectionsSet,GenericCollection=require("./generic-collection"),GenericSet=require("./generic-set");void 0!==global.Set&&"function"==typeof global.Set.prototype.values&&(((GlobalSet=module.exports=global.Set).Set=GlobalSet).prototype.reduce=function(callback,basis){var thisp=arguments[2];return this.forEach(function(value){basis=callback.call(thisp,basis,value,this)}),basis},GlobalSet.prototype.reduceRight=function(callback,basis){for(var value,thisp=arguments[2],setIterator=this.values(),size=this.size,reverseOrder=new Array(this.size),i=0;value=setIterator.next().value;)reverseOrder[--size]=value;for(;i++<size;)basis=callback.call(thisp,basis,value,this);return basis},GlobalSet.prototype.equals=function(that,equals){var self=this;return that&&"function"==typeof that.reduce&&this.size===(that.size||that.length)&&that.reduce(function(equal,value){return equal&&self.has(value,equals)},!0)},GlobalSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)},GlobalSet.prototype.toJSON=function(){return this.entriesArray()},GlobalSet.prototype.one=function(){if(0<this.size)return this.values().next().value},GlobalSet.prototype.pop=function(){if(this.size){for(var aValue,value,setIterator=this.values();aValue=setIterator.next().value;)value=aValue;return this.delete(value,this.size-1),value}},GlobalSet.prototype.shift=function(){if(this.size){var firstValue=this.values().next().value;return this.delete(firstValue,0),firstValue}},Object.defineProperty(GlobalSet.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0}),GlobalSet.from=function(value){var result=new this;return result.addEach(value),result},Object.addEach(GlobalSet.prototype,GenericCollection.prototype,!1),Object.addEach(GlobalSet.prototype,GenericSet.prototype,!1));var List=require("./_list"),FastSet=require("./_fast-set"),Iterator=require("./iterator");(CollectionsSet=function CollectionsSet(values,equals,hash,getDefault){return CollectionsSet._init(CollectionsSet,this,values,equals,hash,getDefault)})._init=function(constructor,object,values,equals,hash,getDefault){if(!(object instanceof constructor))return new constructor(values,equals,hash,getDefault);equals=equals||Object.equals,hash=hash||Object.hash,getDefault=getDefault||Function.noop,object.contentEquals=equals,object.contentHash=hash,object.getDefault=getDefault,object.order=new object.Order(void 0,equals),object.store=new object.Store(void 0,function(a,b){return equals(a.value,b.value)},function(node){return hash(node.value)}),object.length=0,object.addEach(values)},(CollectionsSet.Set=CollectionsSet).CollectionsSet=CollectionsSet,Object.addEach(CollectionsSet.prototype,GenericCollection.prototype),Object.addEach(CollectionsSet.prototype,GenericSet.prototype),CollectionsSet.from=GenericCollection.from,Object.defineProperty(CollectionsSet.prototype,"size",GenericCollection._sizePropertyDescriptor),CollectionsSet.prototype.Order=List,CollectionsSet.prototype.Store=FastSet,CollectionsSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)},CollectionsSet.prototype.has=function(value){var node=new this.order.Node(value);return this.store.has(node)},CollectionsSet.prototype.get=function(value,equals){if(equals)throw new Error("Set#get does not support second argument: equals");var node=new this.order.Node(value);return(node=this.store.get(node))?node.value:this.getDefault(value)},CollectionsSet.prototype.add=function(value){var node=new this.order.Node(value);if(!this.store.has(node)){this.length;return this.order.add(value),node=this.order.head.prev,this.store.add(node),this.length++,!0}return!1},CollectionsSet.prototype.delete=function(value,equals){if(equals)throw new Error("Set#delete does not support second argument: equals");var node=new this.order.Node(value);return!!this.store.has(node)&&(node=this.store.get(node),this.store.delete(node),this.order.splice(node,1),this.length--,!0)},CollectionsSet.prototype.pop=function(){if(this.length){var result=this.order.head.prev.value;return this.delete(result),result}},CollectionsSet.prototype.shift=function(){if(this.length){var result=this.order.head.next.value;return this.delete(result),result}},CollectionsSet.prototype.one=function(){if(0<this.length)return this.store.one().value},CollectionsSet.prototype.clear=function(){this.store.clear(),this.order.clear(),this.length=0},Object.defineProperty(CollectionsSet.prototype,"_clear",{value:CollectionsSet.prototype.clear}),CollectionsSet.prototype.reduce=function(callback,basis){var thisp=arguments[2],list=this.order,index=0;return list.reduce(function(basis,value){return callback.call(thisp,basis,value,index++,this)},basis,this)},CollectionsSet.prototype.reduceRight=function(callback,basis){var thisp=arguments[2],list=this.order,index=this.length-1;return list.reduceRight(function(basis,value){return callback.call(thisp,basis,value,index--,this)},basis,this)},CollectionsSet.prototype.iterate=function(){return this.order.iterate()},CollectionsSet.prototype.values=function(){return new Iterator(this.valuesArray())},CollectionsSet.prototype.log=function(){var set=this.store;return set.log.apply(set,arguments)},GlobalSet?(GlobalSet.prototype.valuesArray=GenericSet.prototype.valuesArray,GlobalSet.prototype.entriesArray=GenericSet.prototype.entriesArray,(module.exports=GlobalSet).CollectionsSet=CollectionsSet):module.exports=CollectionsSet}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_fast-set":20,"./_list":21,"./generic-collection":25,"./generic-set":28,"./iterator":29,"./shim":38}],24:[function(require,module,exports){"use strict";var Dict=require("./_dict"),PropertyChanges=require("./listen/property-changes"),MapChanges=require("./listen/map-changes");module.exports=Dict,Object.addEach(Dict.prototype,PropertyChanges.prototype),Object.addEach(Dict.prototype,MapChanges.prototype)},{"./_dict":19,"./listen/map-changes":31,"./listen/property-changes":32}],25:[function(require,module,exports){(function(global){"use strict";function GenericCollection(){throw new Error("Can't construct. GenericCollection is a mixin.")}module.exports=GenericCollection;var DOMTokenList=global.DOMTokenList||function(){};GenericCollection.EmptyArray=Object.freeze([]),GenericCollection.prototype.addEach=function(values){if(values&&(values instanceof Array||values instanceof DOMTokenList||values instanceof String))for(var i=0;i<values.length;i++)this.add(values[i],i);else if(values&&Object(values)===values)if("function"==typeof values.forEach)values.forEach(this.add,this);else if("number"==typeof values.length)for(i=0;i<values.length;i++)this.add(values[i],i);else Object.keys(values).forEach(function(key){this.add(values[key],key)},this);return this},GenericCollection.prototype.deleteEach=function(values,equals){return values.forEach(function(value){this.delete(value,equals)},this),this},GenericCollection.prototype.forEach=function(callback){var thisp=arguments[1];return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,key,object,depth)},void 0)},GenericCollection.prototype.map=function(callback){var thisp=arguments[1],result=[];return this.reduce(function(undefined,value,key,object,depth){result.push(callback.call(thisp,value,key,object,depth))},void 0),result},GenericCollection.prototype.enumerate=function(start){null==start&&(start=0);var result=[];return this.reduce(function(undefined,value){result.push([start++,value])},void 0),result},GenericCollection.prototype.group=function(callback,thisp,equals){equals=equals||Object.equals;var groups=[],keys=[];return this.forEach(function(value,key,object){key=callback.call(thisp,value,key,object);var group,index=keys.indexOf(key,equals);-1===index?(group=[],groups.push([key,group]),keys.push(key)):group=groups[index][1],group.push(value)}),groups},GenericCollection.prototype.toArray=function(){return this.map(Function.identity)},GenericCollection.prototype.toObject=function(){var object={};return this.reduce(function(undefined,value,key){object[key]=value},void 0),object},GenericCollection.from=function(){return this.apply(this,arguments)},GenericCollection.prototype.filter=function(callback){var thisp=arguments[1],result=this.constructClone();return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,key,object,depth)&&result.add(value,key)},void 0),result},GenericCollection.prototype.every=function(callback){var thisp=arguments[1];return this.reduce(function(result,value,key,object,depth){return result&&callback.call(thisp,value,key,object,depth)},!0)},GenericCollection.prototype.some=function(callback){var thisp=arguments[1];return this.reduce(function(result,value,key,object,depth){return result||callback.call(thisp,value,key,object,depth)},!1)},GenericCollection.prototype.all=function(){return this.every(Boolean)},GenericCollection.prototype.any=function(){return this.some(Boolean)},GenericCollection.prototype.min=function(compare){compare=compare||this.contentCompare||Object.compare;var first=!0;return this.reduce(function(result,value){return first?(first=!1,value):compare(value,result)<0?value:result},void 0)},GenericCollection.prototype.max=function(compare){compare=compare||this.contentCompare||Object.compare;var first=!0;return this.reduce(function(result,value){return first?(first=!1,value):0<compare(value,result)?value:result},void 0)},GenericCollection.prototype.sum=function(zero){return zero=void 0===zero?0:zero,this.reduce(function(a,b){return a+b},zero)},GenericCollection.prototype.average=function(zero){var sum=void 0===zero?0:zero,count=void 0===zero?0:zero;return this.reduce(function(undefined,value){sum+=value,count+=1},void 0),sum/count},GenericCollection.prototype.concat=function(){for(var result=this.constructClone(this),i=0;i<arguments.length;i++)result.addEach(arguments[i]);return result},GenericCollection.prototype.flatten=function(){var self=this;return this.reduce(function(result,array){return array.forEach(function(value){this.push(value)},result,self),result},[])},GenericCollection.prototype.zip=function(){var table=Array.prototype.slice.call(arguments);return table.unshift(this),Array.unzip(table)},GenericCollection.prototype.join=function(delimiter){return this.reduce(function(result,string){return void 0===result?string:result+delimiter+string},void 0)},GenericCollection.prototype.sorted=function(compare,by,order){return(compare=compare||this.contentCompare||Object.compare).by?(by=compare.by,compare=compare.compare||this.contentCompare||Object.compare):by=by||Function.identity,void 0===order&&(order=1),this.map(function(item){return{by:by(item),value:item}}).sort(function(a,b){return compare(a.by,b.by)*order}).map(function(pair){return pair.value})},GenericCollection.prototype.reversed=function(){return this.constructClone(this).reverse()},GenericCollection.prototype.clone=function(depth,memo){if(void 0===depth)depth=1/0;else if(0===depth)return this;var clone=this.constructClone();return this.forEach(function(value,key){clone.add(Object.clone(value,depth-1,memo),key)},this),clone},GenericCollection.prototype.only=function(){if(1===this.length)return this.one()},GenericCollection.prototype.iterator=function(){return this.iterate.apply(this,arguments)},GenericCollection._sizePropertyDescriptor={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(GenericCollection.prototype,"size",GenericCollection._sizePropertyDescriptor),require("./shim-array")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./shim-array":34}],26:[function(require,module,exports){"use strict";var Object=require("./shim-object"),Iterator=require("./iterator");function GenericMap(){throw new Error("Can't construct. GenericMap is a mixin.")}function Item(key,value){this.key=key,this.value=value}(module.exports=GenericMap).prototype.isMap=!0,GenericMap.prototype.addEach=function(values){var i;if(values&&Object(values)===values)if("function"==typeof values.forEach)!0===values.isMap?values.forEach(function(value,key){this.set(key,value)},this):values.forEach(function(pair){this.set(pair[0],pair[1])},this);else if("number"==typeof values.length)for(i=0;i<values.length;i++)this.add(values[i],i);else Object.keys(values).forEach(function(key){this.set(key,values[key])},this);else if(values&&"number"==typeof values.length)for(i=0;i<values.length;i++)this.add(values[i],i);return this},GenericMap.prototype.get=function(key,defaultValue){var item=this.store.get(new this.Item(key));return item?item.value:1<arguments.length?(console.log("Use of a second argument as default value is deprecated to match standards"),defaultValue):this.getDefault(key)},GenericMap.prototype.set=function(key,value){var item=new this.Item(key,value),found=this.store.get(item);return found?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,found.value),found.value=value):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,void 0),this.store.add(item)&&(this.length++,!0)),this.dispatchesMapChanges&&this.dispatchMapChange(key,value),this},GenericMap.prototype.add=function(value,key){return this.set(key,value)},GenericMap.prototype.has=function(key){return this.store.has(new this.Item(key))},GenericMap.prototype.delete=function(key){var item=new this.Item(key);if(this.store.has(item)){var from=this.store.get(item).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(key,from),this.store.delete(item),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(key,void 0),!0}return!1},GenericMap.prototype.clear=function(){var keys,key;if(this.dispatchesMapChanges&&(this.forEach(function(value,key){this.dispatchBeforeMapChange(key,value)},this),keys=this.keysArray()),this.store.clear(),this.length=0,this.dispatchesMapChanges)for(var i=0;key=keys[i];i++)this.dispatchMapChange(key)},GenericMap.prototype.reduce=function(callback,basis,thisp){return this.store.reduce(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)},GenericMap.prototype.reduceRight=function(callback,basis,thisp){return this.store.reduceRight(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)},GenericMap.prototype.keysArray=function(){return this.map(function(value,key){return key})},GenericMap.prototype.keys=function(){return new Iterator(this.keysArray())},GenericMap.prototype.valuesArray=function(){return this.map(Function.identity)},GenericMap.prototype.values=function(){return new Iterator(this.valuesArray())},GenericMap.prototype.entriesArray=function(){return this.map(function(value,key){return[key,value]})},GenericMap.prototype.entries=function(){return new Iterator(this.entriesArray())},GenericMap.prototype.items=function(){return this.entriesArray()},GenericMap.prototype.equals=function(that,equals){return equals=equals||Object.equals,this===that||(that&&"function"==typeof that.every?that.length===this.length&&that.every(function(value,key){return equals(this.get(key),value)},this):Object.keys(that).length===this.length&&Object.keys(that).every(function(key){return equals(this.get(key),that[key])},this))},GenericMap.prototype.toJSON=function(){return this.entriesArray()},(GenericMap.prototype.Item=Item).prototype.equals=function(that){return Object.equals(this.key,that.key)&&Object.equals(this.value,that.value)},Item.prototype.compare=function(that){return Object.compare(this.key,that.key)}},{"./iterator":29,"./shim-object":36}],27:[function(require,module,exports){var Object=require("./shim-object");function GenericOrder(){throw new Error("Can't construct. GenericOrder is a mixin.")}(module.exports=GenericOrder).prototype.equals=function(that,equals){if(equals=equals||this.contentEquals||Object.equals,this===that)return!0;if(!that)return!1;return this.length===that.length&&this.zip(that).every(function(pair){return equals(pair[0],pair[1])})},GenericOrder.prototype.compare=function(that,compare){if(compare=compare||this.contentCompare||Object.compare,this===that)return 0;if(!that)return 1;var length=Math.min(this.length,that.length),comparison=this.zip(that).reduce(function(comparison,pair,index){return 0===comparison?length<=index?comparison:compare(pair[0],pair[1]):comparison},0);return 0===comparison?this.length-that.length:comparison},GenericOrder.prototype.toJSON=function(){return this.toArray()}},{"./shim-object":36}],28:[function(require,module,exports){function GenericSet(){throw new Error("Can't construct. GenericSet is a mixin.")}(module.exports=GenericSet).prototype.isSet=!0,GenericSet.prototype.union=function(that){var union=this.constructClone(this);return union.addEach(that),union},GenericSet.prototype.intersection=function(that){return this.constructClone(this.filter(function(value){return that.has(value)}))},GenericSet.prototype.difference=function(that){var union=this.constructClone(this);return union.deleteEach(that),union},GenericSet.prototype.symmetricDifference=function(that){var union=this.union(that),intersection=this.intersection(that);return union.difference(intersection)},GenericSet.prototype.deleteAll=function(value){return+this.delete(value)},GenericSet.prototype.equals=function(that,equals){var self=this;return that&&"function"==typeof that.reduce&&this.length===that.length&&that.reduce(function(equal,value){return equal&&self.has(value,equals)},!0)},GenericSet.prototype.forEach=function(callback){var thisp=arguments[1];return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,value,object,depth)},void 0)},GenericSet.prototype.toJSON=function(){return this.toArray()},GenericSet.prototype.contains=function(value){return this.has(value)},GenericSet.prototype.remove=function(value){return this.delete(value)},GenericSet.prototype.toggle=function(value){this.has(value)?this.delete(value):this.add(value)};var _valuesArrayFunction=function(value,key){return value};GenericSet.prototype.valuesArray=function(){return this.map(_valuesArrayFunction)};var _entriesArrayFunction=function(value,key){return[key,value]};GenericSet.prototype.entriesArray=function(){return this.map(_entriesArrayFunction)}},{}],29:[function(require,module,exports){"use strict";module.exports=Iterator;var Object=require("./shim-object"),GenericCollection=require("./generic-collection");function Iterator(iterable){var values=iterable&&iterable.values&&iterable.values();if(values&&"function"==typeof values.next)return values;if(!(this instanceof Iterator))return new Iterator(iterable);if(Array.isArray(iterable)||"string"==typeof iterable)return Iterator.iterate(iterable);if((iterable=Object(iterable))instanceof Iterator)return iterable;if(iterable.next)this.next=function(){return iterable.next()};else if(iterable.iterate){var iterator=iterable.iterate();this.next=function(){return iterator.next()}}else{if("[object Function]"!==Object.prototype.toString.call(iterable))throw new TypeError("Can't iterate "+iterable);this.next=iterable}}Iterator.prototype.forEach=GenericCollection.prototype.forEach,Iterator.prototype.map=GenericCollection.prototype.map,Iterator.prototype.filter=GenericCollection.prototype.filter,Iterator.prototype.every=GenericCollection.prototype.every,Iterator.prototype.some=GenericCollection.prototype.some,Iterator.prototype.any=GenericCollection.prototype.any,Iterator.prototype.all=GenericCollection.prototype.all,Iterator.prototype.min=GenericCollection.prototype.min,Iterator.prototype.max=GenericCollection.prototype.max,Iterator.prototype.sum=GenericCollection.prototype.sum,Iterator.prototype.average=GenericCollection.prototype.average,Iterator.prototype.flatten=GenericCollection.prototype.flatten,Iterator.prototype.zip=GenericCollection.prototype.zip,Iterator.prototype.enumerate=GenericCollection.prototype.enumerate,Iterator.prototype.sorted=GenericCollection.prototype.sorted,Iterator.prototype.group=GenericCollection.prototype.group,Iterator.prototype.reversed=GenericCollection.prototype.reversed,Iterator.prototype.toArray=GenericCollection.prototype.toArray,Iterator.prototype.toObject=GenericCollection.prototype.toObject,Iterator.prototype.iterator=GenericCollection.prototype.iterator,Iterator.prototype.__iterationObject=null,Object.defineProperty(Iterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:void 0})}}),Iterator.prototype.constructClone=function(values){var clone=[];return clone.addEach(values),clone},Iterator.prototype.mapIterator=function(callback){var self=Iterator(this),thisp=arguments[1],i=0;if("[object Function]"!=Object.prototype.toString.call(callback))throw new TypeError;return new self.constructor(function(){if(!0!==self._iterationObject.done){var callbackValue=callback.call(thisp,self.next().value,i++,self);self._iterationObject.value=callbackValue}return self._iterationObject})},Iterator.prototype.filterIterator=function(callback){var self=Iterator(this),thisp=arguments[1],i=0;if("[object Function]"!=Object.prototype.toString.call(callback))throw new TypeError;return new self.constructor(function(){for(var nextEntry;;){if(!0===(nextEntry=self.next()).done)return nextEntry;if(callback.call(thisp,nextEntry.value,i++,self))return nextEntry}})},Iterator.prototype.reduce=function(callback){var nextEntry,self=Iterator(this),result=arguments[1],thisp=arguments[2],i=0;if("[object Function]"!=Object.prototype.toString.call(callback))throw new TypeError;if(!0===(nextEntry=self.next()).done){if(1<arguments.length)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(result=1<arguments.length?callback.call(thisp,result,nextEntry.value,i,self):nextEntry.value,i++;;){if(!0===(nextEntry=self.next()).done)return result;result=callback.call(thisp,result,nextEntry.value,i,self),i++}},Iterator.prototype.concat=function(){return Iterator.concat(Array.prototype.concat.apply(this,arguments))},Iterator.prototype.dropWhile=function(callback){var stopValue,nextEntry,self=Iterator(this),thisp=arguments[1],stopped=!1,i=0;if("[object Function]"!=Object.prototype.toString.call(callback))throw new TypeError;for(;!0!==(nextEntry=self.next()).done;){if(!callback.call(thisp,nextEntry.value,i,self)){stopped=!0,stopValue=nextEntry.value;break}i++}return stopped?self.constructor([stopValue]).concat(self):self.constructor([])},Iterator.prototype.takeWhile=function(callback){var self=Iterator(this),thisp=arguments[1],i=0;if("[object Function]"!=Object.prototype.toString.call(callback))throw new TypeError;return new self.constructor(function(){if(!0!==self._iterationObject.done){var value=self.next().value;callback.call(thisp,value,i++,self)?self._iterationObject.value=value:(self._iterationObject.done=!0,self._iterationObject.value=void 0)}return self._iterationObject})},Iterator.prototype.zipIterator=function(){return Iterator.unzip(Array.prototype.concat.apply(this,arguments))},Iterator.prototype.enumerateIterator=function(start){return Iterator.count(start).zipIterator(this)},Iterator.iterate=function(iterable){var start;return start=0,new Iterator(function(){if("object"==typeof iterable)for(;!(start in iterable);){if(start>=iterable.length){this._iterationObject.done=!0,this._iterationObject.value=void 0;break}start+=1}else start>=iterable.length&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);return this._iterationObject.done||(this._iterationObject.value=iterable[start],start+=1),this._iterationObject})},Iterator.cycle=function(cycle,times){var next;return arguments.length<2&&(times=1/0),new Iterator(function(){var iteration,nextEntry;return next&&(nextEntry=next()),next&&!0!==nextEntry.done||(0<times?(times--,iteration=Iterator.iterate(cycle),nextEntry=(next=iteration.next.bind(iteration))()):(this._iterationObject.done=!0,nextEntry=this._iterationObject)),nextEntry})},Iterator.concat=function(iterators){var next;return iterators=Iterator(iterators),new Iterator(function(){var iteration,nextEntry;return next&&(nextEntry=next()),nextEntry&&!0!==nextEntry.done?nextEntry:!1===(nextEntry=iterators.next()).done?(iteration=Iterator(nextEntry.value),(next=iteration.next.bind(iteration))()):nextEntry})},Iterator.unzip=function(iterators){return 0===(iterators=Iterator(iterators).map(Iterator)).length?new Iterator([]):new Iterator(function(){var stopped,nextEntry,result=iterators.map(function(iterator){return!0===(nextEntry=iterator.next()).done&&(stopped=!0),nextEntry.value});return stopped?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=result,this._iterationObject})},Iterator.zip=function(){return Iterator.unzip(Array.prototype.slice.call(arguments))},Iterator.chain=function(){return Iterator.concat(Array.prototype.slice.call(arguments))},Iterator.range=function(start,stop,step){return arguments.length<3&&(step=1),arguments.length<2&&(stop=start,start=0),start=start||0,step=step||1,new Iterator(function(){stop<=start&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);var result=start;return start+=step,this._iterationObject.value=result,this._iterationObject})},Iterator.count=function(start,step){return Iterator.range(start,1/0,step)},Iterator.repeat=function(value,times){return new Iterator.range(times).mapIterator(function(){return value})}},{"./generic-collection":25,"./shim-object":36}],30:[function(require,module,exports){var Map=require("../_map"),ObjectChangeDescriptor=module.exports.ObjectChangeDescriptor=function(name){return this.name=name,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(ObjectChangeDescriptor.prototype,{name:{value:null,writable:!0},isActive:{value:!1,writable:!0},_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new this.willChangeListenersRecordConstructor(this.name))}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new this.changeListenersRecordConstructor(this.name))}},changeListenersRecordConstructor:{value:ChangeListenersRecord,writable:!0},willChangeListenersRecordConstructor:{value:ChangeListenersRecord,writable:!0}});var ListenerGhost=module.exports.ListenerGhost=Object.create(null),ChangeListenerSpecificHandlerMethodName=new Map;function ChangeListenersRecord(name){var specificHandlerMethodName=ChangeListenerSpecificHandlerMethodName.get(name);return specificHandlerMethodName||(specificHandlerMethodName="handle",specificHandlerMethodName+=name,specificHandlerMethodName+="Change",ChangeListenerSpecificHandlerMethodName.set(name,specificHandlerMethodName)),this._current=null,this._current=null,this.specificHandlerMethodName=specificHandlerMethodName,this}module.exports.ChangeListenersRecord=ChangeListenersRecord,Object.defineProperties(ChangeListenersRecord.prototype,{_current:{value:null,writable:!0},current:{get:function(){return this._current},set:function(value){this._current=value}},ListenerGhost:{value:ListenerGhost,writable:!0},ghostCount:{value:0,writable:!0},maxListenerGhostRatio:{value:.3,writable:!0},listenerGhostFilter:{value:function(value){return value!==this.ListenerGhost}},removeCurrentGostListenersIfNeeded:{value:function(){return this._current&&this.ghostCount/this._current.length>this.maxListenerGhostRatio&&(this.ghostCount=0,this._current=this._current.filter(this.listenerGhostFilter,this)),this._current}},dispatchBeforeChange:{value:!1,writable:!0},genericHandlerMethodName:{value:"handlePropertyChange",writable:!0}}),module.exports.WillChangeListenersRecord=WillChangeListenersRecord;var WillChangeListenerSpecificHandlerMethodName=new Map;function WillChangeListenersRecord(name){var specificHandlerMethodName=WillChangeListenerSpecificHandlerMethodName.get(name);return specificHandlerMethodName||(specificHandlerMethodName="handle",specificHandlerMethodName+=name,specificHandlerMethodName+="WillChange",WillChangeListenerSpecificHandlerMethodName.set(name,specificHandlerMethodName)),this.specificHandlerMethodName=specificHandlerMethodName,this}((WillChangeListenersRecord.prototype=new ChangeListenersRecord).constructor=WillChangeListenersRecord).prototype.genericHandlerMethodName="handlePropertyWillChange"},{"../_map":22}],31:[function(require,module,exports){"use strict";var WeakMap=require("../weak-map"),Map=require("../_map"),ChangeDescriptor=require("./change-descriptor"),ObjectChangeDescriptor=ChangeDescriptor.ObjectChangeDescriptor,ChangeListenersRecord=ChangeDescriptor.ChangeListenersRecord,ListenerGhost=ChangeDescriptor.ListenerGhost;function MapChanges(){throw new Error("Can't construct. MapChanges is a mixin.")}module.exports=MapChanges;Object.prototype.hasOwnProperty;var mapChangeDescriptors=new WeakMap;function MapChangeDescriptor(name){this.name=name,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null}((MapChangeDescriptor.prototype=new ObjectChangeDescriptor).constructor=MapChangeDescriptor).prototype.changeListenersRecordConstructor=MapChangeListenersRecord,MapChangeDescriptor.prototype.willChangeListenersRecordConstructor=MapWillChangeListenersRecord;var MapChangeListenersSpecificHandlerMethodName=new Map;function MapChangeListenersRecord(name){var specificHandlerMethodName=MapChangeListenersSpecificHandlerMethodName.get(name);return specificHandlerMethodName||(specificHandlerMethodName="handle",specificHandlerMethodName+=name.slice(0,1).toUpperCase(),specificHandlerMethodName+=name.slice(1),specificHandlerMethodName+="MapChange",MapChangeListenersSpecificHandlerMethodName.set(name,specificHandlerMethodName)),this.specificHandlerMethodName=specificHandlerMethodName,this}((MapChangeListenersRecord.prototype=new ChangeListenersRecord).constructor=MapChangeListenersRecord).prototype.genericHandlerMethodName="handleMapChange";var MapWillChangeListenersSpecificHandlerMethodName=new Map;function MapWillChangeListenersRecord(name){var specificHandlerMethodName=MapWillChangeListenersSpecificHandlerMethodName.get(name);return specificHandlerMethodName||(specificHandlerMethodName="handle",specificHandlerMethodName+=name.slice(0,1).toUpperCase(),specificHandlerMethodName+=name.slice(1),specificHandlerMethodName+="MapWillChange",MapWillChangeListenersSpecificHandlerMethodName.set(name,specificHandlerMethodName)),this.specificHandlerMethodName=specificHandlerMethodName,this}((MapWillChangeListenersRecord.prototype=new ChangeListenersRecord).constructor=MapWillChangeListenersRecord).prototype.genericHandlerMethodName="handleMapWillChange",MapChanges.prototype.getAllMapChangeDescriptors=function(){return mapChangeDescriptors.has(this)||mapChangeDescriptors.set(this,new Map),mapChangeDescriptors.get(this)},MapChanges.prototype.getMapChangeDescriptor=function(token){var tokenChangeDescriptors=this.getAllMapChangeDescriptors();return token=token||"",tokenChangeDescriptors.has(token)||tokenChangeDescriptors.set(token,new MapChangeDescriptor(token)),tokenChangeDescriptors.get(token)};var ObjectsDispatchesMapChanges=new WeakMap,dispatchesChangesPropertyDescriptor={get:function(){return ObjectsDispatchesMapChanges.get(this)},set:function(value){return ObjectsDispatchesMapChanges.set(this,value)},configurable:!0,enumerable:!1};MapChanges.prototype.addMapChangeListener=function(listener,token,beforeChange){!this.isObservable&&this.makeObservable&&this.makeObservable();var listeners,descriptor=this.getMapChangeDescriptor(token);(listeners=beforeChange?descriptor.willChangeListeners:descriptor.changeListeners)._current?Array.isArray(listeners._current)?listeners._current.push(listener):listeners._current=[listeners._current,listener]:listeners._current=listener,void 0===Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),"dispatchesMapChanges")&&Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),"dispatchesMapChanges",dispatchesChangesPropertyDescriptor),this.dispatchesMapChanges=!0;var self=this;return function(){self&&(self.removeMapChangeListener(listener,token,beforeChange),self=null)}},MapChanges.prototype.removeMapChangeListener=function(listener,token,beforeChange){var listeners,descriptor=this.getMapChangeDescriptor(token);if((listeners=beforeChange?descriptor.willChangeListeners:descriptor.changeListeners)._current)if(listeners._current===listener)listeners._current=null;else{var index=listeners._current.lastIndexOf(listener);if(-1===index)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(token));descriptor.isActive?(listeners.ghostCount=listeners.ghostCount+1,listeners._current[index]=ListenerGhost):listeners._current.spliceOne(index)}},MapChanges.prototype.dispatchMapChange=function(key,value,beforeChange){var descriptors=this.getAllMapChangeDescriptors(),Ghost=ListenerGhost;descriptors.forEach(function(descriptor,token){if(!descriptor.isActive){var listeners=beforeChange?descriptor.willChangeListeners:descriptor.changeListeners;if(listeners&&listeners._current){var tokenName=listeners.specificHandlerMethodName;if(Array.isArray(listeners._current)&&listeners._current.length){var i,countI,listener,currentListeners=listeners.removeCurrentGostListenersIfNeeded();descriptor.isActive=!0;try{for(i=0,countI=currentListeners.length;i<countI;i++)if((listener=currentListeners[i])!==Ghost)if(listener[tokenName])listener[tokenName](value,key,this);else{if(!listener.call)throw new Error("Handler "+listener+" has no method "+tokenName+" and is not callable");listener.call(listener,value,key,this)}}finally{descriptor.isActive=!1}}else{descriptor.isActive=!0;try{if((listener=listeners._current)[tokenName])listener[tokenName](value,key,this);else{if(!listener.call)throw new Error("Handler "+listener+" has no method "+tokenName+" and is not callable");listener.call(listener,value,key,this)}}finally{descriptor.isActive=!1}}}}},this)},MapChanges.prototype.addBeforeMapChangeListener=function(listener,token){return this.addMapChangeListener(listener,token,!0)},MapChanges.prototype.removeBeforeMapChangeListener=function(listener,token){return this.removeMapChangeListener(listener,token,!0)},MapChanges.prototype.dispatchBeforeMapChange=function(key,value){return this.dispatchMapChange(key,value,!0)}},{"../_map":22,"../weak-map":40,"./change-descriptor":30}],32:[function(require,module,exports){Object.prototype.hasOwnProperty;function PropertyChanges(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}module.exports=PropertyChanges,require("../shim");var Map=require("../_map"),WeakMap=require("../weak-map"),ChangeDescriptor=require("./change-descriptor"),ObjectChangeDescriptor=ChangeDescriptor.ObjectChangeDescriptor,ListenerGhost=ChangeDescriptor.ListenerGhost;PropertyChanges.debug=!0;var ObjectsPropertyChangeListeners=new WeakMap,ObjectChangeDescriptorName=new Map;function dispatchEach(listeners,key,value,object){if(listeners&&listeners._current){var current,listener,i,countI,thisp,specificHandlerMethodName=listeners.specificHandlerMethodName,genericHandlerMethodName=listeners.genericHandlerMethodName,Ghost=ListenerGhost;if(Array.isArray(listeners._current)){for(i=0,countI=(current=listeners.removeCurrentGostListenersIfNeeded()).length;i<countI;i++)if((thisp=current[i])!==Ghost){if(!(listener=thisp[specificHandlerMethodName]||thisp[genericHandlerMethodName]||thisp).call)throw new Error("No event listener for "+listeners.specificHandlerName+" or "+listeners.genericHandlerName+" or call on "+listener);listener.call(thisp,value,key,object)}}else{if(!(listener=(thisp=listeners._current)[specificHandlerMethodName]||thisp[genericHandlerMethodName]||thisp).call)throw new Error("No event listener for "+listeners.specificHandlerName+" or "+listeners.genericHandlerName+" or call on "+listener);listener.call(thisp,value,key,object)}}}PropertyChanges.ObjectChangeDescriptor=function(){},PropertyChanges.prototype.getOwnPropertyChangeDescriptor=function(key){var keyChangeDescriptor,objectPropertyChangeDescriptors=ObjectsPropertyChangeListeners.get(this);if(objectPropertyChangeDescriptors||(objectPropertyChangeDescriptors=Object.create(null),ObjectsPropertyChangeListeners.set(this,objectPropertyChangeDescriptors)),void 0===(keyChangeDescriptor=objectPropertyChangeDescriptors[key])){var propertyName=ObjectChangeDescriptorName.get(key);return propertyName||(propertyName=(propertyName=String(key))&&propertyName[0].toUpperCase()+propertyName.slice(1),ObjectChangeDescriptorName.set(key,propertyName)),objectPropertyChangeDescriptors[key]=new ObjectChangeDescriptor(propertyName)}return keyChangeDescriptor},PropertyChanges.prototype.hasOwnPropertyChangeDescriptor=function(key){var objectPropertyChangeDescriptors=ObjectsPropertyChangeListeners.get(this);return!!objectPropertyChangeDescriptors&&(!key||void 0!==objectPropertyChangeDescriptors[key])},PropertyChanges.prototype.addOwnPropertyChangeListener=function(key,listener,beforeChange){this.makeObservable&&!this.isObservable&&this.makeObservable();var descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key),listeners=beforeChange?descriptor.willChangeListeners:descriptor.changeListeners;PropertyChanges.makePropertyObservable(this,key),listeners._current?Array.isArray(listeners._current)?listeners._current.push(listener):listeners._current=[listeners._current,listener]:listeners._current=listener;var self=this;return function(){PropertyChanges.removeOwnPropertyChangeListener(self,key,listener,beforeChange),self=null}},PropertyChanges.prototype.addBeforeOwnPropertyChangeListener=function(key,listener){return PropertyChanges.addOwnPropertyChangeListener(this,key,listener,!0)},(PropertyChanges.prototype.removeOwnPropertyChangeListener=function removeOwnPropertyChangeListener(key,listener,beforeChange){var listeners,descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key);if((listeners=beforeChange?descriptor._willChangeListeners:descriptor._changeListeners)&&listeners._current)if(listeners._current===listener)listeners._current=null;else{var index=listeners._current.lastIndexOf(listener);if(-1===index)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(key));descriptor.isActive?(listeners.ghostCount=listeners.ghostCount+1,listeners._current[index]=removeOwnPropertyChangeListener.ListenerGhost):listeners._current.spliceOne(index)}}).ListenerGhost=ListenerGhost,PropertyChanges.prototype.removeBeforeOwnPropertyChangeListener=function(key,listener){return PropertyChanges.removeOwnPropertyChangeListener(this,key,listener,!0)},((PropertyChanges.prototype.dispatchOwnPropertyChange=function dispatchOwnPropertyChange(key,value,beforeChange){var listeners,descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key);if(!descriptor.isActive){descriptor.isActive=!0,listeners=beforeChange?descriptor._willChangeListeners:descriptor._changeListeners;try{dispatchOwnPropertyChange.dispatchEach(listeners,key,value,this)}finally{descriptor.isActive=!1}}}).dispatchEach=dispatchEach).ListenerGhost=ListenerGhost,PropertyChanges.prototype.dispatchBeforeOwnPropertyChange=function(key,listener){return PropertyChanges.dispatchOwnPropertyChange(this,key,listener,!0)};var ObjectsOverriddenPropertyDescriptors=new WeakMap,propertyListener=(new WeakMap,{get:void 0,set:void 0,configurable:!0,enumerable:!1});PropertyChanges.prototype.makePropertyObservable=function(key){var overriddenPropertyDescriptors=ObjectsOverriddenPropertyDescriptors.get(this);if(!overriddenPropertyDescriptors||void 0===overriddenPropertyDescriptors.get(key)){if(!overriddenPropertyDescriptors){if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(key)+" observable on "+this+" because object is not extensible");overriddenPropertyDescriptors=new Map,ObjectsOverriddenPropertyDescriptors.set(this,overriddenPropertyDescriptors)}var overriddenDescriptor,attached=this;do{if(overriddenDescriptor=Object.getOwnPropertyDescriptor(attached,key))break;attached=Object.getPrototypeOf(attached)}while(attached);if(overriddenDescriptor){if(!overriddenDescriptor.configurable)return;if(!overriddenDescriptor.writable&&!overriddenDescriptor.set)return}else overriddenDescriptor={value:void 0,enumerable:!0,writable:!0,configurable:!0};overriddenPropertyDescriptors.set(key,overriddenDescriptor),"value"in overriddenDescriptor?(propertyListener.get=function dispatchingGetter(){return dispatchingGetter.overriddenDescriptor.value},propertyListener.set=function dispatchingSetter(value){var descriptor,isActive,overriddenDescriptor=dispatchingSetter.overriddenDescriptor;if(value!==overriddenDescriptor.value){if(!(isActive=(descriptor=dispatchingSetter.descriptor).isActive)){descriptor.isActive=!0;try{dispatchingSetter.dispatchEach(descriptor._willChangeListeners,dispatchingSetter.key,overriddenDescriptor.value,this)}finally{}}if(overriddenDescriptor.value=value,!isActive)try{dispatchingSetter.dispatchEach(descriptor._changeListeners,dispatchingSetter.key,value,this)}finally{descriptor.isActive=!1}}},propertyListener.set.dispatchEach=dispatchEach,propertyListener.set.key=key,propertyListener.get.overriddenDescriptor=propertyListener.set.overriddenDescriptor=overriddenDescriptor,propertyListener.set.descriptor=ObjectsPropertyChangeListeners.get(this)[key],propertyListener.enumerable=overriddenDescriptor.enumerable,propertyListener.configurable=!0):(propertyListener.get=overriddenDescriptor.get,propertyListener.set=function dispatchingSetter(){var descriptor,isActive,newValue,formerValue=dispatchingSetter.overriddenGetter.call(this);if(1===arguments.length?dispatchingSetter.overriddenSetter.call(this,arguments[0]):2===arguments.length?dispatchingSetter.overriddenSetter.call(this,arguments[0],arguments[1]):dispatchingSetter.overriddenSetter.apply(this,arguments),(newValue=dispatchingSetter.overriddenGetter.call(this))!==formerValue){if(!(isActive=(descriptor=dispatchingSetter.descriptor).isActive)){descriptor.isActive=!0;try{dispatchingSetter.dispatchEach(descriptor._willChangeListeners,key,formerValue,this)}finally{}}if(!isActive)try{dispatchingSetter.dispatchEach(descriptor._changeListeners,key,newValue,this)}finally{descriptor.isActive=!1}}},propertyListener.enumerable=overriddenDescriptor.enumerable,propertyListener.configurable=!0,propertyListener.set.dispatchEach=dispatchEach,propertyListener.set.overriddenSetter=overriddenDescriptor.set,propertyListener.set.overriddenGetter=overriddenDescriptor.get,propertyListener.set.descriptor=ObjectsPropertyChangeListeners.get(this)[key]),Object.defineProperty(this,key,propertyListener)}},PropertyChanges.getOwnPropertyChangeDescriptor=function(object,key){return object.getOwnPropertyChangeDescriptor?object.getOwnPropertyChangeDescriptor(key):PropertyChanges.prototype.getOwnPropertyChangeDescriptor.call(object,key)},PropertyChanges.hasOwnPropertyChangeDescriptor=function(object,key){return object.hasOwnPropertyChangeDescriptor?object.hasOwnPropertyChangeDescriptor(key):PropertyChanges.prototype.hasOwnPropertyChangeDescriptor.call(object,key)},PropertyChanges.addOwnPropertyChangeListener=function(object,key,listener,beforeChange){if(Object.isObject(object))return object.addOwnPropertyChangeListener?object.addOwnPropertyChangeListener(key,listener,beforeChange):this.prototype.addOwnPropertyChangeListener.call(object,key,listener,beforeChange)},PropertyChanges.removeOwnPropertyChangeListener=function(object,key,listener,beforeChange){if(Object.isObject(object))return object.removeOwnPropertyChangeListener?object.removeOwnPropertyChangeListener(key,listener,beforeChange):PropertyChanges.prototype.removeOwnPropertyChangeListener.call(object,key,listener,beforeChange)},PropertyChanges.dispatchOwnPropertyChange=function(object,key,value,beforeChange){if(Object.isObject(object))return object.dispatchOwnPropertyChange?object.dispatchOwnPropertyChange(key,value,beforeChange):PropertyChanges.prototype.dispatchOwnPropertyChange.call(object,key,value,beforeChange)},PropertyChanges.addBeforeOwnPropertyChangeListener=function(object,key,listener){return PropertyChanges.addOwnPropertyChangeListener(object,key,listener,!0)},PropertyChanges.removeBeforeOwnPropertyChangeListener=function(object,key,listener){return PropertyChanges.removeOwnPropertyChangeListener(object,key,listener,!0)},PropertyChanges.dispatchBeforeOwnPropertyChange=function(object,key,value){return PropertyChanges.dispatchOwnPropertyChange(object,key,value,!0)},PropertyChanges.makePropertyObservable=function(object,key){return object.makePropertyObservable?object.makePropertyObservable(key):PropertyChanges.prototype.makePropertyObservable.call(object,key)}},{"../_map":22,"../shim":38,"../weak-map":40,"./change-descriptor":30}],33:[function(require,module,exports){(function(global){"use strict";var Map=require("./_map"),PropertyChanges=require("./listen/property-changes"),MapChanges=require("./listen/map-changes");module.exports=Map,void 0===global.Map||"function"!=typeof global.Set.prototype.values?(Object.addEach(Map.prototype,PropertyChanges.prototype),Object.addEach(Map.prototype,MapChanges.prototype)):(Object.defineEach(Map.prototype,PropertyChanges.prototype,!1,!0,!1,!0),Object.defineEach(Map.prototype,MapChanges.prototype,!1,!0,!1,!0))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_map":22,"./listen/map-changes":31,"./listen/property-changes":32}],34:[function(require,module,exports){"use strict";require("./shim-function");var GenericCollection=require("./generic-collection"),GenericOrder=require("./generic-order"),WeakMap=require("./weak-map");module.exports=Array;var array_splice=Array.prototype.splice,array_slice=Array.prototype.slice;function define(key,value){Object.defineProperty(Array.prototype,key,{value:value,writable:!0,configurable:!0,enumerable:!1})}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=function(values){var array=[];return array.addEach(values),array},Array.unzip=function(table){for(var transpose=[],length=1/0,i=0;i<table.length;i++){var row=table[i];table[i]=row.toArray(),row.length<length&&(length=row.length)}for(i=0;i<table.length;i++){row=table[i];for(var j=0;j<row.length;j++)j<length&&j in row&&(transpose[j]=transpose[j]||[],transpose[j][i]=row[j])}return transpose},define("addEach",GenericCollection.prototype.addEach),define("deleteEach",GenericCollection.prototype.deleteEach),define("toArray",GenericCollection.prototype.toArray),define("toObject",GenericCollection.prototype.toObject),define("all",GenericCollection.prototype.all),define("any",GenericCollection.prototype.any),define("min",GenericCollection.prototype.min),define("max",GenericCollection.prototype.max),define("sum",GenericCollection.prototype.sum),define("average",GenericCollection.prototype.average),define("only",GenericCollection.prototype.only),define("flatten",GenericCollection.prototype.flatten),define("zip",GenericCollection.prototype.zip),define("enumerate",GenericCollection.prototype.enumerate),define("group",GenericCollection.prototype.group),define("sorted",GenericCollection.prototype.sorted),define("reversed",GenericCollection.prototype.reversed),define("constructClone",function(values){var clone=new this.constructor;return clone.addEach(values),clone}),define("has",function(value,equals){return-1!==this.findValue(value,equals)}),define("get",function(index,defaultValue){if(+index!==index)throw new Error("Indicies must be numbers");return!index in this?defaultValue:this[index]}),define("set",function(index,value){return this[index]=value,!0}),define("add",function(value){return this.push(value),!0}),define("delete",function(value,equals){var index=this.findValue(value,equals);return-1!==index&&(this.spliceOne(index),!0)}),define("deleteAll",function(value,equals){equals=equals||this.contentEquals||Object.equals;for(var count=0,index=0;index<this.length;)equals(value,this[index])?(this.swap(index,1),count++):index++;return count}),Array.prototype.find||define("find",function(predicate){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return kValue;k++}});var deprecatedWarnNonce={};function deprecatedWarn(msg,notOnce){"undefined"!=typeof console&&"function"==typeof console.warn&&!0!==notOnce&&!1===deprecatedWarnNonce.hasOwnProperty(msg)&&(console.warn(msg),deprecatedWarnNonce[msg]++)}var ArrayFindPrototype=Object.getOwnPropertyDescriptor(Array.prototype,"find").value;function ArrayIterator(array,start,end){this.array=array,this.start=null==start?0:start,this.end=end}define("find",function(value,equals,index){return"function"==typeof value&&this instanceof Array?ArrayFindPrototype.apply(this,arguments):(deprecatedWarn("Array#find usage is deprecated please use Array#findValue"),this.findValue.apply(this,arguments))}),define("findValue",function(value,equals,index){if(index)throw new Error("Array#findValue does not support third argument: index");equals=equals||this.contentEquals||Object.equals;for(index=0;index<this.length;index++)if(index in this&&equals(value,this[index]))return index;return-1}),define("findLast",function(value,equals){return deprecatedWarn("Array#findLast function is deprecated please use Array#findLastValue instead."),this.findLastValue.apply(this,arguments)}),define("findLastValue",function(value,equals){equals=equals||this.contentEquals||Object.equals;var index=this.length;do{if(--index in this&&equals(this[index],value))return index}while(0<index);return-1}),define("swap",function(start,length,plus){var args,plusLength,i,j,returnValue;if(start>this.length&&(this.length=start),void 0!==plus){if(args=[start,length],Array.isArray(plus)||(plus=array_slice.call(plus)),i=0,(plusLength=plus.length)<1e3){for(;i<plusLength;i++)args[i+2]=plus[i];return array_splice.apply(this,args)}for(returnValue=array_splice.apply(this,args);i<plusLength;){for(args=[start+i,0],j=2;j<1002&&i<plusLength;j++,i++)args[j]=plus[i];array_splice.apply(this,args)}return returnValue}return void 0!==length?array_splice.call(this,start,length):void 0!==start?array_splice.call(this,start):[]}),define("peek",function(){return this[0]}),define("poke",function(value){0<this.length&&(this[0]=value)}),define("peekBack",function(){if(0<this.length)return this[this.length-1]}),define("pokeBack",function(value){0<this.length&&(this[this.length-1]=value)}),define("one",function(){for(var i in this)if(Object.owns(this,i))return this[i]}),Array.prototype.clear||define("clear",function(){return this.length=0,this}),define("compare",function(that,compare){var i,length,relative;if(compare=compare||Object.compare,this===that)return 0;if(!that||!Array.isArray(that))return GenericOrder.prototype.compare.call(this,that,compare);for(length=this.length<that.length?this.length:that.length,i=0;i<length;i++)if(i in this){if(!(i in that))return-1;if(relative=compare(this[i],that[i]))return relative}else if(i in that)return 1;return this.length-that.length}),define("equals",function(that,equals){equals=equals||Object.equals;var i=0,length=this.length;if(this===that)return!0;if(!that||!Array.isArray(that))return GenericOrder.prototype.equals.call(this,that);if(length!==that.length)return!1;for(;i<length;++i)if(i in this){if(!(i in that))return!1;if(!equals(this[i],that[i]))return!1}else if(i in that)return!1;return!0}),define("clone",function(depth,memo){if(null==depth)depth=1/0;else if(0===depth)return this;if((memo=memo||new WeakMap).has(this))return memo.get(this);var clone=new Array(this.length);for(var i in memo.set(this,clone),this)clone[i]=Object.clone(this[i],depth-1,memo);return clone}),define("iterate",function(start,end){return new ArrayIterator(this,start,end)}),void 0===Array.prototype.spliceOne&&define("spliceOne",function(index,itemToAdd){var len=this.length;if(len)if(1===arguments.length){for(;index<len;)this[index]=this[index+1],index++;this.length--}else this[index]=itemToAdd}),define("Iterator",ArrayIterator),ArrayIterator.prototype.__iterationObject=null,Object.defineProperty(ArrayIterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),ArrayIterator.prototype.next=function(){return this.start===(null==this.end?this.array.length:this.end)?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=this.array[this.start++],this._iterationObject}},{"./generic-collection":25,"./generic-order":27,"./shim-function":35,"./weak-map":40}],35:[function(require,module,exports){module.exports=Function,Function.noop=function(){},Function.identity=function(value){return value},Function.by=function(by,compare){compare=compare||Object.compare,by=by||Function.identity;var compareBy=function(a,b){return compare(by(a),by(b))};return compareBy.compare=compare,compareBy.by=by,compareBy},Function.get=function(key){return function(object){return Object.get(object,key)}}},{}],36:[function(require,module,exports){"use strict";var WeakMap=require("./weak-map");module.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.isObject=function(object){return Object(object)===object},Object.getValueOf=function(value){return value&&"function"==typeof value.valueOf&&(value=value.valueOf()),value};var hashMap=new WeakMap;Object.hash=function(object){return object&&"function"==typeof object.hash?""+object.hash():Object(object)===object?(hashMap.has(object)||hashMap.set(object,Math.random().toString(36).slice(2)),hashMap.get(object)):""+object};var owns=Object.prototype.hasOwnProperty;Object.owns=function(object,key){return owns.call(object,key)},Object.has=function(object,key){if("object"!=typeof object)throw new Error("Object.has can't accept non-object: "+typeof object);if(object&&"function"==typeof object.has)return object.has(key);if("string"==typeof key)return key in object&&object[key]!==Object.prototype[key];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(object,key,value){if("object"!=typeof object)throw new Error("Object.get can't accept non-object: "+typeof object);return object&&"function"==typeof object.get?object.get(key,value):Object.has(object,key)?object[key]:value},Object.set=function(object,key,value){object&&"function"==typeof object.set?object.set(key,value):object[key]=value},Object.addEach=function(target,source,overrides){var overridesExistingProperty=3!==arguments.length||overrides;if(source)if("function"!=typeof source.forEach||source.hasOwnProperty("forEach"))if("number"==typeof source.length)for(var index=0;index<source.length;index++)target[index]=source[index];else for(var key,keys=Object.keys(source),i=0;key=keys[i];i++)!overridesExistingProperty&&Object.owns(target,key)||(target[key]=source[key]);else!0===source.isMap?source.forEach(function(value,key){target[key]=value}):source.forEach(function(pair){target[pair[0]]=pair[1]});else;return target},Object.defineEach=function(target,source,overrides,configurable,enumerable,writable){var overridesExistingProperty=3!==arguments.length||overrides;if(source)if("function"!=typeof source.forEach||source.hasOwnProperty("forEach"))if("number"==typeof source.length)for(var index=0;index<source.length;index++)Object.defineProperty(target,index,{value:source[index],writable:writable,configurable:configurable,enumerable:enumerable});else for(var key,keys=Object.keys(source),i=0;key=keys[i];i++)!overridesExistingProperty&&Object.owns(target,key)||Object.defineProperty(target,key,{value:source[key],writable:writable,configurable:configurable,enumerable:enumerable});else!0===source.isMap?source.forEach(function(value,key){Object.defineProperty(target,key,{value:value,writable:writable,configurable:configurable,enumerable:enumerable})}):source.forEach(function(pair){Object.defineProperty(target,pair[0],{value:pair[1],writable:writable,configurable:configurable,enumerable:enumerable})});else;return target},Object.forEach=function(object,callback,thisp){for(var iKey,keys=Object.keys(object),i=0;iKey=keys[i];i++)callback.call(thisp,object[iKey],iKey,object)},Object.map=function(object,callback,thisp){for(var iKey,keys=Object.keys(object),i=0,result=[];iKey=keys[i];i++)result.push(callback.call(thisp,object[iKey],iKey,object));return result},Object.values=function(object){return Object.map(object,Function.identity)},Object.concat=function(){for(var object={},i=0;i<arguments.length;i++)Object.addEach(object,arguments[i]);return object},Object.from=Object.concat,Object.is=function(x,y){return x===y?0!==x||1/x==1/y:x!=x&&y!=y},Object.equals=function(a,b,equals,memo){if(equals=equals||Object.equals,(a=Object.getValueOf(a))===(b=Object.getValueOf(b)))return!0;if(Object.isObject(a)){if((memo=memo||new WeakMap).has(a))return!0;memo.set(a,!0)}if(Object.isObject(a)&&"function"==typeof a.equals)return a.equals(b,equals,memo);if(Object.isObject(b)&&"function"==typeof b.equals)return b.equals(a,equals,memo);if(Object.isObject(a)&&Object.isObject(b)&&Object.getPrototypeOf(a)===Object.prototype&&Object.getPrototypeOf(b)===Object.prototype){for(var name in a)if(!equals(a[name],b[name],equals,memo))return!1;for(var name in b)if(!(name in a&&equals(b[name],a[name],equals,memo)))return!1;return!0}return a!=a&&b!=b||(!a||!b)&&a===b},Object.compare=function(a,b){if((a=Object.getValueOf(a))===(b=Object.getValueOf(b)))return 0;var aType=typeof a,bType=typeof b;return"number"===aType&&"number"===bType?a-b:"string"===aType&&"string"===bType?a<b?-1/0:1/0:a&&"function"==typeof a.compare?a.compare(b):b&&"function"==typeof b.compare?-b.compare(a):0},Object.clone=function(value,depth,memo){if(value=Object.getValueOf(value),memo=memo||new WeakMap,void 0===depth)depth=1/0;else if(0===depth)return value;if(Object.isObject(value)){if(!memo.has(value))if(value&&"function"==typeof value.clone)memo.set(value,value.clone(depth,memo));else{var prototype=Object.getPrototypeOf(value);if(null!==prototype&&prototype!==Object.prototype)throw new Error("Can't clone "+value);var clone=Object.create(prototype);for(var key in memo.set(value,clone),value)clone[key]=Object.clone(value[key],depth-1,memo)}return memo.get(value)}return value},Object.clear=function(object){if(object&&"function"==typeof object.clear)object.clear();else for(var keys=Object.keys(object),i=keys.length;i;)delete object[keys[--i]];return object}},{"./weak-map":40}],37:[function(require,module,exports){if(!RegExp.escape){var special=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(string){return string.replace(special,"\\$&")}}},{}],38:[function(require,module,exports){require("./shim-array"),require("./shim-object"),require("./shim-function"),require("./shim-regexp")},{"./shim-array":34,"./shim-function":35,"./shim-object":36,"./shim-regexp":37}],39:[function(require,module,exports){"use strict";function TreeLog(){}(module.exports=TreeLog).ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"},TreeLog.unicodeRound={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"╭",fromAbove:"╰",fromBoth:"┣",strafe:"┃"},TreeLog.unicodeSharp={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"┏",fromAbove:"┗",fromBoth:"┣",strafe:"┃"}},{}],40:[function(require,module,exports){module.exports="undefined"!=typeof WeakMap?WeakMap:require("weak-map")},{"weak-map":125}],41:[function(require,module,exports){(function(Buffer){function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=function(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)},exports.isBoolean=function(arg){return"boolean"==typeof arg},exports.isNull=function(arg){return null===arg},exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=function(arg){return"number"==typeof arg},exports.isString=function(arg){return"string"==typeof arg},exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=function(arg){return void 0===arg},exports.isRegExp=function(re){return"[object RegExp]"===objectToString(re)},exports.isObject=function(arg){return"object"==typeof arg&&null!==arg},exports.isDate=function(d){return"[object Date]"===objectToString(d)},exports.isError=function(e){return"[object Error]"===objectToString(e)||e instanceof Error},exports.isFunction=function(arg){return"function"==typeof arg},exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:require("../../is-buffer/index.js")})},{"../../is-buffer/index.js":62}],42:[function(require,module,exports){"use strict";var keys=require("object-keys"),foreach=require("foreach"),hasSymbols="function"==typeof Symbol&&"symbol"==typeof Symbol(),toStr=Object.prototype.toString,supportsDescriptors=Object.defineProperty&&function(){var obj={};try{for(var _ in Object.defineProperty(obj,"x",{enumerable:!1,value:obj}),obj)return!1;return obj.x===obj}catch(e){return!1}}(),defineProperty=function(object,name,value,predicate){var fn;name in object&&("function"!=typeof(fn=predicate)||"[object Function]"!==toStr.call(fn)||!predicate())||(supportsDescriptors?Object.defineProperty(object,name,{configurable:!0,enumerable:!1,value:value,writable:!0}):object[name]=value)},defineProperties=function(object,map){var predicates=2<arguments.length?arguments[2]:{},props=keys(map);hasSymbols&&(props=props.concat(Object.getOwnPropertySymbols(map))),foreach(props,function(name){defineProperty(object,name,map[name],predicates[name])})};defineProperties.supportsDescriptors=!!supportsDescriptors,module.exports=defineProperties},{foreach:46,"object-keys":65}],43:[function(require,module,exports){(function(process,Buffer){var stream=require("readable-stream"),eos=require("end-of-stream"),inherits=require("inherits"),shift=require("stream-shift"),SIGNAL_FLUSH=Buffer.from&&Buffer.from!==Uint8Array.from?Buffer.from([0]):new Buffer([0]),onuncork=function(self,fn){self._corked?self.once("uncork",fn):fn()},destroyer=function(self,end){return function(err){err?function(self,err){self._autoDestroy&&self.destroy(err)}(self,"premature close"===err.message?null:err):end&&!self._ended&&self.end()}},Duplexify=function(writable,readable,opts){if(!(this instanceof Duplexify))return new Duplexify(writable,readable,opts);stream.Duplex.call(this,opts),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!opts||!1!==opts.autoDestroy,this._forwardDestroy=!opts||!1!==opts.destroy,this._forwardEnd=!opts||!1!==opts.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,writable&&this.setWritable(writable),readable&&this.setReadable(readable)};inherits(Duplexify,stream.Duplex),Duplexify.obj=function(writable,readable,opts){return opts||(opts={}),opts.objectMode=!0,opts.highWaterMark=16,new Duplexify(writable,readable,opts)},Duplexify.prototype.cork=function(){1==++this._corked&&this.emit("cork")},Duplexify.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},Duplexify.prototype.setWritable=function(writable){if(this._unwrite&&this._unwrite(),this.destroyed)writable&&writable.destroy&&writable.destroy();else if(null!==writable&&!1!==writable){var self=this,unend=eos(writable,{writable:!0,readable:!1},destroyer(this,this._forwardEnd)),ondrain=function(){var ondrain=self._ondrain;self._ondrain=null,ondrain&&ondrain()};this._unwrite&&process.nextTick(ondrain),this._writable=writable,this._writable.on("drain",ondrain),this._unwrite=function(){self._writable.removeListener("drain",ondrain),unend()},this.uncork()}else this.end()},Duplexify.prototype.setReadable=function(readable){if(this._unread&&this._unread(),this.destroyed)readable&&readable.destroy&&readable.destroy();else{if(null===readable||!1===readable)return this.push(null),void this.resume();var rs,self=this,unend=eos(readable,{writable:!1,readable:!0},destroyer(this)),onreadable=function(){self._forward()},onend=function(){self.push(null)};this._drained=!0,this._readable=readable,this._readable2=readable._readableState?readable:(rs=readable,new stream.Readable({objectMode:!0,highWaterMark:16}).wrap(rs)),this._readable2.on("readable",onreadable),this._readable2.on("end",onend),this._unread=function(){self._readable2.removeListener("readable",onreadable),self._readable2.removeListener("end",onend),unend()},this._forward()}},Duplexify.prototype._read=function(){this._drained=!0,this._forward()},Duplexify.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var data;for(this._forwarding=!0;this._drained&&null!==(data=shift(this._readable2));)this.destroyed||(this._drained=this.push(data));this._forwarding=!1}},Duplexify.prototype.destroy=function(err){if(!this.destroyed){this.destroyed=!0;var self=this;process.nextTick(function(){self._destroy(err)})}},Duplexify.prototype._destroy=function(err){if(err){var ondrain=this._ondrain;this._ondrain=null,ondrain?ondrain(err):this.emit("error",err)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},Duplexify.prototype._write=function(data,enc,cb){return this.destroyed?cb():this._corked?onuncork(this,this._write.bind(this,data,enc,cb)):data===SIGNAL_FLUSH?this._finish(cb):this._writable?void(!1===this._writable.write(data)?this._ondrain=cb:cb()):cb()},Duplexify.prototype._finish=function(cb){var self=this;this.emit("preend"),onuncork(this,function(){var ws,fn;ws=self._forwardEnd&&self._writable,fn=function(){!1===self._writableState.prefinished&&(self._writableState.prefinished=!0),self.emit("prefinish"),onuncork(self,cb)},ws?ws._writableState&&ws._writableState.finished?fn():ws._writableState?ws.end(fn):(ws.end(),fn()):fn()})},Duplexify.prototype.end=function(data,enc,cb){return"function"==typeof data?this.end(null,null,data):"function"==typeof enc?this.end(data,null,enc):(this._ended=!0,data&&this.write(data),this._writableState.ending||this.write(SIGNAL_FLUSH),stream.Writable.prototype.end.call(this,cb))},module.exports=Duplexify}).call(this,require("_process"),require("buffer").Buffer)},{_process:89,buffer:17,"end-of-stream":44,inherits:61,"readable-stream":104,"stream-shift":114}],44:[function(require,module,exports){var once=require("once"),noop=function(){},eos=function(stream,opts,callback){if("function"==typeof opts)return eos(stream,null,opts);opts||(opts={}),callback=once(callback||noop);var ws=stream._writableState,rs=stream._readableState,readable=opts.readable||!1!==opts.readable&&stream.readable,writable=opts.writable||!1!==opts.writable&&stream.writable,onlegacyfinish=function(){stream.writable||onfinish()},onfinish=function(){writable=!1,readable||callback.call(stream)},onend=function(){readable=!1,writable||callback.call(stream)},onexit=function(exitCode){callback.call(stream,exitCode?new Error("exited with error code: "+exitCode):null)},onerror=function(err){callback.call(stream,err)},onclose=function(){return(!readable||rs&&rs.ended)&&(!writable||ws&&ws.ended)?void 0:callback.call(stream,new Error("premature close"))},onrequest=function(){stream.req.on("finish",onfinish)};return!function(stream){return stream.setHeader&&"function"==typeof stream.abort}(stream)?writable&&!ws&&(stream.on("end",onlegacyfinish),stream.on("close",onlegacyfinish)):(stream.on("complete",onfinish),stream.on("abort",onclose),stream.req?onrequest():stream.on("request",onrequest)),function(stream){return stream.stdio&&Array.isArray(stream.stdio)&&3===stream.stdio.length}(stream)&&stream.on("exit",onexit),stream.on("end",onend),stream.on("finish",onfinish),!1!==opts.error&&stream.on("error",onerror),stream.on("close",onclose),function(){stream.removeListener("complete",onfinish),stream.removeListener("abort",onclose),stream.removeListener("request",onrequest),stream.req&&stream.req.removeListener("finish",onfinish),stream.removeListener("end",onlegacyfinish),stream.removeListener("close",onlegacyfinish),stream.removeListener("finish",onfinish),stream.removeListener("exit",onexit),stream.removeListener("end",onend),stream.removeListener("error",onerror),stream.removeListener("close",onclose)}};module.exports=eos},{once:71}],45:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}((module.exports=EventEmitter).EventEmitter=EventEmitter).prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(isUndefined(handler=this._events[type]))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),len=(listeners=handler.slice()).length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.on=EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&0<m&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(length=(list=this._events[type]).length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;0<i--;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(listeners=this._events[type]))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){return this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],46:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function(obj,fn,ctx){if("[object Function]"!==toString.call(fn))throw new TypeError("iterator must be a function");var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},{}],47:[function(require,module,exports){"use strict";var slice=Array.prototype.slice,toStr=Object.prototype.toString;module.exports=function(that){var target=this;if("function"!=typeof target||"[object Function]"!==toStr.call(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=slice.call(arguments,1),boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)boundArgs.push("$"+i);if(bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))}),target.prototype){var Empty=function(){};Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null}return bound}},{}],48:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":47}],49:[function(require,module,exports){"use strict";module.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var obj={},sym=Symbol("test"),symObj=Object(sym);if("string"==typeof sym)return!1;if("[object Symbol]"!==Object.prototype.toString.call(sym))return!1;if("[object Symbol]"!==Object.prototype.toString.call(symObj))return!1;for(sym in obj[sym]=42,obj)return!1;if("function"==typeof Object.keys&&0!==Object.keys(obj).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(obj).length)return!1;var syms=Object.getOwnPropertySymbols(obj);if(1!==syms.length||syms[0]!==sym)return!1;if(!Object.prototype.propertyIsEnumerable.call(obj,sym))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(42!==descriptor.value||!0!==descriptor.enumerable)return!1}return!0}},{}],50:[function(require,module,exports){(function(Buffer){var net=require("net"),url=require("url"),EventEmitter=(require("util"),require("events").EventEmitter),PassThrough=require("stream").PassThrough,Readable=require("stream").Readable,Writable=require("stream").Writable,protocol=require("./protocol"),Endpoint=protocol.Endpoint,https=require("https"),assign=Object.assign||require("object.assign");exports.STATUS_CODES={202:"Accepted",502:"Bad Gateway",400:"Bad Request",409:"Conflict",100:"Continue",201:"Created",417:"Expectation Failed",424:"Failed Dependency",403:"Forbidden",504:"Gateway Timeout",410:"Gone",505:"HTTP Version Not Supported",419:"Insufficient Space on Resource",507:"Insufficient Storage",500:"Server Error",411:"Length Required",423:"Locked",420:"Method Failure",405:"Method Not Allowed",301:"Moved Permanently",302:"Moved Temporarily",207:"Multi-Status",300:"Multiple Choices",511:"Network Authentication Required",204:"No Content",203:"Non Authoritative Information",406:"Not Acceptable",404:"Not Found",501:"Not Implemented",304:"Not Modified",200:"OK",206:"Partial Content",402:"Payment Required",308:"Permanent Redirect",412:"Precondition Failed",428:"Precondition Required",102:"Processing",407:"Proxy Authentication Required",431:"Request Header Fields Too Large",408:"Request Timeout",413:"Request Entity Too Large",414:"Request-URI Too Long",416:"Requested Range Not Satisfiable",205:"Reset Content",303:"See Other",503:"Service Unavailable",101:"Switching Protocols",307:"Temporary Redirect",429:"Too Many Requests",401:"Unauthorized",422:"Unprocessable Entity",415:"Unsupported Media Type",305:"Use Proxy"},exports.IncomingMessage=IncomingMessage,exports.OutgoingMessage=OutgoingMessage,exports.protocol=protocol;var deprecatedHeaders=["connection","host","keep-alive","proxy-connection","transfer-encoding","upgrade"],supportedProtocols=[protocol.VERSION,"http/1.1","http/1.0"],cipherSuites=["ECDHE-RSA-AES128-GCM-SHA256","ECDHE-ECDSA-AES128-GCM-SHA256","ECDHE-RSA-AES256-GCM-SHA384","ECDHE-ECDSA-AES256-GCM-SHA384","DHE-RSA-AES128-GCM-SHA256","DHE-DSS-AES128-GCM-SHA256","ECDHE-RSA-AES128-SHA256","ECDHE-ECDSA-AES128-SHA256","ECDHE-RSA-AES128-SHA","ECDHE-ECDSA-AES128-SHA","ECDHE-RSA-AES256-SHA384","ECDHE-ECDSA-AES256-SHA384","ECDHE-RSA-AES256-SHA","ECDHE-ECDSA-AES256-SHA","DHE-RSA-AES128-SHA256","DHE-RSA-AES128-SHA","DHE-DSS-AES128-SHA256","DHE-RSA-AES256-SHA256","DHE-DSS-AES256-SHA","DHE-RSA-AES256-SHA","kEDH+AESGCM","AES128-GCM-SHA256","AES256-GCM-SHA384","ECDHE-RSA-RC4-SHA","ECDHE-ECDSA-RC4-SHA","AES128","AES256","RC4-SHA","HIGH","!aNULL","!eNULL","!EXPORT","!DES","!3DES","!MD5","!PSK"].join(":");function noop(){}var defaultLogger={fatal:noop,error:noop,warn:noop,info:noop,debug:noop,trace:noop,child:function(){return this}};function IncomingMessage(stream){PassThrough.call(this),stream.pipe(this),this.socket=this.stream=stream,this._log=stream._log.child({component:"http"}),this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers=void 0,this._lastHeadersSeen=void 0,stream.once("headers",this._onHeaders.bind(this)),stream.once("end",this._onEnd.bind(this))}exports.serializers=protocol.serializers,(IncomingMessage.prototype=Object.create(PassThrough.prototype,{constructor:{value:IncomingMessage}}))._onHeaders=function(headers){for(var name in this._validateHeaders(headers),headers)":"!==name[0]&&("set-cookie"!==name||Array.isArray(headers[name])?this.headers[name]=headers[name]:this.headers[name]=[headers[name]]);var self=this;this.stream.on("headers",function(headers){self._lastHeadersSeen=headers})},IncomingMessage.prototype._onEnd=function(){this.trailers=this._lastHeadersSeen},IncomingMessage.prototype.setTimeout=noop,IncomingMessage.prototype._checkSpecialHeader=function(key,value){return"string"==typeof value&&0!==value.length||(this._log.error({key:key,value:value},"Invalid or missing special header field"),this.stream.reset("PROTOCOL_ERROR")),value};var headerNamePattern=/[A-Z]/;function OutgoingMessage(){Writable.call(this),this._headers={},this._trailers=void 0,this.headersSent=!1,this.finished=!1,this.on("finish",this._finish)}function forwardEvent(event,source,target){function forward(){var listeners=target.listeners(event),n=listeners.length;if(0===n&&"error"===event){var args=[event];return args.push.apply(args,arguments),void target.emit.apply(target,args)}for(var i=0;i<n;++i)listeners[i].apply(source,arguments)}return source.on(event,forward),forward}function Server(options){options=assign({},options),this._log=(options.log||defaultLogger).child({component:"http"}),this._settings=options.settings;var start=this._start.bind(this),fallback=this._fallback.bind(this);if(options.key&&options.cert||options.pfx)this._log.info("Creating HTTP/2 server over TLS"),this._mode="tls",options.ALPNProtocols=supportedProtocols,options.NPNProtocols=supportedProtocols,options.ciphers=options.ciphers||cipherSuites,options.honorCipherOrder=!1!==options.honorCipherOrder,this._server=https.createServer(options),this._originalSocketListeners=this._server.listeners("secureConnection"),this._server.removeAllListeners("secureConnection"),this._server.on("secureConnection",function(socket){(socket.alpnProtocol||socket.npnProtocol)===protocol.VERSION?start(socket):fallback(socket)}),this._server.on("request",this.emit.bind(this,"request")),forwardEvent("error",this._server,this),forwardEvent("listening",this._server,this);else if(options.transport)this._mode="plain",this._server=options.transport(options,start);else{if(!options.plain)throw this._log.error("Trying to create HTTP/2 server with Upgrade from HTTP/1.1"),new Error("HTTP1.1 -> HTTP2 upgrade is not yet supported. Please provide TLS keys.");this._log.info("Creating HTTP/2 server over plain TCP"),this._mode="plain",this._server=net.createServer(start)}this._server.on("close",this.emit.bind(this,"close"))}function IncomingRequest(stream){IncomingMessage.call(this,stream)}function OutgoingResponse(stream){OutgoingMessage.call(this),this._log=stream._log.child({component:"http"}),this.stream=stream,this.statusCode=200,this.sendDate=!0,this.stream.once("headers",this._onRequestHeaders.bind(this))}function Agent(options){EventEmitter.call(this),this.setMaxListeners(0),options=assign({},options),this._settings=options.settings,this._log=(options.log||defaultLogger).child({component:"http"}),this.endpoints={},options.ALPNProtocols=supportedProtocols,options.NPNProtocols=supportedProtocols,this._httpsAgent=new https.Agent(options),this.sockets=this._httpsAgent.sockets,this.requests=this._httpsAgent.requests}function hasValue(obj){return null!=obj}function OutgoingRequest(){OutgoingMessage.call(this),this._log=void 0,this.stream=void 0}function IncomingResponse(stream){IncomingMessage.call(this,stream)}function IncomingPromise(responseStream,promiseHeaders){var stream=new Readable;stream._read=noop,stream.push(null),stream._log=responseStream._log,IncomingRequest.call(this,stream),this._onHeaders(promiseHeaders),this._responseStream=responseStream;var response=new IncomingResponse(this._responseStream);response.once("ready",this.emit.bind(this,"response",response)),this.stream.on("promise",this._onPromise.bind(this))}IncomingMessage.prototype._validateHeaders=function(headers){for(var i=0;i<deprecatedHeaders.length;i++){var key=deprecatedHeaders[i];if(key in headers||"te"===key&&"trailers"!==headers[key])return this._log.error({key:key,value:headers[key]},"Deprecated header found"),void this.stream.reset("PROTOCOL_ERROR")}for(var headerName in headers)if(headers.hasOwnProperty(headerName)){if(headerName.length<=1)return void this.stream.reset("PROTOCOL_ERROR");if(headerNamePattern.test(headerName))return void this.stream.reset("PROTOCOL_ERROR")}},(OutgoingMessage.prototype=Object.create(Writable.prototype,{constructor:{value:OutgoingMessage}}))._write=function(chunk,encoding,callback){this.stream?this.stream.write(chunk,encoding,callback):this.once("socket",this._write.bind(this,chunk,encoding,callback))},OutgoingMessage.prototype._finish=function(){this.stream?(this._trailers&&(this.request?this.request.addTrailers(this._trailers):this.stream.headers(this._trailers)),this.finished=!0,this.stream.end()):this.once("socket",this._finish.bind(this))},OutgoingMessage.prototype.setHeader=function(name,value){return this.headersSent?this.emit("error",new Error("Can't set headers after they are sent.")):(name=name.toLowerCase(),-1!==deprecatedHeaders.indexOf(name)?this.emit("error",new Error("Cannot set deprecated header: "+name)):void(this._headers[name]=value))},OutgoingMessage.prototype.removeHeader=function(name){if(this.headersSent)return this.emit("error",new Error("Can't remove headers after they are sent."));delete this._headers[name.toLowerCase()]},OutgoingMessage.prototype.getHeader=function(name){return this._headers[name.toLowerCase()]},OutgoingMessage.prototype.addTrailers=function(trailers){this._trailers=trailers},OutgoingMessage.prototype.setTimeout=noop,OutgoingMessage.prototype._checkSpecialHeader=IncomingMessage.prototype._checkSpecialHeader,exports.Server=Server,exports.IncomingRequest=IncomingRequest,exports.OutgoingResponse=OutgoingResponse,exports.ServerResponse=OutgoingResponse,(Server.prototype=Object.create(EventEmitter.prototype,{constructor:{value:Server}}))._start=function(socket){var endpoint=new Endpoint(this._log,"SERVER",this._settings);this._log.info({e:endpoint,client:socket.remoteAddress+":"+socket.remotePort,SNI:socket.servername},"New incoming HTTP/2 connection"),endpoint.pipe(socket).pipe(endpoint);var self=this;endpoint.on("stream",function(stream){var response=new OutgoingResponse(stream),request=new IncomingRequest(stream);request.remoteAddress=socket.remoteAddress,request.remotePort=socket.remotePort,request.connection=request.socket=response.socket=socket,request.once("ready",self.emit.bind(self,"request",request,response))}),endpoint.on("error",this.emit.bind(this,"clientError")),socket.on("error",this.emit.bind(this,"clientError")),this.emit("connection",socket,endpoint)},Server.prototype._fallback=function(socket){var negotiatedProtocol=socket.alpnProtocol||socket.npnProtocol;this._log.info({client:socket.remoteAddress+":"+socket.remotePort,protocol:negotiatedProtocol,SNI:socket.servername},"Falling back to simple HTTPS");for(var i=0;i<this._originalSocketListeners.length;i++)this._originalSocketListeners[i].call(this._server,socket);this.emit("connection",socket)},Server.prototype.listen=function(port,hostname){return this._log.info({on:"string"==typeof hostname?hostname+":"+port:port},"Listening for incoming connections"),this._server.listen.apply(this._server,arguments),this._server},Server.prototype.close=function(callback){this._log.info("Closing server"),this._server.close(callback)},Server.prototype.setTimeout=function(timeout,callback){"tls"===this._mode&&this._server.setTimeout(timeout,callback)},Object.defineProperty(Server.prototype,"timeout",{get:function(){return"tls"===this._mode?this._server.timeout:void 0},set:function(timeout){"tls"===this._mode&&(this._server.timeout=timeout)}}),Server.prototype.on=function(event,listener){return"upgrade"===event||"timeout"===event?this._server.on(event,listener&&listener.bind(this)):EventEmitter.prototype.on.call(this,event,listener)},Server.prototype.addContext=function(hostname,credentials){"tls"===this._mode&&this._server.addContext(hostname,credentials)},Server.prototype.address=function(){return this._server.address()},exports.https={},exports.createServer=exports.https.createServer=function(options,requestListener){if("function"==typeof options)throw new Error("options are required!");if(!(options.pfx||options.key&&options.cert))throw new Error("options.pfx or options.key and options.cert are required!");options.plain=!1;var server=new Server(options);return requestListener&&server.on("request",requestListener),server},exports.request=exports.https.request=function(options,callback){"string"==typeof options&&(options=url.parse(options));if(options.plain=!1,options.protocol&&"https:"!==options.protocol)throw new Error("This interface only supports https-schemed URLs");if(options.agent&&"function"==typeof options.agent.request){var agentOptions=assign({},options);return delete agentOptions.agent,options.agent.request(agentOptions,callback)}return exports.globalAgent.request(options,callback)},exports.get=exports.https.get=function(options,callback){"string"==typeof options&&(options=url.parse(options));if(options.plain=!1,options.protocol&&"https:"!==options.protocol)throw new Error("This interface only supports https-schemed URLs");if(options.agent&&"function"==typeof options.agent.get){var agentOptions=assign({},options);return delete agentOptions.agent,options.agent.get(agentOptions,callback)}return exports.globalAgent.get(options,callback)},exports.post=exports.https.post=function(options,body,callback){"string"==typeof options&&(options=url.parse(options));if(options.plain=!1,options.protocol&&"https:"!==options.protocol)throw new Error("This interface only supports https-schemed URLs");if(options.agent&&"function"==typeof options.agent.get){var agentOptions=assign({},options);return delete agentOptions.agent,options.agent.post(agentOptions,body,callback)}return exports.globalAgent.post(options,body,callback)},exports.raw={},exports.raw.createServer=function(options,requestListener){if("function"==typeof options&&(requestListener=options,options={}),options.pfx||options.key&&options.cert)throw new Error("options.pfx, options.key, and options.cert are nonsensical!");options.plain=!0;var server=new Server(options);return requestListener&&server.on("request",requestListener),server},exports.raw.request=function(options,callback){"string"==typeof options&&(options=url.parse(options));if(options.plain=!0,options.protocol&&"http:"!==options.protocol)throw new Error("This interface only supports http-schemed URLs");if(options.agent&&"function"==typeof options.agent.request){var agentOptions=assign({},options);return delete agentOptions.agent,options.agent.request(agentOptions,callback)}return exports.globalAgent.request(options,callback)},exports.raw.get=function(options,callback){"string"==typeof options&&(options=url.parse(options));if(options.plain=!0,options.protocol&&"http:"!==options.protocol)throw new Error("This interface only supports http-schemed URLs");if(options.agent&&"function"==typeof options.agent.get){var agentOptions=assign({},options);return delete agentOptions.agent,options.agent.get(agentOptions,callback)}return exports.globalAgent.get(options,callback)},exports.http={},exports.http.createServer=exports.http.request=exports.http.get=function(){throw new Error("HTTP UPGRADE is not implemented!")},(IncomingRequest.prototype=Object.create(IncomingMessage.prototype,{constructor:{value:IncomingRequest}}))._onHeaders=function(headers){this.method=this._checkSpecialHeader(":method",headers[":method"]),this.scheme=this._checkSpecialHeader(":scheme",headers[":scheme"]),this.host=this._checkSpecialHeader(":authority",headers[":authority"]),this.url=this._checkSpecialHeader(":path",headers[":path"]),this.method&&this.scheme&&this.host&&this.url&&(this.headers.host=this.host,IncomingMessage.prototype._onHeaders.call(this,headers),this._log.info({method:this.method,scheme:this.scheme,host:this.host,path:this.url,headers:this.headers},"Incoming request"),this.emit("ready"))},(OutgoingResponse.prototype=Object.create(OutgoingMessage.prototype,{constructor:{value:OutgoingResponse}})).writeHead=function(statusCode,reasonPhrase,headers){if(!this.headersSent){for(var headerName in"string"==typeof reasonPhrase?this._log.warn("Reason phrase argument was present but ignored by the writeHead method"):headers=reasonPhrase,headers)headers.hasOwnProperty(headerName)&&this.setHeader(headerName,headers[headerName]);headers=this._headers,!this.sendDate||"date"in this._headers||(headers.date=(new Date).toUTCString()),this._log.info({status:statusCode,headers:this._headers},"Sending server response"),headers[":status"]=this.statusCode=statusCode,this.stream.headers(headers),this.headersSent=!0}},OutgoingResponse.prototype._implicitHeaders=function(){this.headersSent||this.writeHead(this.statusCode)},OutgoingResponse.prototype._implicitHeader=function(){this._implicitHeaders()},OutgoingResponse.prototype.write=function(){return this._implicitHeaders(),OutgoingMessage.prototype.write.apply(this,arguments)},OutgoingResponse.prototype.end=function(){return this.finished=!0,this._implicitHeaders(),OutgoingMessage.prototype.end.apply(this,arguments)},OutgoingResponse.prototype._onRequestHeaders=function(headers){this._requestHeaders=headers},OutgoingResponse.prototype.push=function(options){if("string"==typeof options&&(options=url.parse(options)),!options.path)throw new Error("`path` option is mandatory.");var promise=assign({":method":(options.method||"GET").toUpperCase(),":scheme":options.protocol&&options.protocol.slice(0,-1)||this._requestHeaders[":scheme"],":authority":options.hostname||options.host||this._requestHeaders[":authority"],":path":options.path},options.headers);return this._log.info({method:promise[":method"],scheme:promise[":scheme"],authority:promise[":authority"],path:promise[":path"],headers:options.headers},"Promising push stream"),new OutgoingResponse(this.stream.promise(promise))},OutgoingResponse.prototype.altsvc=function(host,port,protocolID,maxAge,origin){void 0===origin&&(origin=""),this.stream.altsvc(host,port,protocolID,maxAge,origin)},OutgoingResponse.prototype.on=function(event,listener){this.request&&"timeout"===event?this.request.on(event,listener&&listener.bind(this)):OutgoingMessage.prototype.on.call(this,event,listener)},exports.ClientRequest=OutgoingRequest,exports.OutgoingRequest=OutgoingRequest,exports.IncomingResponse=IncomingResponse,exports.Agent=Agent,exports.globalAgent=void 0,(Agent.prototype=Object.create(EventEmitter.prototype,{constructor:{value:Agent}})).request=function(options,callback){(options="string"==typeof options?url.parse(options):assign({},options)).method=(options.method||"GET").toUpperCase(),options.protocol=options.protocol||"https:",options.host=options.hostname||options.host||"localhost",options.port=options.port||443,options.path=options.path||"/",options.plain||"http:"!==options.protocol||(this._log.error("Trying to negotiate client request with Upgrade from HTTP/1.1"),this.emit("error",new Error("HTTP1.1 -> HTTP2 upgrade is not yet supported.")));var key,endpoint,self=this,request=new OutgoingRequest(self._log);if(callback&&request.on("response",callback),(key=options.transportUrl&&options.transport?[options.transportUrl].join(":"):[!!options.plain,options.host,options.port].join(":"))in this.endpoints&&this.endpoints[key])endpoint=this.endpoints[key],request._start(endpoint.createStream(),options,endpoint);else if(options.transport)(endpoint=new Endpoint(this._log,"CLIENT",this._settings)).socket=options.transport,endpoint.socket.on("error",function(error){self._log.error("Socket error: "+error.toString()),request.emit("error",error)}),endpoint.on("error",function(error){self._log.error("Connection error: "+error.toString()),request.emit("error",error)}),endpoint.socket.on("close",function(error){delete self.endpoints[key]}),(this.endpoints[key]=endpoint).pipe(endpoint.socket).pipe(endpoint),request._start(endpoint.createStream(),options,endpoint);else if(options.plain)(endpoint=new Endpoint(this._log,"CLIENT",this._settings)).socket=net.connect({host:options.host,port:options.port,localAddress:options.localAddress}),endpoint.socket.on("error",function(error){self._log.error("Socket error: "+error.toString()),request.emit("error",error)}),endpoint.on("error",function(error){self._log.error("Connection error: "+error.toString()),request.emit("error",error)}),(this.endpoints[key]=endpoint).pipe(endpoint.socket).pipe(endpoint),request._start(endpoint.createStream(),options,endpoint);else{var started=!1,createAgent=function(options){return hasValue(options.pfx)||hasValue(options.key)||hasValue(options.passphrase)||hasValue(options.cert)||hasValue(options.ca)||hasValue(options.ciphers)||hasValue(options.rejectUnauthorized)||hasValue(options.secureProtocol)}(options);options.ALPNProtocols=supportedProtocols,options.NPNProtocols=supportedProtocols,options.servername=options.host,options.ciphers=options.ciphers||cipherSuites,createAgent?options.agent=new https.Agent(options):options.agent||(options.agent=this._httpsAgent);var httpsRequest=https.request(options);httpsRequest.on("error",function(error){self._log.error("Socket error: "+error.toString()),self.removeAllListeners(key),request.emit("error",error)}),httpsRequest.on("socket",function(socket){socket.alpnProtocol||socket.npnProtocol?negotiated():socket.on("secureConnect",negotiated)});var negotiated=function(){var endpoint,socket;(httpsRequest.socket.alpnProtocol||httpsRequest.socket.npnProtocol)===protocol.VERSION&&(httpsRequest.socket.emit("agentRemove"),(socket=httpsRequest.socket).removeAllListeners("data"),socket.removeAllListeners("end"),socket.removeAllListeners("readable"),socket.removeAllListeners("close"),socket.removeAllListeners("error"),socket.unpipe(),delete socket.ondata,delete socket.onend,(endpoint=new Endpoint(self._log,"CLIENT",self._settings)).socket=httpsRequest.socket,endpoint.pipe(endpoint.socket).pipe(endpoint)),started?endpoint&&endpoint.close():endpoint?(self._log.info({e:endpoint,server:options.host+":"+options.port},"New outgoing HTTP/2 connection"),self.endpoints[key]=endpoint,self.emit(key,endpoint)):self.emit(key,void 0)};this.once(key,function(endpoint){started=!0,endpoint?request._start(endpoint.createStream(),options,endpoint):request._fallback(httpsRequest)})}return request},Agent.prototype.get=function(options,callback){var request=this.request(options,callback);return request.end(),request},Agent.prototype.post=function(options,body,callback){var request=this.request(options,callback);return request.end(body),request},Agent.prototype.destroy=function(error){for(var endpointName in this._httpsAgent&&this._httpsAgent.destroy(),this.endpoints)this.endpoints.hasOwnProperty(endpointName)&&this.endpoints[endpointName].close(error)},Object.defineProperty(Agent.prototype,"maxSockets",{get:function(){return this._httpsAgent.maxSockets},set:function(value){this._httpsAgent.maxSockets=value}}),exports.globalAgent=new Agent,(OutgoingRequest.prototype=Object.create(OutgoingMessage.prototype,{constructor:{value:OutgoingRequest}}))._retryAfterTimer=null,OutgoingRequest.prototype._retryAfterBase=200,OutgoingRequest.prototype._retryAfterCap=3e4,OutgoingRequest.prototype._retryAfterAttempt=null,OutgoingRequest.prototype._retryAfter=function(retryAfterDelay){var options=this.options,endpoint=this.endpoint,newStream=endpoint.createStream();this._headers={},this.headersSent=!1,clearTimeout(this._retryAfterTimer),this._retryAfterAttempt=this._retryAfterAttempt?this._retryAfterAttempt++:1;var min,max,retryAfterDelayMs=Math.max(retryAfterDelay,(min=0,max=Math.min(this._retryAfterCap,this._retryAfterBase*Math.pow(2,this._retryAfterAttempt)),Math.floor(Math.random()*(max-min+1)+min)));this.stream=null,this._retryAfterTimer=setTimeout(this._start.bind(this,newStream,options,endpoint),retryAfterDelayMs)},OutgoingRequest.prototype._start=function(stream,options,endpoint){for(var headerName in this.stream=stream,this.options=options,this.endpoint=endpoint,this._log=stream._log.child({component:"http"}),options.headers)options.headers.hasOwnProperty(headerName)&&this.setHeader(headerName,options.headers[headerName]);var headers=this._headers;delete headers.host,options.auth&&(headers.authorization="Basic "+new Buffer(options.auth).toString("base64")),headers[":scheme"]=options.protocol.slice(0,-1),headers[":method"]=options.method,headers[":path"]=options.path,options.port?headers[":authority"]=options.host+":"+options.port:headers[":authority"]=options.host,headers["accept-encoding"]||(headers["accept-encoding"]="gzip"),this._log.info({scheme:headers[":scheme"],method:headers[":method"],authority:headers[":authority"],path:headers[":path"],headers:options.headers||{}},"Sending request"),this.stream.headers(headers),this.headersSent=!0,this.emit("socket",this.stream);var response=new IncomingResponse(this.stream);response.req=this,response.once("ready",this.emit.bind(this,"response",response)),this.stream.on("promise",this._onPromise.bind(this))},OutgoingRequest.prototype._fallback=function(request){request.on("response",this.emit.bind(this,"response")),this.stream=this.request=request,this.emit("socket",this.socket)},OutgoingRequest.prototype.setPriority=function(priority){this.stream?this.stream.priority(priority):this.once("socket",this.setPriority.bind(this,priority))},OutgoingRequest.prototype.on=function(event,listener){this.request&&"upgrade"===event?this.request.on(event,listener&&listener.bind(this)):OutgoingMessage.prototype.on.call(this,event,listener)},OutgoingRequest.prototype.setNoDelay=function(noDelay){this.request?this.request.setNoDelay(noDelay):this.stream||this.on("socket",this.setNoDelay.bind(this,noDelay))},OutgoingRequest.prototype.setSocketKeepAlive=function(enable,initialDelay){this.request?this.request.setSocketKeepAlive(enable,initialDelay):this.stream||this.on("socket",this.setSocketKeepAlive.bind(this,enable,initialDelay))},OutgoingRequest.prototype.setTimeout=function(timeout,callback){this.request?this.request.setTimeout(timeout,callback):this.stream||this.on("socket",this.setTimeout.bind(this,timeout,callback))},OutgoingRequest.prototype.abort=function(){clearTimeout(this._retryAfterTimer),this.request?this.request.abort():this.stream?this.stream.reset("CANCEL"):this.on("socket",this.abort.bind(this))},OutgoingRequest.prototype._onPromise=function(stream,headers){this._log.info({push_stream:stream.id},"Receiving push promise");var promise=new IncomingPromise(stream,headers);0<this.listeners("push").length?this.emit("push",promise):promise.cancel()},(IncomingResponse.prototype=Object.create(IncomingMessage.prototype,{constructor:{value:IncomingResponse}})).retryAfterStatusCodes=[503,302,429],IncomingResponse.prototype._onHeaders=function(headers){var retryAfter;if(this.statusCode=parseInt(this._checkSpecialHeader(":status",headers[":status"])),-1!==this.retryAfterStatusCodes.indexOf(this.statusCode)&&headers.hasOwnProperty("retry-after")&&headers["retry-after"]){var retryAfterDelay="number"==typeof(retryAfter=headers["retry-after"])?retryAfter:isNaN(retryAfter)?Math.ceil(new Date(retryAfter).getTime()/1e3-Date.now()/1e3):parseInt(retryAfter,10);return this._log.info({status:this.statusCode,headers:this.headers},"Incoming response with retry-after delay:"+retryAfterDelay),void this.req._retryAfter(retryAfterDelay)}IncomingMessage.prototype._onHeaders.call(this,headers),this._log.info({status:this.statusCode,headers:this.headers},"Incoming response"),this.emit("ready")},(IncomingPromise.prototype=Object.create(IncomingRequest.prototype,{constructor:{value:IncomingPromise}})).cancel=function(){this._responseStream.reset("CANCEL")},IncomingPromise.prototype.setPriority=function(priority){this._responseStream.priority(priority)},IncomingPromise.prototype._onPromise=OutgoingRequest.prototype._onPromise}).call(this,require("buffer").Buffer)},{"./protocol":57,buffer:17,events:45,https:59,net:16,"object.assign":68,stream:109,url:120,util:124}],51:[function(require,module,exports){module.exports=require("./http")},{"./http":50}],52:[function(require,module,exports){(function(Buffer){exports.HeaderTable=HeaderTable,exports.HuffmanTable=HuffmanTable,exports.HeaderSetCompressor=HeaderSetCompressor,exports.HeaderSetDecompressor=HeaderSetDecompressor,exports.Compressor=Compressor,exports.Decompressor=Decompressor;var TransformStream=require("stream").Transform,assert=require("assert"),util=require("util");function HeaderTable(log,limit){var self=HeaderTable.staticTable.map(entryFromPair);return self._log=log,self._limit=limit||DEFAULT_HEADER_TABLE_LIMIT,self._staticLength=self.length,self._size=0,self._enforceLimit=HeaderTable.prototype._enforceLimit,self.add=HeaderTable.prototype.add,self.setSizeLimit=HeaderTable.prototype.setSizeLimit,self}function entryFromPair(pair){var entry=pair.slice();return entry._size=function(entry){return new Buffer(entry[0]+entry[1],"utf8").length+32}(entry),entry}var DEFAULT_HEADER_TABLE_LIMIT=4096;function HeaderSetDecompressor(log,table){TransformStream.call(this,{objectMode:!0}),this._log=log.child({component:"compressor"}),this._table=table,this._chunks=[]}function HeaderSetCompressor(log,table){TransformStream.call(this,{objectMode:!0}),this._log=log.child({component:"compressor"}),this._table=table,this.push=TransformStream.prototype.push.bind(this)}function HuffmanTable(table){this.tree=function createTree(codes,position){if(1===codes.length)return[table.indexOf(codes[0])];position=position||0;for(var zero=[],one=[],i=0;i<codes.length;i++){var string=codes[i];"0"===string[position]?zero.push(string):one.push(string)}return[createTree(zero,position+1),createTree(one,position+1)]}(table),this.codes=table.map(function(bits){return parseInt(bits,2)}),this.lengths=table.map(function(bits){return bits.length})}HeaderTable.prototype._enforceLimit=function(limit){for(var droppedEntries=[];0<this._size&&this._size>limit;){var dropped=this.pop();this._size-=dropped._size,droppedEntries.unshift(dropped)}return droppedEntries},HeaderTable.prototype.add=function(entry){var limit=this._limit-entry._size,droppedEntries=this._enforceLimit(limit);return this._size<=limit&&(this.splice(this._staticLength,0,entry),this._size+=entry._size),droppedEntries},HeaderTable.prototype.setSizeLimit=function(limit){this._limit=limit,this._enforceLimit(this._limit)},HeaderTable.staticTable=[[":authority",""],[":method","GET"],[":method","POST"],[":path","/"],[":path","/index.html"],[":scheme","http"],[":scheme","https"],[":status","200"],[":status","204"],[":status","206"],[":status","304"],[":status","400"],[":status","404"],[":status","500"],["accept-charset",""],["accept-encoding","gzip, deflate"],["accept-language",""],["accept-ranges",""],["accept",""],["access-control-allow-origin",""],["age",""],["allow",""],["authorization",""],["cache-control",""],["content-disposition",""],["content-encoding",""],["content-language",""],["content-length",""],["content-location",""],["content-range",""],["content-type",""],["cookie",""],["date",""],["etag",""],["expect",""],["expires",""],["from",""],["host",""],["if-match",""],["if-modified-since",""],["if-none-match",""],["if-range",""],["if-unmodified-since",""],["last-modified",""],["link",""],["location",""],["max-forwards",""],["proxy-authenticate",""],["proxy-authorization",""],["range",""],["referer",""],["refresh",""],["retry-after",""],["server",""],["set-cookie",""],["strict-transport-security",""],["transfer-encoding",""],["user-agent",""],["vary",""],["via",""],["www-authenticate",""]],util.inherits(HeaderSetDecompressor,TransformStream),HeaderSetDecompressor.prototype._transform=function(chunk,encoding,callback){this._chunks.push(chunk),callback()},HeaderSetDecompressor.prototype._execute=function(rep){var entry,pair;if(this._log.trace({key:rep.name,value:rep.value,index:rep.index},"Executing header representation"),rep.contextUpdate)this._table.setSizeLimit(rep.newMaxSize);else if("number"==typeof rep.value){var index=rep.value;pair=(entry=this._table[index]).slice(),this.push(pair)}else pair="number"==typeof rep.name?[this._table[rep.name][0],rep.value]:[rep.name,rep.value],rep.index&&(entry=entryFromPair(pair),this._table.add(entry)),this.push(pair)},HeaderSetDecompressor.prototype._flush=function(callback){var buffer=concat(this._chunks);for(buffer.cursor=0;buffer.cursor<buffer.length;)this._execute(HeaderSetDecompressor.header(buffer));callback()},util.inherits(HeaderSetCompressor,TransformStream),HeaderSetCompressor.prototype.send=function(rep){this._log.trace({key:rep.name,value:rep.value,index:rep.index},"Emitting header representation"),rep.chunks||(rep.chunks=HeaderSetCompressor.header(rep)),rep.chunks.forEach(this.push)},HeaderSetCompressor.prototype._transform=function(pair,encoding,callback){for(var entry,name=pair[0].toLowerCase(),value=pair[1],nameMatch=-1,fullMatch=-1,droppedIndex=0;droppedIndex<this._table.length;droppedIndex++)if((entry=this._table[droppedIndex])[0]===name){if(entry[1]===value){fullMatch=droppedIndex;break}-1===nameMatch&&(nameMatch=droppedIndex)}var mustNeverIndex="cookie"===name&&value.length<20||"set-cookie"===name&&value.length<20||"authorization"===name;if(-1===fullMatch||mustNeverIndex){var indexing=(entry=entryFromPair(pair))._size<this._table._limit/2&&!mustNeverIndex;indexing&&this._table.add(entry),this.send({name:-1!==nameMatch?nameMatch:name,value:value,index:indexing,mustNeverIndex:mustNeverIndex,contextUpdate:!1})}else this.send({name:fullMatch,value:fullMatch,index:!1});callback()},HeaderSetCompressor.prototype._flush=function(callback){callback()},HeaderSetCompressor.integer=function(I,N){var limit=Math.pow(2,N)-1;if(I<limit)return[new Buffer([I])];var bytes=[];0!==N&&bytes.push(limit),I-=limit;for(var R,Q=1;0<Q;)R=I%128,0<(Q=Math.floor(I/128))&&(R+=128),bytes.push(R),I=Q;return[new Buffer(bytes)]},HeaderSetDecompressor.integer=function(buffer,N){var limit=Math.pow(2,N)-1,I=buffer[buffer.cursor]&limit;if(0!==N&&(buffer.cursor+=1),I===limit)for(var M=0;I+=(127&buffer[buffer.cursor])<<M,M+=7,buffer.cursor+=1,128&buffer[buffer.cursor-1];);return I},HuffmanTable.prototype.encode=function(buffer){var result=[],space=8;function add(data){8===space?result.push(data):result[result.length-1]|=data}for(var i=0;i<buffer.length;i++)for(var byte=buffer[i],code=this.codes[byte],length=this.lengths[byte];0!==length;){if(length<=space)add(code<<space-length),space-=length,length=code=0;else{var shift=length-space,msb=code>>shift;add(msb),code-=msb<<shift,length-=space,space=0}0===space&&(space=8)}return 8!==space&&add(this.codes[256]>>this.lengths[256]-space),new Buffer(result)},HuffmanTable.prototype.decode=function(buffer){for(var result=[],subtree=this.tree,i=0;i<buffer.length;i++)for(var byte=buffer[i],j=0;j<8;j++){var bit=128&byte?1:0;byte<<=1,1===(subtree=subtree[bit]).length&&(result.push(subtree[0]),subtree=this.tree)}return new Buffer(result)},HuffmanTable.huffmanTable=new HuffmanTable(["1111111111000","11111111111111111011000","1111111111111111111111100010","1111111111111111111111100011","1111111111111111111111100100","1111111111111111111111100101","1111111111111111111111100110","1111111111111111111111100111","1111111111111111111111101000","111111111111111111101010","111111111111111111111111111100","1111111111111111111111101001","1111111111111111111111101010","111111111111111111111111111101","1111111111111111111111101011","1111111111111111111111101100","1111111111111111111111101101","1111111111111111111111101110","1111111111111111111111101111","1111111111111111111111110000","1111111111111111111111110001","1111111111111111111111110010","111111111111111111111111111110","1111111111111111111111110011","1111111111111111111111110100","1111111111111111111111110101","1111111111111111111111110110","1111111111111111111111110111","1111111111111111111111111000","1111111111111111111111111001","1111111111111111111111111010","1111111111111111111111111011","010100","1111111000","1111111001","111111111010","1111111111001","010101","11111000","11111111010","1111111010","1111111011","11111001","11111111011","11111010","010110","010111","011000","00000","00001","00010","011001","011010","011011","011100","011101","011110","011111","1011100","11111011","111111111111100","100000","111111111011","1111111100","1111111111010","100001","1011101","1011110","1011111","1100000","1100001","1100010","1100011","1100100","1100101","1100110","1100111","1101000","1101001","1101010","1101011","1101100","1101101","1101110","1101111","1110000","1110001","1110010","11111100","1110011","11111101","1111111111011","1111111111111110000","1111111111100","11111111111100","100010","111111111111101","00011","100011","00100","100100","00101","100101","100110","100111","00110","1110100","1110101","101000","101001","101010","00111","101011","1110110","101100","01000","01001","101101","1110111","1111000","1111001","1111010","1111011","111111111111110","11111111100","11111111111101","1111111111101","1111111111111111111111111100","11111111111111100110","1111111111111111010010","11111111111111100111","11111111111111101000","1111111111111111010011","1111111111111111010100","1111111111111111010101","11111111111111111011001","1111111111111111010110","11111111111111111011010","11111111111111111011011","11111111111111111011100","11111111111111111011101","11111111111111111011110","111111111111111111101011","11111111111111111011111","111111111111111111101100","111111111111111111101101","1111111111111111010111","11111111111111111100000","111111111111111111101110","11111111111111111100001","11111111111111111100010","11111111111111111100011","11111111111111111100100","111111111111111011100","1111111111111111011000","11111111111111111100101","1111111111111111011001","11111111111111111100110","11111111111111111100111","111111111111111111101111","1111111111111111011010","111111111111111011101","11111111111111101001","1111111111111111011011","1111111111111111011100","11111111111111111101000","11111111111111111101001","111111111111111011110","11111111111111111101010","1111111111111111011101","1111111111111111011110","111111111111111111110000","111111111111111011111","1111111111111111011111","11111111111111111101011","11111111111111111101100","111111111111111100000","111111111111111100001","1111111111111111100000","111111111111111100010","11111111111111111101101","1111111111111111100001","11111111111111111101110","11111111111111111101111","11111111111111101010","1111111111111111100010","1111111111111111100011","1111111111111111100100","11111111111111111110000","1111111111111111100101","1111111111111111100110","11111111111111111110001","11111111111111111111100000","11111111111111111111100001","11111111111111101011","1111111111111110001","1111111111111111100111","11111111111111111110010","1111111111111111101000","1111111111111111111101100","11111111111111111111100010","11111111111111111111100011","11111111111111111111100100","111111111111111111111011110","111111111111111111111011111","11111111111111111111100101","111111111111111111110001","1111111111111111111101101","1111111111111110010","111111111111111100011","11111111111111111111100110","111111111111111111111100000","111111111111111111111100001","11111111111111111111100111","111111111111111111111100010","111111111111111111110010","111111111111111100100","111111111111111100101","11111111111111111111101000","11111111111111111111101001","1111111111111111111111111101","111111111111111111111100011","111111111111111111111100100","111111111111111111111100101","11111111111111101100","111111111111111111110011","11111111111111101101","111111111111111100110","1111111111111111101001","111111111111111100111","111111111111111101000","11111111111111111110011","1111111111111111101010","1111111111111111101011","1111111111111111111101110","1111111111111111111101111","111111111111111111110100","111111111111111111110101","11111111111111111111101010","11111111111111111110100","11111111111111111111101011","111111111111111111111100110","11111111111111111111101100","11111111111111111111101101","111111111111111111111100111","111111111111111111111101000","111111111111111111111101001","111111111111111111111101010","111111111111111111111101011","1111111111111111111111111110","111111111111111111111101100","111111111111111111111101101","111111111111111111111101110","111111111111111111111101111","111111111111111111111110000","11111111111111111111101110","111111111111111111111111111111"]),HeaderSetCompressor.string=function(str){str=new Buffer(str,"utf8");var huffman=HuffmanTable.huffmanTable.encode(str);if(huffman.length<str.length){var length=HeaderSetCompressor.integer(huffman.length,7);return length[0][0]|=128,length.concat(huffman)}return(length=HeaderSetCompressor.integer(str.length,7)).concat(str)},HeaderSetDecompressor.string=function(buffer){var huffman=128&buffer[buffer.cursor],length=HeaderSetDecompressor.integer(buffer,7),encoded=buffer.slice(buffer.cursor,buffer.cursor+length);return buffer.cursor+=length,(huffman?HuffmanTable.huffmanTable.decode(encoded):encoded).toString("utf8")};var representations_indexed={prefix:7,pattern:128},representations_literalIncremental={prefix:6,pattern:64},representations_contextUpdate={prefix:0,pattern:32},representations_literalNeverIndexed={prefix:4,pattern:16},representations_literal={prefix:4,pattern:0};HeaderSetCompressor.header=function(header){var representation,buffers=[];return(representation=header.contextUpdate?representations_contextUpdate:"number"==typeof header.value?representations_indexed:header.index?representations_literalIncremental:header.mustNeverIndex?representations_literalNeverIndexed:representations_literal)===representations_contextUpdate?buffers.push(HeaderSetCompressor.integer(header.newMaxSize,5)):representation===representations_indexed?buffers.push(HeaderSetCompressor.integer(header.value+1,representation.prefix)):("number"==typeof header.name?buffers.push(HeaderSetCompressor.integer(header.name+1,representation.prefix)):(buffers.push(HeaderSetCompressor.integer(0,representation.prefix)),buffers.push(HeaderSetCompressor.string(header.name))),buffers.push(HeaderSetCompressor.string(header.value))),buffers[0][0][0]|=representation.pattern,Array.prototype.concat.apply([],buffers)},HeaderSetDecompressor.header=function(buffer){var representation,header={},firstByte=buffer[buffer.cursor];return representation=128&firstByte?representations_indexed:64&firstByte?representations_literalIncremental:32&firstByte?representations_contextUpdate:16&firstByte?representations_literalNeverIndexed:representations_literal,header.value=header.name=-1,header.index=!1,header.contextUpdate=!1,header.newMaxSize=0,header.mustNeverIndex=!1,representation===representations_contextUpdate?(header.contextUpdate=!0,header.newMaxSize=HeaderSetDecompressor.integer(buffer,5)):representation===representations_indexed?header.value=header.name=HeaderSetDecompressor.integer(buffer,representation.prefix)-1:(header.name=HeaderSetDecompressor.integer(buffer,representation.prefix)-1,-1===header.name&&(header.name=HeaderSetDecompressor.string(buffer)),header.value=HeaderSetDecompressor.string(buffer),header.index=representation===representations_literalIncremental,header.mustNeverIndex=representation===representations_literalNeverIndexed),header};function Compressor(log,type){TransformStream.call(this,{objectMode:!0}),this._log=log.child({component:"compressor"}),assert("REQUEST"===type||"RESPONSE"===type),this._table=new HeaderTable(this._log),this.tableSizeChangePending=!1,this.lowestTableSizePending=0,this.tableSizeSetting=DEFAULT_HEADER_TABLE_LIMIT}function Decompressor(log,type){TransformStream.call(this,{objectMode:!0}),this._log=log.child({component:"compressor"}),assert("REQUEST"===type||"RESPONSE"===type),this._table=new HeaderTable(this._log),this._inProgress=!1,this._base=void 0}function concat(buffers){for(var size=0,i=0;i<buffers.length;i++)size+=buffers[i].length;for(var concatenated=new Buffer(size),cursor=0,j=0;j<buffers.length;cursor+=buffers[j].length,j++)buffers[j].copy(concatenated,cursor);return concatenated}function trim(string){return string.trim()}util.inherits(Compressor,TransformStream),Compressor.prototype.setTableSizeLimit=function(size){this._table.setSizeLimit(size),(!this.tableSizeChangePending||size<this.lowestTableSizePending)&&(this.lowestTableSizePending=size),this.tableSizeSetting=size,this.tableSizeChangePending=!0},Compressor.prototype.compress=function(headers){var compressor=new HeaderSetCompressor(this._log,this._table);this.tableSizeChangePending&&(this.lowestTableSizePending<this.tableSizeSetting&&compressor.send({contextUpdate:!0,newMaxSize:this.lowestTableSizePending,name:"",value:"",index:0}),compressor.send({contextUpdate:!0,newMaxSize:this.tableSizeSetting,name:"",value:"",index:0}),this.tableSizeChangePending=!1);var colonHeaders=[],nonColonHeaders=[];for(var name in headers)":"===name.trim()[0]?colonHeaders.push(name):nonColonHeaders.push(name);function compressHeader(name){var value=headers[name];if("cookie"==(name=String(name).toLowerCase())&&(value instanceof Array||(value=[value]),value=Array.prototype.concat.apply([],value.map(function(cookie){return String(cookie).split(";").map(trim)}))),value instanceof Array)for(var i=0;i<value.length;i++)compressor.write([name,String(value[i])]);else compressor.write([name,String(value)])}colonHeaders.forEach(compressHeader),nonColonHeaders.forEach(compressHeader),compressor.end();for(var chunk,chunks=[];chunk=compressor.read();)chunks.push(chunk);return concat(chunks)},Compressor.prototype._transform=function(frame,encoding,done){if("HEADERS"===frame.type||"PUSH_PROMISE"===frame.type)for(var chunks=function(buffer,size){var chunks=[],cursor=0;do{var chunkSize=Math.min(size,buffer.length-cursor);chunks.push(buffer.slice(cursor,cursor+chunkSize)),cursor+=chunkSize}while(cursor<buffer.length);return chunks}(this.compress(frame.headers),16384-("PUSH_PROMISE"===frame.type?4:0)),i=0;i<chunks.length;i++){var chunkFrame,first=0===i,last=i===chunks.length-1;first?((chunkFrame=util._extend({},frame)).flags=util._extend({},frame.flags),chunkFrame.flags["END_"+frame.type]=last):chunkFrame={type:"CONTINUATION",flags:{END_HEADERS:last},stream:frame.stream},chunkFrame.data=chunks[i],this.push(chunkFrame)}else this.push(frame);done()},util.inherits(Decompressor,TransformStream),Decompressor.prototype.setTableSizeLimit=function(size){this._table.setSizeLimit(size)},Decompressor.prototype.decompress=function(block){var decompressor=new HeaderSetDecompressor(this._log,this._table);decompressor.end(block);for(var pair,seenNonColonHeader=!1,headers={};pair=decompressor.read();){var name=pair[0],value=pair[1],isColonHeader=":"===name.trim()[0];if(seenNonColonHeader&&isColonHeader)return this.emit("error","PROTOCOL_ERROR"),headers;seenNonColonHeader=!isColonHeader,name in headers?headers[name]instanceof Array?headers[name].push(value):headers[name]=[headers[name],value]:headers[name]=value}return"cookie"in headers&&headers.cookie instanceof Array&&(headers.cookie=headers.cookie.join("; ")),headers},Decompressor.prototype._transform=function(frame,encoding,done){if(this._inProgress){if("CONTINUATION"!==frame.type||frame.stream!==this._base.stream)return this._log.error("A series of HEADER frames were not continuous"),void this.emit("error","PROTOCOL_ERROR");this._frames.push(frame)}else"HEADERS"===frame.type||"PUSH_PROMISE"===frame.type?(this._inProgress=!0,this._base=util._extend({},frame),this._frames=[frame]):this.push(frame);if(this._inProgress&&(frame.flags.END_HEADERS||frame.flags.END_PUSH_PROMISE)){var buffer=concat(this._frames.map(function(frame){return frame.data}));try{var headers=this.decompress(buffer)}catch(error){return this._log.error({err:error},"Header decompression error"),void this.emit("error","COMPRESSION_ERROR")}this.push(util._extend(this._base,{headers:headers})),this._inProgress=!1}done()}}).call(this,require("buffer").Buffer)},{assert:10,buffer:17,stream:109,util:124}],53:[function(require,module,exports){(function(global,Buffer){var assert=require("assert"),Flow=require("./flow").Flow;function Connection(log,firstStreamId,settings){Flow.call(this,0),this._log=log.child({component:"connection"}),this._initializeStreamManagement(firstStreamId),this._initializeLifecycleManagement(),this._initializeFlowControl(),this._initializeSettingsManagement(settings),this._initializeConnectionFlowControl(),this._initializeMultiplexing()}require("setimmediate"),(exports.Connection=Connection).prototype=Object.create(Flow.prototype,{constructor:{value:Connection}});var Stream=require("./stream").Stream;Connection.prototype._initializeStreamManagement=function(firstStreamId){this._streamIds=[],this._streamPriorities=[],this._nextStreamId=firstStreamId,this._lastIncomingStream=0,this._streamIds[0]={upstream:{write:this._writeControlFrame.bind(this)}},this._streamSlotsFree=1/0,this._streamLimit=1/0,this.on("RECEIVING_SETTINGS_MAX_CONCURRENT_STREAMS",this._updateStreamLimit)},Connection.prototype._writeControlFrame=function(frame){"SETTINGS"===frame.type||"PING"===frame.type||"GOAWAY"===frame.type||"WINDOW_UPDATE"===frame.type||"ALTSVC"===frame.type?(this._log.debug({frame:frame},"Receiving connection level frame"),this.emit(frame.type,frame)):(this._log.error({frame:frame},"Invalid connection level frame"),this.emit("error","PROTOCOL_ERROR"))},Connection.prototype._updateStreamLimit=function(newStreamLimit){var wakeup=0===this._streamSlotsFree&&newStreamLimit>this._streamLimit;this._streamSlotsFree+=newStreamLimit-this._streamLimit,this._streamLimit=newStreamLimit,wakeup&&this.emit("wakeup")},Connection.prototype._changeStreamCount=function(change){if(change){this._log.trace({free:this._streamSlotsFree,change:change},"Changing active stream count.");var wakeup=0===this._streamSlotsFree&&change<0;this._streamSlotsFree-=change,wakeup&&this.emit("wakeup")}},Connection.prototype._allocateId=function(stream,id){if(void 0===id)id=this._nextStreamId,this._nextStreamId+=2;else{if(!(id>this._lastIncomingStream&&(id-this._nextStreamId)%2!=0))return this._log.error({stream_id:id,lastIncomingStream:this._lastIncomingStream},"Invalid incoming stream ID."),void this.emit("error","PROTOCOL_ERROR");this._lastIncomingStream=id}return assert(!(id in this._streamIds)),this._log.trace({s:stream,stream_id:id},"Allocating ID for stream."),(this._streamIds[id]=stream).id=id,stream.on("connectionError",this.emit.bind(this,"error")),id},Connection.prototype._allocatePriority=function(stream){this._log.trace({s:stream},"Allocating priority for stream."),this._insert(stream,stream._priority),stream.on("priority",this._reprioritize.bind(this,stream)),stream.upstream.on("readable",this.emit.bind(this,"wakeup")),this.emit("wakeup")},Connection.prototype._insert=function(stream,priority){priority in this._streamPriorities?this._streamPriorities[priority].push(stream):this._streamPriorities[priority]=[stream]},Connection.prototype._reprioritize=function(stream,priority){this._removePrioritisedStream(stream),this._insert(stream,priority)},Connection.prototype._removePrioritisedStream=function(stream){var bucket=this._streamPriorities[stream._priority],index=bucket.indexOf(stream);assert(-1!==index),bucket.splice(index,1),0===bucket.length&&delete this._streamPriorities[stream._priority]},Connection.prototype._createIncomingStream=function(id){this._log.debug({stream_id:id},"New incoming stream.");var stream=new Stream(this._log,this);return this._allocateId(stream,id),this._allocatePriority(stream),this.emit("stream",stream,id),stream},Connection.prototype.createStream=function(){this._log.trace("Creating new outbound stream.");var stream=new Stream(this._log,this);return this._allocatePriority(stream),this.emit("new_stream",stream),stream.on("state",this._streamStateChange.bind(this,stream)),stream},Connection.prototype._streamStateChange=function(stream,state){if("CLOSED"===state)if(stream._closedByUs)setTimeout(this._removeStream.bind(self,stream),3e4);else this._removeStream(stream)},Connection.prototype._removeStream=function(stream){this._log.trace("Removing outbound stream."),delete this._streamIds[stream.id],this._removePrioritisedStream(stream)},Connection.prototype._initializeMultiplexing=function(){this.on("window_update",this.emit.bind(this,"wakeup")),this._sendScheduled=!1,this._firstFrameReceived=!1},Connection.prototype._send=function(immediate){if(!this._closed)if(immediate){this._sendScheduled=!1,this._log.trace("Starting forwarding frames from streams.");priority_loop:for(var priority in this._streamPriorities)for(var bucket=this._streamPriorities[priority],nextBucket=[];0<bucket.length;){for(var index=0;index<bucket.length;index++){var stream=bucket[index],frame=stream.upstream.read(0<this._window?this._window:-1);if(frame)if(frame.count_change>this._streamSlotsFree)stream.upstream.unshift(frame);else{nextBucket.push(stream),void 0===frame.stream&&(frame.stream=stream.id||this._allocateId(stream)),"PUSH_PROMISE"===frame.type&&(this._allocatePriority(frame.promised_stream),frame.promised_stream=this._allocateId(frame.promised_stream)),this._log.trace({s:stream,frame:frame},"Forwarding outgoing frame");var moreNeeded=this.push(frame);if(this._changeStreamCount(frame.count_change),!moreNeeded)break priority_loop}}bucket=nextBucket,nextBucket=[]}void 0===moreNeeded&&this.once("wakeup",this._send.bind(this)),this._log.trace({moreNeeded:moreNeeded},"Stopping forwarding frames from streams.")}else this._sendScheduled||(this._sendScheduled=!0,global.setImmediate(this._send.bind(this,!0)))},Connection.prototype._receive=function(frame,done){if(this._log.trace({frame:frame},"Forwarding incoming frame"),this._firstFrameReceived||(this._firstFrameReceived=!0,this._onFirstFrameReceived(frame)),"SETTINGS"!=frame.type&&"PING"!=frame.type&&"GOAWAY"!=frame.type||0==frame.stream)if("DATA"!=frame.type&&"HEADERS"!=frame.type&&"PRIORITY"!=frame.type&&"RST_STREAM"!=frame.type&&"PUSH_PROMISE"!=frame.type&&"CONTINUATION"!=frame.type||0!=frame.stream){var stream=this._streamIds[frame.stream];if(!stream){if("PRIORITY"===frame.type)return;stream=this._createIncomingStream(frame.stream)}"PUSH_PROMISE"===frame.type&&(frame.promised_stream=this._createIncomingStream(frame.promised_stream)),frame.count_change=this._changeStreamCount.bind(this),stream.upstream.write(frame),done()}else this.close("PROTOCOL_ERROR");else this.close("PROTOCOL_ERROR")};var defaultSettings={SETTINGS_INITIAL_WINDOW_SIZE:6291456};Connection.prototype._initializeSettingsManagement=function(settings){this._settingsAckCallbacks=[],this._log.debug({settings:settings},"Sending the first SETTINGS frame as part of the connection header."),this.set(settings||defaultSettings),this.on("SETTINGS",this._receiveSettings),this.on("RECEIVING_SETTINGS_MAX_FRAME_SIZE",this._sanityCheckMaxFrameSize)},Connection.prototype._onFirstFrameReceived=function(frame){0===frame.stream&&"SETTINGS"===frame.type?this._log.debug("Receiving the first SETTINGS frame as part of the connection header."):(this._log.fatal({frame:frame},"Invalid connection header: first frame is not SETTINGS."),this.emit("error","PROTOCOL_ERROR"))},Connection.prototype._receiveSettings=function(frame){if(frame.flags.ACK){var callback=this._settingsAckCallbacks.shift();callback&&callback()}else for(var name in this._closed||this.push({type:"SETTINGS",flags:{ACK:!0},stream:0,settings:{}}),frame.settings)this.emit("RECEIVING_"+name,frame.settings[name])},Connection.prototype._sanityCheckMaxFrameSize=function(value){(value<16384||16777216<=value)&&(this._log.fatal("Received invalid value for max frame size: "+value),this.emit("error"))},Connection.prototype.set=function(settings,callback){var self=this;for(var name in this._settingsAckCallbacks.push(function(){for(var name in settings)self.emit("ACKNOWLEDGED_"+name,settings[name]);callback&&callback()}),this.push({type:"SETTINGS",flags:{ACK:!1},stream:0,settings:settings}),settings)this.emit("SENDING_"+name,settings[name])},Connection.prototype._initializeLifecycleManagement=function(){this._pings={},this.on("PING",this._receivePing),this.on("GOAWAY",this._receiveGoaway),this._closed=!1},Connection.prototype._generatePingId=function(){do{for(var id="",i=0;i<16;i++)id+=Math.floor(16*Math.random()).toString(16)}while(id in this._pings);return id},Connection.prototype.ping=function(callback){var id=this._generatePingId(),data=new Buffer(id,"hex");this._pings[id]=callback,this._log.debug({data:data},"Sending PING."),this.push({type:"PING",flags:{ACK:!1},stream:0,data:data})},Connection.prototype._receivePing=function(frame){if(frame.flags.ACK){var id=frame.data.toString("hex");if(id in this._pings){this._log.debug({data:frame.data},"Receiving answer for a PING.");var callback=this._pings[id];callback&&callback(),delete this._pings[id]}else this._log.warn({data:frame.data},"Unsolicited PING answer.")}else this._log.debug({data:frame.data},"Answering PING."),this.push({type:"PING",flags:{ACK:!0},stream:0,data:frame.data})},Connection.prototype.close=function(error){this._closed?this._log.warn("Trying to close an already closed connection"):(this._log.debug({error:error},"Closing the connection"),this.push({type:"GOAWAY",flags:{},stream:0,last_stream:this._lastIncomingStream,error:error||"NO_ERROR"}),this.push(null),this._closed=!0)},Connection.prototype._receiveGoaway=function(frame){this._log.debug({error:frame.error},"Other end closed the connection"),this.push(null),this._closed=!0,"NO_ERROR"!==frame.error&&this.emit("peerError",frame.error)},Connection.prototype._initializeFlowControl=function(){this._initialStreamWindowSize=6291456,this.on("new_stream",function(stream){stream.upstream.setInitialWindow(this._initialStreamWindowSize)}),this.on("RECEIVING_SETTINGS_INITIAL_WINDOW_SIZE",this._setInitialStreamWindowSize),this._streamIds[0].upstream.setInitialWindow=function(){}},Connection.prototype._initializeConnectionFlowControl=function(){this.push({type:"WINDOW_UPDATE",flags:{},stream:0,window_size:15663105})},Connection.prototype._setInitialStreamWindowSize=function(size){this._initialStreamWindowSize===1/0&&size!==1/0?(this._log.error("Trying to manipulate initial flow control window size after flow control was turned off."),this.emit("error","FLOW_CONTROL_ERROR")):(this._log.debug({size:size},"Changing stream initial window size."),this._initialStreamWindowSize=size,this._streamIds.forEach(function(stream){stream.upstream.setInitialWindow(size)}))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./flow":55,"./stream":58,assert:10,buffer:17,setimmediate:108}],54:[function(require,module,exports){(function(global,Buffer){var assert=require("assert"),Serializer=require("./framer").Serializer,Deserializer=require("./framer").Deserializer,Compressor=require("./compressor").Compressor,Decompressor=require("./compressor").Decompressor,Connection=require("./connection").Connection,Duplex=require("stream").Duplex,Transform=require("stream").Transform;function Endpoint(log,role,settings,filters){Duplex.call(this),this._log=log.child({component:"endpoint",e:this}),assert("CLIENT"===role||"SERVER"===role),"CLIENT"===role?this._writePrelude():this._readPrelude(),this._initializeDataFlow(role,settings,filters||{}),this._initializeManagement(),this._initializeErrorHandling()}require("setimmediate"),(exports.Endpoint=Endpoint).prototype=Object.create(Duplex.prototype,{constructor:{value:Endpoint}});var CLIENT_PRELUDE=new Buffer("PRI * HTTP/2.0\r\n\r\nSM\r\n\r\n");function pipeAndFilter(stream1,stream2,filter){filter?stream1.pipe(function(filter){var transform=new Transform({objectMode:!0}),push=transform.push.bind(transform);return transform._transform=function(frame,encoding,done){filter(frame,push,done)},transform}(filter)).pipe(stream2):stream1.pipe(stream2)}Endpoint.prototype._writePrelude=function(){this._log.debug("Sending the client connection header prelude."),this.push(CLIENT_PRELUDE)},Endpoint.prototype._readPrelude=function(){var cursor=0;this._write=function(chunk,encoding,done){for(var offset=cursor;cursor<CLIENT_PRELUDE.length&&cursor-offset<chunk.length;){if(CLIENT_PRELUDE[cursor]!==chunk[cursor-offset])return this._log.fatal({cursor:cursor,offset:offset,chunk:chunk},"Client connection header prelude does not match."),void this._error("handshake","PROTOCOL_ERROR");cursor+=1}cursor===CLIENT_PRELUDE.length&&(this._log.debug("Successfully received the client connection header prelude."),delete this._write,chunk=chunk.slice(cursor-offset),this._write(chunk,encoding,done))}},Endpoint.prototype._initializeDataFlow=function(role,settings,filters){var firstStreamId,compressorRole,decompressorRole;"CLIENT"===role?(firstStreamId=1,compressorRole="REQUEST",decompressorRole="RESPONSE"):(firstStreamId=2,compressorRole="RESPONSE",decompressorRole="REQUEST"),this._serializer=new Serializer(this._log),this._deserializer=new Deserializer(this._log),this._compressor=new Compressor(this._log,compressorRole),this._decompressor=new Decompressor(this._log,decompressorRole),this._connection=new Connection(this._log,firstStreamId,settings),pipeAndFilter(this._connection,this._compressor,filters.beforeCompression),pipeAndFilter(this._compressor,this._serializer,filters.beforeSerialization),pipeAndFilter(this._deserializer,this._decompressor,filters.afterDeserialization),pipeAndFilter(this._decompressor,this._connection,filters.afterDecompression),this._connection.on("ACKNOWLEDGED_SETTINGS_HEADER_TABLE_SIZE",this._decompressor.setTableSizeLimit.bind(this._decompressor)),this._connection.on("RECEIVING_SETTINGS_HEADER_TABLE_SIZE",this._compressor.setTableSizeLimit.bind(this._compressor))};var noread={};Endpoint.prototype._read=function(){this._readableState.sync=!0;for(var chunk,moreNeeded=noread;moreNeeded&&(chunk=this._serializer.read());)moreNeeded=this.push(chunk);moreNeeded===noread&&this._serializer.once("readable",this._read.bind(this)),this._readableState.sync=!1},Endpoint.prototype._write=function(chunk,encoding,done){this._deserializer.write(chunk,encoding,done)},Endpoint.prototype._initializeManagement=function(){this._connection.on("stream",this.emit.bind(this,"stream"))},Endpoint.prototype.createStream=function(){return this._connection.createStream()},Endpoint.prototype._initializeErrorHandling=function(){this._serializer.on("error",this._error.bind(this,"serializer")),this._deserializer.on("error",this._error.bind(this,"deserializer")),this._compressor.on("error",this._error.bind(this,"compressor")),this._decompressor.on("error",this._error.bind(this,"decompressor")),this._connection.on("error",this._error.bind(this,"connection")),this._connection.on("peerError",this.emit.bind(this,"peerError"))},Endpoint.prototype._error=function(component,error){this._log.fatal({source:component,message:error},"Fatal error, closing connection"),this.close(error),global.setImmediate(this.emit.bind(this,"error",error))},Endpoint.prototype.close=function(error){this._connection.close(error)},exports.serializers={};var nextId=0;exports.serializers.e=function(endpoint){return"id"in endpoint||(endpoint.id=nextId,nextId+=1),endpoint.id}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./compressor":52,"./connection":53,"./framer":56,assert:10,buffer:17,setimmediate:108,stream:109}],55:[function(require,module,exports){(function(global){var assert=require("assert");require("setimmediate");var Duplex=require("stream").Duplex;exports.Flow=Flow;var INITIAL_WINDOW_SIZE=65535;function Flow(flowControlId){Duplex.call(this,{objectMode:!0}),this._window=this._initialWindow=INITIAL_WINDOW_SIZE,this._flowControlId=flowControlId,this._queue=[],this._ended=!1,this._received=0,this._blocked=!1}(Flow.prototype=Object.create(Duplex.prototype,{constructor:{value:Flow}}))._receive=function(frame,callback){throw new Error("The _receive(frame, callback) method has to be overridden by the child class!")},Flow.prototype._write=function(frame,encoding,callback){var sentToUs=void 0===this._flowControlId||frame.stream===this._flowControlId;sentToUs&&(frame.flags.END_STREAM||"RST_STREAM"===frame.type)&&(this._ended=!0),"DATA"===frame.type&&0<frame.data.length?this._receive(frame,function(){this._received+=frame.data.length,this._restoreWindowTimer||(this._restoreWindowTimer=global.setImmediate(this._restoreWindow.bind(this))),callback()}.bind(this)):this._receive(frame,callback),sentToUs&&"WINDOW_UPDATE"===frame.type&&this._updateWindow(frame)},Flow.prototype._restoreWindow=function(){delete this._restoreWindowTimer,!this._ended&&0<this._received&&(this.push({type:"WINDOW_UPDATE",flags:{},stream:this._flowControlId,window_size:this._received}),this._received=0)},Flow.prototype._send=function(){throw new Error("The _send() method has to be overridden by the child class!")},Flow.prototype._read=function(){if(0===this._queue.length)this._send();else if(0<this._window){this._blocked=!1,this._readableState.sync=!0;do{var moreNeeded=this._push(this._queue[0]);null!==moreNeeded&&this._queue.shift()}while(moreNeeded&&0<this._queue.length);this._readableState.sync=!1,assert(!moreNeeded||0===this._queue.length||!this._window&&"DATA"===this._queue[0].type)}else this._blocked||(this._parentPush({type:"BLOCKED",flags:{},stream:this._flowControlId}),this.once("window_update",this._read),this._blocked=!0)};Flow.prototype.read=function(limit){if(0===limit)return Duplex.prototype.read.call(this,0);-1===limit?limit=0:(void 0===limit||4096<limit)&&(limit=4096);var frame=bufferHead(this._readableState.buffer);if(frame||this._readableState.ended||(this._read(),frame=bufferHead(this._readableState.buffer)),frame&&"DATA"===frame.type){if(0===limit)return Duplex.prototype.read.call(this,0);frame.data.length>limit&&(this._log.trace({frame:frame,size:frame.data.length,forwardable:limit},"Splitting out forwardable part of a DATA frame."),this.unshift({type:"DATA",flags:{},stream:frame.stream,data:frame.data.slice(0,limit)}),frame.data=frame.data.slice(limit))}return Duplex.prototype.read.call(this)},Flow.prototype._parentPush=function(frame){return this._log.trace({frame:frame},"Pushing frame into the output queue"),frame&&"DATA"===frame.type&&this._window!==1/0&&(this._log.trace({window:this._window,by:frame.data.length},"Decreasing flow control window size."),this._window-=frame.data.length,assert(0<=this._window)),Duplex.prototype.push.call(this,frame)},Flow.prototype._push=function(frame){var data=frame&&"DATA"===frame.type&&frame.data,maxFrameLength=this._window<16384?this._window:16384;return!data||data.length<=maxFrameLength?this._parentPush(frame):(this._window<=0||(this._log.trace({frame:frame,size:frame.data.length,forwardable:this._window},"Splitting out forwardable part of a DATA frame."),frame.data=data.slice(maxFrameLength),this._parentPush({type:"DATA",flags:{},stream:frame.stream,data:data.slice(0,maxFrameLength)})),null)},Flow.prototype.push=function(frame){null===frame?this._log.debug("Enqueueing outgoing End Of Stream"):this._log.debug({frame:frame},"Enqueueing outgoing frame");var moreNeeded=null;return 0===this._queue.length&&(moreNeeded=this._push(frame)),null===moreNeeded&&this._queue.push(frame),moreNeeded},Flow.prototype.getLastQueuedFrame=function(){return this._queue[this._queue.length-1]||("tail"in(buffer=this._readableState.buffer)?buffer.tail&&buffer.tail.data:buffer[buffer.length-1]);var buffer};var WINDOW_SIZE_LIMIT=Math.pow(2,31)-1;function bufferHead(buffer){return"head"in buffer?buffer.head&&buffer.head.data:buffer[0]}Flow.prototype._increaseWindow=function(size){this._window===1/0&&size!==1/0?(this._log.error("Trying to increase flow control window after flow control was turned off."),this.emit("error","FLOW_CONTROL_ERROR")):(this._log.trace({window:this._window,by:size},"Increasing flow control window size."),this._window+=size,this._window!==1/0&&this._window>WINDOW_SIZE_LIMIT?(this._log.error("Flow control window grew too large."),this.emit("error","FLOW_CONTROL_ERROR")):0!=size&&this.emit("window_update"))},Flow.prototype._updateWindow=function(frame){this._increaseWindow(frame.flags.END_FLOW_CONTROL?1/0:frame.window_size)},Flow.prototype.setInitialWindow=function(initialWindow){this._increaseWindow(initialWindow-this._initialWindow),this._initialWindow=initialWindow}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{assert:10,setimmediate:108,stream:109}],56:[function(require,module,exports){(function(process,Buffer){var assert=require("assert"),Transform=require("stream").Transform,keys=require("object-keys");exports.Serializer=Serializer,exports.Deserializer=Deserializer;var logData="undefined"!==process&&"undefined"!==process.env&&process.env.HTTP2_LOG_DATA;function Serializer(log){this._log=log.child({component:"serializer"}),Transform.call(this,{objectMode:!0})}function Deserializer(log,role){this._role=role,this._log=log.child({component:"deserializer"}),Transform.call(this,{objectMode:!0}),this._next(COMMON_HEADER_SIZE)}(Serializer.prototype=Object.create(Transform.prototype,{constructor:{value:Serializer}}))._transform=function(frame,encoding,done){this._log.trace({frame:frame},"Outgoing frame"),assert(frame.type in Serializer,"Unknown frame type: "+frame.type);var buffers=[];Serializer[frame.type](frame,buffers);var length=Serializer.commonHeader(frame,buffers);assert(length<=16384,"Frame too large!");for(var i=0;i<buffers.length;i++)logData&&this._log.trace({data:buffers[i]},"Outgoing data"),this.push(buffers[i]);done()},(Deserializer.prototype=Object.create(Transform.prototype,{constructor:{value:Deserializer}}))._next=function(size){this._cursor=0,this._buffer=new Buffer(size),this._waitingForHeader=!this._waitingForHeader,this._waitingForHeader&&(this._frame={})},Deserializer.prototype._transform=function(chunk,encoding,done){var cursor=0;for(logData&&this._log.trace({data:chunk},"Incoming data");cursor<chunk.length;){var toCopy=Math.min(chunk.length-cursor,this._buffer.length-this._cursor);if(chunk.copy(this._buffer,this._cursor,cursor,cursor+toCopy),this._cursor+=toCopy,cursor+=toCopy,this._cursor===this._buffer.length&&this._waitingForHeader){var payloadSize=Deserializer.commonHeader(this._buffer,this._frame);if(!(payloadSize<=16384))return void this.emit("error","FRAME_SIZE_ERROR");this._next(payloadSize)}if(this._cursor===this._buffer.length&&!this._waitingForHeader){if(this._frame.type){var error=Deserializer[this._frame.type](this._buffer,this._frame,this._role);error?(this._log.error("Incoming frame parsing error: "+error),this.emit("error",error)):(this._log.trace({frame:this._frame},"Incoming frame"),this.push(this._frame))}else this._log.error("Unknown type incoming frame");this._next(COMMON_HEADER_SIZE)}}done()};var COMMON_HEADER_SIZE=9,frameTypes=[],frameFlags={},genericAttributes=["type","flags","stream"],typeSpecificAttributes={};Serializer.commonHeader=function(frame,buffers){for(var headerBuffer=new Buffer(COMMON_HEADER_SIZE),size=0,i=0;i<buffers.length;i++)size+=buffers[i].length;headerBuffer.writeUInt8(0,0),headerBuffer.writeUInt16BE(size,1);var typeId=frameTypes.indexOf(frame.type);headerBuffer.writeUInt8(typeId,3);var flagByte=0;for(var flag in frame.flags){var position=frameFlags[frame.type].indexOf(flag);assert(-1!==position,"Unknown flag for frame type "+frame.type+": "+flag),frame.flags[flag]&&(flagByte|=1<<position)}return headerBuffer.writeUInt8(flagByte,4),assert(0<=frame.stream&&frame.stream<2147483647,frame.stream),headerBuffer.writeUInt32BE(frame.stream||0,5),buffers.unshift(headerBuffer),size},Deserializer.commonHeader=function(buffer,frame){if(buffer.length<9)return"FRAME_SIZE_ERROR";var totallyWastedByte=buffer.readUInt8(0),length=buffer.readUInt16BE(1);if(length+=totallyWastedByte<<16,frame.type=frameTypes[buffer.readUInt8(3)],!frame.type)return length;frame.flags={};for(var flagByte=buffer.readUInt8(4),definedFlags=frameFlags[frame.type],i=0;i<definedFlags.length;i++)frame.flags[definedFlags[i]]=Boolean(flagByte&1<<i);return frame.stream=2147483647&buffer.readUInt32BE(5),length},frameTypes[0]="DATA",frameFlags.DATA=["END_STREAM","RESERVED2","RESERVED4","PADDED"],typeSpecificAttributes.DATA=["data"],Serializer.DATA=function(frame,buffers){buffers.push(frame.data)},Deserializer.DATA=function(buffer,frame){var dataOffset=0,paddingLength=0;if(frame.flags.PADDED){if(buffer.length<1)return"FRAME_SIZE_ERROR";paddingLength=255&buffer.readUInt8(dataOffset),dataOffset=1}if(paddingLength){if(paddingLength>=buffer.length-1)return"FRAME_SIZE_ERROR";frame.data=buffer.slice(dataOffset,-1*paddingLength)}else frame.data=buffer.slice(dataOffset)},frameTypes[1]="HEADERS",frameFlags.HEADERS=["END_STREAM","RESERVED2","END_HEADERS","PADDED","RESERVED5","PRIORITY"],typeSpecificAttributes.HEADERS=["priorityDependency","priorityWeight","exclusiveDependency","headers","data"],Serializer.HEADERS=function(frame,buffers){if(frame.flags.PRIORITY){var buffer=new Buffer(5);assert(0<=frame.priorityDependency&&frame.priorityDependency<=2147483647,frame.priorityDependency),buffer.writeUInt32BE(frame.priorityDependency,0),frame.exclusiveDependency&&(buffer[0]|=128),assert(0<=frame.priorityWeight&&frame.priorityWeight<=255,frame.priorityWeight),buffer.writeUInt8(frame.priorityWeight,4),buffers.push(buffer)}buffers.push(frame.data)},Deserializer.HEADERS=function(buffer,frame){var minFrameLength=0;if(frame.flags.PADDED&&(minFrameLength+=1),frame.flags.PRIORITY&&(minFrameLength+=5),buffer.length<minFrameLength)return"FRAME_SIZE_ERROR";var dataOffset=0,paddingLength=0;if(frame.flags.PADDED&&(paddingLength=255&buffer.readUInt8(dataOffset),dataOffset=1),frame.flags.PRIORITY){var dependencyData=new Buffer(4);buffer.copy(dependencyData,0,dataOffset,dataOffset+4),dataOffset+=4,frame.exclusiveDependency=!!(128&dependencyData[0]),dependencyData[0]&=127,frame.priorityDependency=dependencyData.readUInt32BE(0),frame.priorityWeight=buffer.readUInt8(dataOffset),dataOffset+=1}if(paddingLength){if(buffer.length-dataOffset<paddingLength)return"FRAME_SIZE_ERROR";frame.data=buffer.slice(dataOffset,-1*paddingLength)}else frame.data=buffer.slice(dataOffset)},frameTypes[2]="PRIORITY",frameFlags.PRIORITY=[],typeSpecificAttributes.PRIORITY=["priorityDependency","priorityWeight","exclusiveDependency"],Serializer.PRIORITY=function(frame,buffers){var buffer=new Buffer(5);assert(0<=frame.priorityDependency&&frame.priorityDependency<=2147483647,frame.priorityDependency),buffer.writeUInt32BE(frame.priorityDependency,0),frame.exclusiveDependency&&(buffer[0]|=128),assert(0<=frame.priorityWeight&&frame.priorityWeight<=255,frame.priorityWeight),buffer.writeUInt8(frame.priorityWeight,4),buffers.push(buffer)},Deserializer.PRIORITY=function(buffer,frame){if(buffer.length<5)return"FRAME_SIZE_ERROR";var dependencyData=new Buffer(4);buffer.copy(dependencyData,0,0,4),frame.exclusiveDependency=!!(128&dependencyData[0]),dependencyData[0]&=127,frame.priorityDependency=dependencyData.readUInt32BE(0),frame.priorityWeight=buffer.readUInt8(4)},frameTypes[3]="RST_STREAM",frameFlags.RST_STREAM=[],typeSpecificAttributes.RST_STREAM=["error"],Serializer.RST_STREAM=function(frame,buffers){var buffer=new Buffer(4),code=errorCodes.indexOf(frame.error);assert(0<=code&&code<=4294967295,code),buffer.writeUInt32BE(code,0),buffers.push(buffer)},Deserializer.RST_STREAM=function(buffer,frame){if(buffer.length<4)return"FRAME_SIZE_ERROR";frame.error=errorCodes[buffer.readUInt32BE(0)],frame.error||(frame.error="INTERNAL_ERROR")},frameTypes[4]="SETTINGS",frameFlags.SETTINGS=["ACK"],typeSpecificAttributes.SETTINGS=["settings"],Serializer.SETTINGS=function(frame,buffers){var settings=[],settingsLeft=keys(frame.settings);definedSettings.forEach(function(setting,id){if(setting.name in frame.settings){settingsLeft.splice(settingsLeft.indexOf(setting.name),1);var value=frame.settings[setting.name];settings.push({id:id,value:setting.flag?Boolean(value):value})}}),assert(0===settingsLeft.length,"Unknown settings: "+settingsLeft.join(", "));for(var buffer=new Buffer(6*settings.length),i=0;i<settings.length;i++)buffer.writeUInt16BE(65535&settings[i].id,6*i),buffer.writeUInt32BE(settings[i].value,6*i+2);buffers.push(buffer)},Deserializer.SETTINGS=function(buffer,frame,role){if(frame.settings={},frame.flags.ACK&&0!=buffer.length)return"FRAME_SIZE_ERROR";if(buffer.length%6!=0)return"PROTOCOL_ERROR";for(var i=0;i<buffer.length/6;i++){var id=65535&buffer.readUInt16BE(6*i),setting=definedSettings[id];if(setting){if("CLIENT"==role&&"SETTINGS_ENABLE_PUSH"==setting.name)return"SETTINGS frame on client got SETTINGS_ENABLE_PUSH";var value=buffer.readUInt32BE(6*i+2);frame.settings[setting.name]=setting.flag?Boolean(1&value):value}}};var definedSettings=[];function stripquotes(s){for(var start=0,end=s.length;start<end&&'"'===s[start];)start++;for(;start<end&&'"'===s[end-1];)end--;return end<=start?"":s.substring(start,end)}function splitNameValue(nvpair){for(var eq=-1,inQuotes=!1,i=0;i<nvpair.length;i++)if('"'!==nvpair[i]){if(!inQuotes&&"="===nvpair[i]){eq=i;break}}else inQuotes=!inQuotes;return-1===eq?{name:nvpair,value:null}:{name:stripquotes(nvpair.substring(0,eq).trim()),value:stripquotes(nvpair.substring(eq+1).trim())}}function splitHeaderParameters(hv){return parseHeaderValue(hv,";",splitNameValue)}function parseHeaderValue(hv,separator,callback){for(var start=0,inQuotes=!1,values=[],i=0;i<hv.length;i++){if('"'!==hv[i]){if(!inQuotes)if(hv[i]===separator)0<(newValue=hv.substring(start,i).trim()).length&&(newValue=callback(newValue),values.push(newValue)),start=i+1}else inQuotes=!inQuotes}var newValue;return 0<(newValue=hv.substring(start).trim()).length&&(newValue=callback(newValue),values.push(newValue)),values}function rsplit(s,delim,count){for(var nsplits=0,end=s.length,rval=[],i=s.length-1;0<=i;i--)if(s[i]===delim){var t=s.substring(i+1,end);if(end=i,rval.unshift(t),++nsplits===count)break}return 0!==end&&rval.unshift(s.substring(0,end)),rval}function ishex(c){return-1<"0123456789ABCDEFabcdef".indexOf(c)}function unescape(s){for(var i=0,t="";i<s.length;){if("%"==s[i]&&ishex(s[i+1])&&ishex(s[i+2])){var hexvalue="";++i<s.length&&(hexvalue+=s[i],++i),i<s.length&&(hexvalue+=s[i]),0<hexvalue.length?t+=new Buffer(hexvalue,"hex").toString():t+="%"}else t+=s[i];++i}return t}definedSettings[1]={name:"SETTINGS_HEADER_TABLE_SIZE",flag:!1},definedSettings[2]={name:"SETTINGS_ENABLE_PUSH",flag:!0},definedSettings[3]={name:"SETTINGS_MAX_CONCURRENT_STREAMS",flag:!1},definedSettings[4]={name:"SETTINGS_INITIAL_WINDOW_SIZE",flag:!1},definedSettings[5]={name:"SETTINGS_MAX_FRAME_SIZE",flag:!1},frameTypes[5]="PUSH_PROMISE",frameFlags.PUSH_PROMISE=["RESERVED1","RESERVED2","END_PUSH_PROMISE","PADDED"],typeSpecificAttributes.PUSH_PROMISE=["promised_stream","headers","data"],Serializer.PUSH_PROMISE=function(frame,buffers){var buffer=new Buffer(4),promised_stream=frame.promised_stream;assert(0<=promised_stream&&promised_stream<=2147483647,promised_stream),buffer.writeUInt32BE(promised_stream,0),buffers.push(buffer),buffers.push(frame.data)},Deserializer.PUSH_PROMISE=function(buffer,frame){if(buffer.length<4)return"FRAME_SIZE_ERROR";var dataOffset=0,paddingLength=0;if(frame.flags.PADDED){if(buffer.length<5)return"FRAME_SIZE_ERROR";paddingLength=255&buffer.readUInt8(dataOffset),dataOffset=1}if(frame.promised_stream=2147483647&buffer.readUInt32BE(dataOffset),dataOffset+=4,paddingLength){if(buffer.length-dataOffset<paddingLength)return"FRAME_SIZE_ERROR";frame.data=buffer.slice(dataOffset,-1*paddingLength)}else frame.data=buffer.slice(dataOffset)},frameTypes[6]="PING",frameFlags.PING=["ACK"],typeSpecificAttributes.PING=["data"],Serializer.PING=function(frame,buffers){buffers.push(frame.data)},Deserializer.PING=function(buffer,frame){if(8!==buffer.length)return"FRAME_SIZE_ERROR";frame.data=buffer},frameTypes[7]="GOAWAY",frameFlags.GOAWAY=[],typeSpecificAttributes.GOAWAY=["last_stream","error"],Serializer.GOAWAY=function(frame,buffers){var buffer=new Buffer(8),last_stream=frame.last_stream;assert(0<=last_stream&&last_stream<=2147483647,last_stream),buffer.writeUInt32BE(last_stream,0);var code=errorCodes.indexOf(frame.error);assert(0<=code&&code<=4294967295,code),buffer.writeUInt32BE(code,4),buffers.push(buffer)},Deserializer.GOAWAY=function(buffer,frame){if(buffer.length<8)return"FRAME_SIZE_ERROR";frame.last_stream=2147483647&buffer.readUInt32BE(0),frame.error=errorCodes[buffer.readUInt32BE(4)],frame.error||(frame.error="INTERNAL_ERROR"),8<buffer.length&&(frame.debug_data=buffer.slice(8))},frameTypes[8]="WINDOW_UPDATE",frameFlags.WINDOW_UPDATE=[],typeSpecificAttributes.WINDOW_UPDATE=["window_size"],Serializer.WINDOW_UPDATE=function(frame,buffers){var buffer=new Buffer(4),window_size=frame.window_size;assert(0<window_size&&window_size<=2147483647,window_size),buffer.writeUInt32BE(window_size,0),buffers.push(buffer)},Deserializer.WINDOW_UPDATE=function(buffer,frame){return 4!==buffer.length?"FRAME_SIZE_ERROR":(frame.window_size=2147483647&buffer.readUInt32BE(0),0===frame.window_size?"PROTOCOL_ERROR":void 0)},frameTypes[9]="CONTINUATION",frameFlags.CONTINUATION=["RESERVED1","RESERVED2","END_HEADERS"],typeSpecificAttributes.CONTINUATION=["headers","data"],Serializer.CONTINUATION=function(frame,buffers){buffers.push(frame.data)},Deserializer.CONTINUATION=function(buffer,frame){frame.data=buffer},frameTypes[10]="ALTSVC",frameFlags.ALTSVC=[],typeSpecificAttributes.ALTSVC=["maxAge","port","protocolID","host","origin"],Serializer.ALTSVC=function(frame,buffers){var buffer=new Buffer(2);buffer.writeUInt16BE(frame.origin.length,0),buffers.push(buffer),buffers.push(new Buffer(frame.origin,"ascii"));var fieldValue=function(s){for(var c,t="",i=0;i<s.length;i++)c=s[i],-1<"!#$&'*+-.^_`|~1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".indexOf(c)?t+=s[i]:(t+="%",t+=new Buffer(s[i]).toString("hex"));return t}(frame.protocolID)+'="'+frame.host+":"+frame.port+'"';86400!==frame.maxAge&&(fieldValue+="; ma="+frame.maxAge),buffers.push(new Buffer(fieldValue,"ascii"))},Deserializer.ALTSVC=function(buffer,frame){if(buffer.length<2)return"FRAME_SIZE_ERROR";var originLength=buffer.readUInt16BE(0);if(buffer.length-2<originLength)return"FRAME_SIZE_ERROR";frame.origin=buffer.toString("ascii",2,2+originLength);var values=parseHeaderValue(buffer.toString("ascii",2+originLength),",",splitHeaderParameters);if(values.length,0!==values.length){var chosenAltSvc=values[0];frame.maxAge=86400;for(var i=0;i<chosenAltSvc.length;i++)if(0===i){frame.protocolID=unescape(chosenAltSvc[i].name);var hostport=rsplit(chosenAltSvc[i].value,":",1);frame.host=hostport[0],frame.port=parseInt(hostport[1],10)}else"ma"==chosenAltSvc[i].name&&(frame.maxAge=parseInt(chosenAltSvc[i].value,10))}},frameTypes[11]="BLOCKED",frameFlags.BLOCKED=[],typeSpecificAttributes.BLOCKED=[],Serializer.BLOCKED=function(frame,buffers){},Deserializer.BLOCKED=function(buffer,frame){};var errorCodes=["NO_ERROR","PROTOCOL_ERROR","INTERNAL_ERROR","FLOW_CONTROL_ERROR","SETTINGS_TIMEOUT","STREAM_CLOSED","FRAME_SIZE_ERROR","REFUSED_STREAM","CANCEL","COMPRESSION_ERROR","CONNECT_ERROR","ENHANCE_YOUR_CALM","INADEQUATE_SECURITY","HTTP_1_1_REQUIRED"];exports.serializers={};var frameCounter=0;exports.serializers.frame=function(frame){if(!frame)return null;if("id"in frame)return frame.id;frame.id=frameCounter,frameCounter+=1;var logEntry={id:frame.id};return genericAttributes.concat(typeSpecificAttributes[frame.type]).forEach(function(name){logEntry[name]=frame[name]}),frame.data instanceof Buffer&&(50<logEntry.data.length?logEntry.data=frame.data.slice(0,47).toString("hex")+"...":logEntry.data=frame.data.toString("hex"),"length"in logEntry||(logEntry.length=frame.data.length)),frame.promised_stream instanceof Object&&(logEntry.promised_stream="stream-"+frame.promised_stream.id),logEntry.flags=keys(frame.flags||{}).filter(function(name){return!0===frame.flags[name]}),logEntry},exports.serializers.data=function(data){return data.toString("hex")}}).call(this,require("_process"),require("buffer").Buffer)},{_process:89,assert:10,buffer:17,"object-keys":65,stream:109}],57:[function(require,module,exports){exports.VERSION="h2",exports.Endpoint=require("./endpoint").Endpoint,exports.serializers={};try{["./framer","./compressor","./flow","./connection","./stream","./endpoint"].map(require).forEach(function(module){for(var name in module.serializers)exports.serializers[name]=module.serializers[name]})}catch(e){}},{"./endpoint":54}],58:[function(require,module,exports){var assert=require("assert"),pako=require("pako"),Buffer=require("buffer").Buffer,Duplex=require("stream").Duplex;function Stream(log,connection){Duplex.call(this),this._log=log.child({component:"stream",s:this}),this._initializeManagement(),this._initializeDataFlow(),this._initializeState(),this.connection=connection}(exports.Stream=Stream).prototype=Object.create(Duplex.prototype,{constructor:{value:Stream}});var DEFAULT_PRIORITY=Math.pow(2,30),MAX_PRIORITY=Math.pow(2,31)-1;Stream.prototype._initializeManagement=function(){this._resetSent=!1,this._priority=DEFAULT_PRIORITY,this._letPeerPrioritize=!0},Stream.prototype.promise=function(headers){var stream=new Stream(this._log,this.connection);return stream._priority=Math.min(this._priority+1,MAX_PRIORITY),this._pushUpstream({type:"PUSH_PROMISE",flags:{},stream:this.id,promised_stream:stream,headers:headers}),stream},Stream.prototype._onPromise=function(frame){this.emit("promise",frame.promised_stream,frame.headers)},Stream.prototype.headers=function(headers){this._pushUpstream({type:"HEADERS",flags:{},stream:this.id,headers:headers})},Stream.prototype._onHeaders=function(frame){void 0!==frame.priority&&this.priority(frame.priority,!0),"HALF_CLOSED_LOCAL"!==this.state&&"OPEN"!==this.state||(this.contentEncoding=frame.headers["content-encoding"]),this.emit("headers",frame.headers)},Stream.prototype.priority=function(priority,peer){if(peer&&this._letPeerPrioritize||!peer){if(!peer){this._letPeerPrioritize=!1;var lastFrame=this.upstream.getLastQueuedFrame();!lastFrame||"HEADERS"!==lastFrame.type&&"PRIORITY"!==lastFrame.type?this._pushUpstream({type:"PRIORITY",flags:{},stream:this.id,priority:priority}):lastFrame.priority=priority}this._log.debug({priority:priority},"Changing priority"),this.emit("priority",priority),this._priority=priority}},Stream.prototype._onPriority=function(frame){this.priority(frame.priority,!0)},Stream.prototype.reset=function(error){this._resetSent||(this._resetSent=!0,this._pushUpstream({type:"RST_STREAM",flags:{},stream:this.id,error:error}))},Stream.prototype.altsvc=function(host,port,protocolID,maxAge,origin){var stream;stream=origin?0:this.id,this._pushUpstream({type:"ALTSVC",flags:{},stream:stream,host:host,port:port,protocolID:protocolID,origin:origin,maxAge:maxAge})};var Flow=require("./flow").Flow;Stream.prototype._initializeDataFlow=function(){this.id=void 0,this._ended=!1,this.upstream=new Flow,this.upstream._log=this._log,this.upstream._send=this._send.bind(this),this.upstream._receive=this._receive.bind(this),this.upstream.write=this._writeUpstream.bind(this),this.upstream.on("error",this.emit.bind(this,"error")),this.on("finish",this._finishing)},Stream.prototype._pushUpstream=function(frame){this.upstream.push(frame),this._transition(!0,frame)},Stream.prototype._writeUpstream=function(frame){this._log.debug({frame:frame},"Receiving frame");var moreNeeded=Flow.prototype.write.call(this.upstream,frame);return this._transition(!1,frame),"HEADERS"===frame.type?(this._processedHeaders&&!frame.flags.END_STREAM&&this.emit("error","PROTOCOL_ERROR"),this._processedHeaders=!0,this._onHeaders(frame)):"PUSH_PROMISE"===frame.type?this._onPromise(frame):"PRIORITY"===frame.type?this._onPriority(frame):"ALTSVC"===frame.type||"BLOCKED"===frame.type||"DATA"!==frame.type&&"WINDOW_UPDATE"!==frame.type&&"RST_STREAM"!==frame.type&&(this._log.error({frame:frame},"Invalid stream level frame"),this.emit("error","PROTOCOL_ERROR")),moreNeeded},Stream.prototype._receive=function(frame,ready){if(!this._ended&&"DATA"===frame.type)if("gzip"===this.contentEncoding&&0<frame.data.length){if(!this.pakoInf){var self=this;this.pakoInf=new pako.Inflate,this.pakoInf.onData=function(data){self.push(Buffer.from(data))||(this._receiveMore=ready)}}var data=frame.data;this.pakoInf.push(data,frame.END_STREAM)}else{this.push(frame.data)||(this._receiveMore=ready)}this._ended||!frame.flags.END_STREAM&&"RST_STREAM"!==frame.type||(this.push(null),this._ended=!0),this._receiveMore!==ready&&ready()},Stream.prototype._read=function(){if(this._receiveMore){var receiveMore=this._receiveMore;delete this._receiveMore,receiveMore()}},Stream.prototype._write=function(buffer,encoding,ready){this._pushUpstream({type:"DATA",flags:{},stream:this.id,data:buffer})?ready():this._sendMore=ready},Stream.prototype._send=function(){if(this._sendMore){var sendMore=this._sendMore;delete this._sendMore,sendMore()}};var emptyBuffer=new Buffer(0);function activeState(state){return"HALF_CLOSED_LOCAL"===state||"HALF_CLOSED_REMOTE"===state||"OPEN"===state}Stream.prototype._finishing=function(){var endFrame={type:"DATA",flags:{END_STREAM:!0},stream:this.id,data:emptyBuffer},lastFrame=this.upstream.getLastQueuedFrame();!lastFrame||"DATA"!==lastFrame.type&&"HEADERS"!==lastFrame.type?this._pushUpstream(endFrame):(this._log.debug({frame:lastFrame},"Marking last frame with END_STREAM flag."),lastFrame.flags.END_STREAM=!0,this._transition(!0,endFrame))},Stream.prototype._initializeState=function(){this.state="IDLE",this._initiated=void 0,this._closedByUs=void 0,this._closedWithRst=void 0,this._processedHeaders=!1},Stream.prototype._setState=function(state){assert(this.state!==state),this._log.debug({from:this.state,to:state},"State transition"),this.state=state,this.emit("state",state)},Stream.prototype._transition=function(sending,frame){var connectionError,streamError,receiving=!sending,HEADERS=!1,PRIORITY=!1,ALTSVC=!1,BLOCKED=!1,RST_STREAM=!1,PUSH_PROMISE=!1,WINDOW_UPDATE=!1;switch(frame.type){case"DATA":!0;break;case"HEADERS":HEADERS=!0;break;case"PRIORITY":PRIORITY=!0;break;case"RST_STREAM":RST_STREAM=!0;break;case"PUSH_PROMISE":PUSH_PROMISE=!0;break;case"WINDOW_UPDATE":WINDOW_UPDATE=!0;break;case"ALTSVC":ALTSVC=!0;break;case"BLOCKED":BLOCKED=!0}var previousState=this.state;switch(this.state){case"IDLE":HEADERS?(this._setState("OPEN"),frame.flags.END_STREAM&&this._setState(sending?"HALF_CLOSED_LOCAL":"HALF_CLOSED_REMOTE"),this._initiated=sending):sending&&RST_STREAM?this._setState("CLOSED"):PRIORITY||(connectionError="PROTOCOL_ERROR");break;case"RESERVED_LOCAL":sending&&HEADERS?this._setState("HALF_CLOSED_REMOTE"):RST_STREAM?this._setState("CLOSED"):PRIORITY||(connectionError="PROTOCOL_ERROR");break;case"RESERVED_REMOTE":RST_STREAM?this._setState("CLOSED"):receiving&&HEADERS?this._setState("HALF_CLOSED_LOCAL"):BLOCKED||PRIORITY||(connectionError="PROTOCOL_ERROR");break;case"OPEN":frame.flags.END_STREAM?this._setState(sending?"HALF_CLOSED_LOCAL":"HALF_CLOSED_REMOTE"):RST_STREAM&&this._setState("CLOSED");break;case"HALF_CLOSED_LOCAL":RST_STREAM||receiving&&frame.flags.END_STREAM?this._setState("CLOSED"):BLOCKED||ALTSVC||receiving||PRIORITY||sending&&WINDOW_UPDATE||(connectionError="PROTOCOL_ERROR");break;case"HALF_CLOSED_REMOTE":RST_STREAM||sending&&frame.flags.END_STREAM?this._setState("CLOSED"):BLOCKED||ALTSVC||sending||PRIORITY||receiving&&WINDOW_UPDATE||(connectionError="PROTOCOL_ERROR");break;case"CLOSED":PRIORITY||sending&&RST_STREAM||sending&&this._closedWithRst||receiving&&WINDOW_UPDATE||receiving&&this._closedByUs&&(this._closedWithRst||RST_STREAM||ALTSVC)||(streamError="STREAM_CLOSED")}if("CLOSED"===this.state&&"CLOSED"!==previousState&&(this._closedByUs=sending,this._closedWithRst=RST_STREAM),!PUSH_PROMISE||connectionError||streamError||(assert("IDLE"===frame.promised_stream.state,frame.promised_stream.state),frame.promised_stream._setState(sending?"RESERVED_LOCAL":"RESERVED_REMOTE"),frame.promised_stream._initiated=sending),this._initiated){var change=activeState(this.state)-activeState(previousState);sending?frame.count_change=change:frame.count_change(change)}else sending&&(frame.count_change=0);if(connectionError||streamError){var info={error:connectionError,frame:frame,state:this.state,closedByUs:this._closedByUs,closedWithRst:this._closedWithRst};if(sending)return this._log.error(info,"Sending illegal frame."),this.emit("error",new Error("Sending illegal frame ("+frame.type+") in "+this.state+" state."));this._log.error(info,"Received illegal frame."),connectionError?this.emit("connectionError",connectionError):(this.reset(streamError),this.emit("error",streamError))}},exports.serializers={};var nextId=0;exports.serializers.s=function(stream){return"_id"in stream||(stream._id=nextId,nextId+=1),stream._id}},{"./flow":55,assert:10,buffer:17,pako:72,stream:109}],59:[function(require,module,exports){var http=require("http"),url=require("url"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);function validateParams(params){if("string"==typeof params&&(params=url.parse(params)),params.protocol||(params.protocol="https:"),"https:"!==params.protocol)throw new Error('Protocol "'+params.protocol+'" not supported. Expected "https:"');return params}https.request=function(params,cb){return params=validateParams(params),http.request.call(this,params,cb)},https.get=function(params,cb){return params=validateParams(params),http.get.call(this,params,cb)}},{http:110,url:120}],60:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;0<nBits;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;0<nBits;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),2<=(value+=1<=e+eBias?rt/c:rt*Math.pow(2,1-eBias))*c&&(e++,c/=2),eMax<=e+eBias?(m=0,e=eMax):1<=e+eBias?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));8<=mLen;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;0<eLen;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],61:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments)},{dup:11}],62:[function(require,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||function(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}(obj)||!!obj._isBuffer)}},{}],63:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],64:[function(require,module,exports){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=function(val){if(null==val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}(target),s=1;s<arguments.length;s++){for(var key in from=Object(arguments[s]))hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},{}],65:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=require("./isArguments"),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},"toString"),hasProtoEnumBug=isEnumerable.call(function(){},"prototype"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{if(!excludedKeys["$"+k]&&has.call(window,k)&&null!==window[k]&&"object"==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),keysShim=function(object){var isObject=null!==object&&"object"==typeof object,isFunction="[object Function]"===toStr.call(object),isArguments=isArgs(object),isString=isObject&&"[object String]"===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError("Object.keys called on a non-object");var skipProto=hasProtoEnumBug&&isFunction;if(isString&&0<object.length&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(String(i));if(isArguments&&0<object.length)for(var j=0;j<object.length;++j)theKeys.push(String(j));else for(var name in object)skipProto&&"prototype"===name||!has.call(object,name)||theKeys.push(String(name));if(hasDontEnumBug)for(var skipConstructor=function(o){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}}(object),k=0;k<dontEnums.length;++k)skipConstructor&&"constructor"===dontEnums[k]||!has.call(object,dontEnums[k])||theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var originalKeys=Object.keys;Object.keys=function(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},{"./isArguments":66}],66:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function(value){var str=toStr.call(value),isArgs="[object Arguments]"===str;return isArgs||(isArgs="[object Array]"!==str&&null!==value&&"object"==typeof value&&"number"==typeof value.length&&0<=value.length&&"[object Function]"===toStr.call(value.callee)),isArgs}},{}],67:[function(require,module,exports){"use strict";var keys=require("object-keys"),bind=require("function-bind"),hasSymbols=require("has-symbols/shams")(),toObject=Object,push=bind.call(Function.call,Array.prototype.push),propIsEnumerable=bind.call(Function.call,Object.prototype.propertyIsEnumerable),originalGetSymbols=hasSymbols?Object.getOwnPropertySymbols:null;module.exports=function(target,source1){if(null==target)throw new TypeError("target must be an object");var s,source,i,props,syms,value,key,objTarget=toObject(target);for(s=1;s<arguments.length;++s){source=toObject(arguments[s]),props=keys(source);var getSymbols=hasSymbols&&(Object.getOwnPropertySymbols||originalGetSymbols);if(getSymbols)for(syms=getSymbols(source),i=0;i<syms.length;++i)key=syms[i],propIsEnumerable(source,key)&&push(props,key);for(i=0;i<props.length;++i)value=source[key=props[i]],propIsEnumerable(source,key)&&(objTarget[key]=value)}return objTarget}},{"function-bind":48,"has-symbols/shams":49,"object-keys":65}],68:[function(require,module,exports){"use strict";var defineProperties=require("define-properties"),implementation=require("./implementation"),getPolyfill=require("./polyfill"),shim=require("./shim"),polyfill=getPolyfill();defineProperties(polyfill,{getPolyfill:getPolyfill,implementation:implementation,shim:shim}),module.exports=polyfill},{"./implementation":67,"./polyfill":69,"./shim":70,"define-properties":42}],69:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var str="abcdefghijklmnopqrst",letters=str.split(""),map={},i=0;i<letters.length;++i)map[letters[i]]=letters[i];var obj=Object.assign({},map),actual="";for(var k in obj)actual+=k;return str!==actual}()?implementation:function(){if(!Object.assign||!Object.preventExtensions)return!1;var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy")}catch(e){return"y"===thrower[1]}return!1}()?implementation:Object.assign:implementation}},{"./implementation":67}],70:[function(require,module,exports){"use strict";var define=require("define-properties"),getPolyfill=require("./polyfill");module.exports=function(){var polyfill=getPolyfill();return define(Object,{assign:polyfill},{assign:function(){return Object.assign!==polyfill}}),polyfill}},{"./polyfill":69,"define-properties":42}],71:[function(require,module,exports){var wrappy=require("wrappy");function once(fn){var f=function(){return f.called?f.value:(f.called=!0,f.value=fn.apply(this,arguments))};return f.called=!1,f}function onceStrict(fn){var f=function(){if(f.called)throw new Error(f.onceError);return f.called=!0,f.value=fn.apply(this,arguments)},name=fn.name||"Function wrapped with `once`";return f.onceError=name+" shouldn't be called more than once",f.called=!1,f}module.exports=wrappy(once),module.exports.strict=wrappy(onceStrict),once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})})},{wrappy:128}],72:[function(require,module,exports){"use strict";var pako={};(0,require("./lib/utils/common").assign)(pako,require("./lib/deflate"),require("./lib/inflate"),require("./lib/zlib/constants")),module.exports=pako},{"./lib/deflate":73,"./lib/inflate":74,"./lib/utils/common":75,"./lib/zlib/constants":78}],73:[function(require,module,exports){"use strict";var zlib_deflate=require("./zlib/deflate"),utils=require("./utils/common"),strings=require("./utils/strings"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),toString=Object.prototype.toString,Z_OK=0,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED=8;function Deflate(options){if(!(this instanceof Deflate))return new Deflate(options);this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},options||{});var opt=this.options;opt.raw&&0<opt.windowBits?opt.windowBits=-opt.windowBits:opt.gzip&&0<opt.windowBits&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK)throw new Error(msg[status]);if(opt.header&&zlib_deflate.deflateSetHeader(this.strm,opt.header),opt.dictionary){var dict;if(dict="string"==typeof opt.dictionary?strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString.call(opt.dictionary)?new Uint8Array(opt.dictionary):opt.dictionary,(status=zlib_deflate.deflateSetDictionary(this.strm,dict))!==Z_OK)throw new Error(msg[status]);this._dict_set=!0}}function deflate(input,options){var deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||msg[deflator.err];return deflator.result}Deflate.prototype.push=function(data,mode){var status,_mode,strm=this.strm,chunkSize=this.options.chunkSize;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?4:0,"string"==typeof data?strm.input=strings.string2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),1!==(status=zlib_deflate.deflate(strm,_mode))&&status!==Z_OK)return this.onEnd(status),!(this.ended=!0);0!==strm.avail_out&&(0!==strm.avail_in||4!==_mode&&2!==_mode)||("string"===this.options.to?this.onData(strings.buf2binstring(utils.shrinkBuf(strm.output,strm.next_out))):this.onData(utils.shrinkBuf(strm.output,strm.next_out)))}while((0<strm.avail_in||0===strm.avail_out)&&1!==status);return 4===_mode?(status=zlib_deflate.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK):2!==_mode||(this.onEnd(Z_OK),!(strm.avail_out=0))},Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate.prototype.onEnd=function(status){status===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},exports.Deflate=Deflate,exports.deflate=deflate,exports.deflateRaw=function(input,options){return(options=options||{}).raw=!0,deflate(input,options)},exports.gzip=function(input,options){return(options=options||{}).gzip=!0,deflate(input,options)}},{"./utils/common":75,"./utils/strings":76,"./zlib/deflate":80,"./zlib/messages":85,"./zlib/zstream":87}],74:[function(require,module,exports){"use strict";var zlib_inflate=require("./zlib/inflate"),utils=require("./utils/common"),strings=require("./utils/strings"),c=require("./zlib/constants"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),GZheader=require("./zlib/gzheader"),toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;opt.raw&&0<=opt.windowBits&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(0<=opt.windowBits&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),15<opt.windowBits&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK)throw new Error(msg[status]);this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header)}function inflate(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg||msg[inflator.err];return inflator.result}Inflate.prototype.push=function(data,mode){var status,_mode,next_out_utf8,tail,utf8str,dict,strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary,allowBufError=!1;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?c.Z_FINISH:c.Z_NO_FLUSH,"string"==typeof data?strm.input=strings.binstring2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&dictionary&&(dict="string"==typeof dictionary?strings.string2buf(dictionary):"[object ArrayBuffer]"===toString.call(dictionary)?new Uint8Array(dictionary):dictionary,status=zlib_inflate.inflateSetDictionary(this.strm,dict)),status===c.Z_BUF_ERROR&&!0===allowBufError&&(status=c.Z_OK,allowBufError=!1),status!==c.Z_STREAM_END&&status!==c.Z_OK)return this.onEnd(status),!(this.ended=!0);strm.next_out&&(0!==strm.avail_out&&status!==c.Z_STREAM_END&&(0!==strm.avail_in||_mode!==c.Z_FINISH&&_mode!==c.Z_SYNC_FLUSH)||("string"===this.options.to?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0),this.onData(utf8str)):this.onData(utils.shrinkBuf(strm.output,strm.next_out)))),0===strm.avail_in&&0===strm.avail_out&&(allowBufError=!0)}while((0<strm.avail_in||0===strm.avail_out)&&status!==c.Z_STREAM_END);return status===c.Z_STREAM_END&&(_mode=c.Z_FINISH),_mode===c.Z_FINISH?(status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===c.Z_OK):_mode!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(strm.avail_out=0))},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},exports.Inflate=Inflate,exports.inflate=inflate,exports.inflateRaw=function(input,options){return(options=options||{}).raw=!0,inflate(input,options)},exports.ungzip=inflate},{"./utils/common":75,"./utils/strings":76,"./zlib/constants":78,"./zlib/gzheader":81,"./zlib/inflate":83,"./zlib/messages":85,"./zlib/zstream":87}],75:[function(require,module,exports){"use strict";var TYPED_OK="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function _has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.assign=function(obj){for(var sources=Array.prototype.slice.call(arguments,1);sources.length;){var source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(var p in source)_has(source,p)&&(obj[p]=source[p])}}return obj},exports.shrinkBuf=function(buf,size){return buf.length===size?buf:buf.subarray?buf.subarray(0,size):(buf.length=size,buf)};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray)dest.set(src.subarray(src_offs,src_offs+len),dest_offs);else for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;for(i=len=0,l=chunks.length;i<l;i++)len+=chunks[i].length;for(result=new Uint8Array(len),i=pos=0,l=chunks.length;i<l;i++)chunk=chunks[i],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){on?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped))},exports.setTyped(TYPED_OK)},{}],76:[function(require,module,exports){"use strict";var utils=require("./common"),STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils.Buf8(256),q=0;q<256;q++)_utf8len[q]=252<=q?6:248<=q?5:240<=q?4:224<=q?3:192<=q?2:1;function buf2binstring(buf,len){if(len<65537&&(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len));for(var result="",i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result}_utf8len[254]=_utf8len[254]=1,exports.string2buf=function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new utils.Buf8(buf_len),m_pos=i=0;i<buf_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),c<128?buf[i++]=c:(c<2048?buf[i++]=192|c>>>6:(c<65536?buf[i++]=224|c>>>12:(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63),buf[i++]=128|c>>>6&63),buf[i++]=128|63&c);return buf},exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)},exports.binstring2buf=function(str){for(var buf=new utils.Buf8(str.length),i=0,len=buf.length;i<len;i++)buf[i]=str.charCodeAt(i);return buf},exports.buf2string=function(buf,max){var i,out,c,c_len,len=max||buf.length,utf16buf=new Array(2*len);for(i=out=0;i<len;)if((c=buf[i++])<128)utf16buf[out++]=c;else if(4<(c_len=_utf8len[c]))utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;1<c_len&&i<len;)c=c<<6|63&buf[i++],c_len--;1<c_len?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}return buf2binstring(utf16buf,out)},exports.utf8border=function(buf,max){var pos;for((max=max||buf.length)>buf.length&&(max=buf.length),pos=max-1;0<=pos&&128==(192&buf[pos]);)pos--;return pos<0?max:0===pos?max:pos+_utf8len[buf[pos]]>max?pos:max}},{"./common":75}],77:[function(require,module,exports){"use strict";module.exports=function(adler,buf,len,pos){for(var s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;0!==len;){for(len-=n=2e3<len?2e3:len;s2=s2+(s1=s1+buf[pos++]|0)|0,--n;);s1%=65521,s2%=65521}return s1|s2<<16|0}},{}],78:[function(require,module,exports){"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],79:[function(require,module,exports){"use strict";var crcTable=function(){for(var c,table=[],n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table}();module.exports=function(crc,buf,len,pos){var t=crcTable,end=pos+len;crc^=-1;for(var i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc}},{}],80:[function(require,module,exports){"use strict";var configuration_table,utils=require("../utils/common"),trees=require("./trees"),adler32=require("./adler32"),crc32=require("./crc32"),msg=require("./messages"),Z_NO_FLUSH=0,Z_FINISH=4,Z_OK=0,Z_STREAM_ERROR=-2,Z_DEFAULT_COMPRESSION=-1,Z_FIXED=4,Z_UNKNOWN=2,Z_DEFLATED=8,MAX_MEM_LEVEL=9,L_CODES=286,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,INIT_STATE=42,BUSY_STATE=113,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4;function err(strm,errorCode){return strm.msg=msg[errorCode],errorCode}function rank(f){return(f<<1)-(4<f?9:0)}function zero(buf){for(var len=buf.length;0<=--len;)buf[len]=0}function flush_pending(strm){var s=strm.state,len=s.pending;len>strm.avail_out&&(len=strm.avail_out),0!==len&&(utils.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,0===s.pending&&(s.pending_out=0))}function flush_block_only(s,last){trees._tr_flush_block(s,0<=s.block_start?s.block_start:-1,s.strstart-s.block_start,last),s.block_start=s.strstart,flush_pending(s.strm)}function put_byte(s,b){s.pending_buf[s.pending++]=b}function putShortMSB(s,b){s.pending_buf[s.pending++]=b>>>8&255,s.pending_buf[s.pending++]=255&b}function longest_match(s,cur_match){var match,len,chain_length=s.max_chain_length,scan=s.strstart,best_len=s.prev_length,nice_match=s.nice_match,limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+MAX_MATCH,scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s.prev_length>=s.good_match&&(chain_length>>=2),nice_match>s.lookahead&&(nice_match=s.lookahead);do{if(_win[(match=cur_match)+best_len]===scan_end&&_win[match+best_len-1]===scan_end1&&_win[match]===_win[scan]&&_win[++match]===_win[scan+1]){scan+=2,match++;do{}while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,best_len<len){if(s.match_start=cur_match,nice_match<=(best_len=len))break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}}while((cur_match=prev[cur_match&wmask])>limit&&0!=--chain_length);return best_len<=s.lookahead?best_len:s.lookahead}function fill_window(s){var p,n,m,more,str,strm,buf,start,size,len,_w_size=s.w_size;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){for(utils.arraySet(s.window,s.window,_w_size,_w_size,0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,p=n=s.hash_size;m=s.head[--p],s.head[p]=_w_size<=m?m-_w_size:0,--n;);for(p=n=_w_size;m=s.prev[--p],s.prev[p]=_w_size<=m?m-_w_size:0,--n;);more+=_w_size}if(0===s.strm.avail_in)break;if(strm=s.strm,buf=s.window,start=s.strstart+s.lookahead,size=more,len=void 0,len=strm.avail_in,size<len&&(len=size),n=0===len?0:(strm.avail_in-=len,utils.arraySet(buf,strm.input,strm.next_in,len,start),1===strm.state.wrap?strm.adler=adler32(strm.adler,buf,len,start):2===strm.state.wrap&&(strm.adler=crc32(strm.adler,buf,len,start)),strm.next_in+=len,strm.total_in+=len,len),s.lookahead+=n,s.lookahead+s.insert>=MIN_MATCH)for(str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,!(s.lookahead+s.insert<MIN_MATCH)););}while(s.lookahead<MIN_LOOKAHEAD&&0!==s.strm.avail_in)}function deflate_fast(s,flush){for(var hash_head,bflush;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!==hash_head&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head)),s.match_length>=MIN_MATCH)if(bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){for(s.match_length--;s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart,0!=--s.match_length;);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(s,flush){for(var hash_head,bflush,max_insert;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,0!==hash_head&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(1===s.strategy||s.match_length===MIN_MATCH&&4096<s.strstart-s.match_start)&&(s.match_length=MIN_MATCH-1)),s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){for(max_insert=s.strstart+s.lookahead-MIN_MATCH,bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;++s.strstart<=max_insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!=--s.prev_length;);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}else if(s.match_available){if((bflush=trees._tr_tally(s,0,s.window[s.strstart-1]))&&flush_block_only(s,!1),s.strstart++,s.lookahead--,0===s.strm.avail_out)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(bflush=trees._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils.Buf16(2*HEAP_SIZE),this.dyn_dtree=new utils.Buf16(2*(2*D_CODES+1)),this.bl_tree=new utils.Buf16(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils.Buf16(MAX_BITS+1),this.heap=new utils.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(strm){var s;return strm&&strm.state?(strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN,(s=strm.state).pending=0,s.pending_out=0,s.wrap<0&&(s.wrap=-s.wrap),s.status=s.wrap?INIT_STATE:BUSY_STATE,strm.adler=2===s.wrap?0:1,s.last_flush=Z_NO_FLUSH,trees._tr_init(s),Z_OK):err(strm,Z_STREAM_ERROR)}function deflateReset(strm){var s,ret=deflateResetKeep(strm);return ret===Z_OK&&((s=strm.state).window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,s.ins_h=0),ret}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR;var wrap=1;if(level===Z_DEFAULT_COMPRESSION&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):15<windowBits&&(wrap=2,windowBits-=16),memLevel<1||MAX_MEM_LEVEL<memLevel||method!==Z_DEFLATED||windowBits<8||15<windowBits||level<0||9<level||strategy<0||Z_FIXED<strategy)return err(strm,Z_STREAM_ERROR);8===windowBits&&(windowBits=9);var s=new DeflateState;return(strm.state=s).strm=strm,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH),s.window=new utils.Buf8(2*s.w_size),s.head=new utils.Buf16(s.hash_size),s.prev=new utils.Buf16(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new utils.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)}configuration_table=[new Config(0,0,0,0,function(s,flush){var max_block_size=65535;for(max_block_size>s.pending_buf_size-5&&(max_block_size=s.pending_buf_size-5);;){if(s.lookahead<=1){if(fill_window(s),0===s.lookahead&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}s.strstart+=s.lookahead,s.lookahead=0;var max_start=s.block_start+max_block_size;if((0===s.strstart||s.strstart>=max_start)&&(s.lookahead=s.strstart-max_start,s.strstart=max_start,flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE;if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(s.strstart>s.block_start&&(flush_block_only(s,!1),s.strm.avail_out),BS_NEED_MORE)}),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],exports.deflateInit=function(strm,level){return deflateInit2(strm,level,Z_DEFLATED,15,8,0)},exports.deflateInit2=deflateInit2,exports.deflateReset=deflateReset,exports.deflateResetKeep=deflateResetKeep,exports.deflateSetHeader=function(strm,head){return strm&&strm.state?2!==strm.state.wrap?Z_STREAM_ERROR:(strm.state.gzhead=head,Z_OK):Z_STREAM_ERROR},exports.deflate=function(strm,flush){var old_flush,s,beg,val;if(!strm||!strm.state||5<flush||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;if(s=strm.state,!strm.output||!strm.input&&0!==strm.avail_in||666===s.status&&flush!==Z_FINISH)return err(strm,0===strm.avail_out?-5:Z_STREAM_ERROR);if(s.strm=strm,old_flush=s.last_flush,s.last_flush=flush,s.status===INIT_STATE)if(2===s.wrap)strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),s.gzhead?(put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),put_byte(s,255&s.gzhead.time),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),put_byte(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(put_byte(s,255&s.gzhead.extra.length),put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),put_byte(s,3),s.status=BUSY_STATE);else{var header=Z_DEFLATED+(s.w_bits-8<<4)<<8;header|=(2<=s.strategy||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(header|=32),header+=31-header%31,s.status=BUSY_STATE,putShortMSB(s,header),0!==s.strstart&&(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),strm.adler=1}if(69===s.status)if(s.gzhead.extra){for(beg=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending!==s.pending_buf_size));)put_byte(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}put_byte(s,val=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}put_byte(s,val=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&flush_pending(strm),s.pending+2<=s.pending_buf_size&&(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),strm.adler=0,s.status=BUSY_STATE)):s.status=BUSY_STATE),0!==s.pending){if(flush_pending(strm),0===strm.avail_out)return s.last_flush=-1,Z_OK}else if(0===strm.avail_in&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH)return err(strm,-5);if(666===s.status&&0!==strm.avail_in)return err(strm,-5);if(0!==strm.avail_in||0!==s.lookahead||flush!==Z_NO_FLUSH&&666!==s.status){var bstate=2===s.strategy?function(s,flush){for(var bflush;;){if(0===s.lookahead&&(fill_window(s),0===s.lookahead)){if(flush===Z_NO_FLUSH)return BS_NEED_MORE;break}if(s.match_length=0,bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}(s,flush):3===s.strategy?function(s,flush){for(var bflush,prev,scan,strend,_win=s.window;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&0<s.strstart&&(prev=_win[scan=s.strstart-1])===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]){strend=s.strstart+MAX_MATCH;do{}while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=MAX_MATCH-(strend-scan),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=MIN_MATCH?(bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}(s,flush):configuration_table[s.level].func(s,flush);if(bstate!==BS_FINISH_STARTED&&bstate!==BS_FINISH_DONE||(s.status=666),bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED)return 0===strm.avail_out&&(s.last_flush=-1),Z_OK;if(bstate===BS_BLOCK_DONE&&(1===flush?trees._tr_align(s):5!==flush&&(trees._tr_stored_block(s,0,0,!1),3===flush&&(zero(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),flush_pending(strm),0===strm.avail_out))return s.last_flush=-1,Z_OK}return flush!==Z_FINISH?Z_OK:s.wrap<=0?1:(2===s.wrap?(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,255&strm.total_in),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255)):(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),flush_pending(strm),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?Z_OK:1)},exports.deflateEnd=function(strm){var status;return strm&&strm.state?(status=strm.state.status)!==INIT_STATE&&69!==status&&73!==status&&91!==status&&103!==status&&status!==BUSY_STATE&&666!==status?err(strm,Z_STREAM_ERROR):(strm.state=null,status===BUSY_STATE?err(strm,-3):Z_OK):Z_STREAM_ERROR},exports.deflateSetDictionary=function(strm,dictionary){var s,str,n,wrap,avail,next,input,tmpDict,dictLength=dictionary.length;if(!strm||!strm.state)return Z_STREAM_ERROR;if(2===(wrap=(s=strm.state).wrap)||1===wrap&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR;for(1===wrap&&(strm.adler=adler32(strm.adler,dictionary,dictLength,0)),s.wrap=0,dictLength>=s.w_size&&(0===wrap&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0),tmpDict=new utils.Buf8(s.w_size),utils.arraySet(tmpDict,dictionary,dictLength-s.w_size,s.w_size,0),dictionary=tmpDict,dictLength=s.w_size),avail=strm.avail_in,next=strm.next_in,input=strm.input,strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);s.lookahead>=MIN_MATCH;){for(str=s.strstart,n=s.lookahead-(MIN_MATCH-1);s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,--n;);s.strstart=str,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK},exports.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":75,"./adler32":77,"./crc32":79,"./messages":85,"./trees":86}],81:[function(require,module,exports){"use strict";module.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],82:[function(require,module,exports){"use strict";module.exports=function(strm,start){var state,_in,last,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;state=strm.state,_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(hold>>>=op=here>>>24,bits-=op,0===(op=here>>>16&255))output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue dolen}if(32&op){state.mode=12;break top}strm.msg="invalid literal/length code",state.mode=30;break top}len=65535&here,(op&=15)&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(hold>>>=op=here>>>24,bits-=op,!(16&(op=here>>>16&255))){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue dodist}strm.msg="invalid distance code",state.mode=30;break top}if(dist=65535&here,bits<(op&=15)&&(hold+=input[_in++]<<bits,(bits+=8)<op&&(hold+=input[_in++]<<bits,bits+=8)),dmax<(dist+=hold&(1<<op)-1)){strm.msg="invalid distance too far back",state.mode=30;break top}if(hold>>>=op,bits-=op,(op=_out-beg)<dist){if(whave<(op=dist-op)&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break top}if(from_source=s_window,(from=0)===wnext){if(from+=wsize-op,op<len){for(len-=op;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,(op-=wnext)<len){for(len-=op;output[_out++]=s_window[from++],--op;);if(from=0,wnext<len){for(len-=op=wnext;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){for(len-=op;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}for(;2<len;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],1<len&&(output[_out++]=from_source[from++]))}else{for(from=_out-dist;output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],2<(len-=3););len&&(output[_out++]=output[from++],1<len&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);_in-=len=bits>>3,hold&=(1<<(bits-=len<<3))-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits}},{}],83:[function(require,module,exports){"use strict";var utils=require("../utils/common"),adler32=require("./adler32"),crc32=require("./crc32"),inflate_fast=require("./inffast"),inflate_table=require("./inftrees"),LENS=1,DISTS=2,Z_OK=0,Z_STREAM_ERROR=-2,HEAD=1,ENOUGH_LENS=852,ENOUGH_DISTS=592;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils.Buf16(320),this.work=new utils.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(strm){var state;return strm&&strm.state?(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK):Z_STREAM_ERROR}function inflateReset(strm){var state;return strm&&strm.state?((state=strm.state).wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)):Z_STREAM_ERROR}function inflateReset2(strm,windowBits){var wrap,state;return strm&&strm.state?(state=strm.state,windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=1+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||15<windowBits)?Z_STREAM_ERROR:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))):Z_STREAM_ERROR}function inflateInit2(strm,windowBits){var ret,state;return strm?(state=new InflateState,(strm.state=state).window=null,(ret=inflateReset2(strm,windowBits))!==Z_OK&&(strm.state=null),ret):Z_STREAM_ERROR}var lenfix,distfix,virgin=!0;function fixedtables(state){if(virgin){var sym;for(lenfix=new utils.Buf32(512),distfix=new utils.Buf32(32),sym=0;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end,copy){var dist,state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new utils.Buf8(state.wsize)),copy>=state.wsize?(utils.arraySet(state.window,src,end-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize):(copy<(dist=state.wsize-state.wnext)&&(dist=copy),utils.arraySet(state.window,src,end-copy,dist,state.wnext),(copy-=dist)?(utils.arraySet(state.window,src,end-copy,copy,0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0}exports.inflateReset=inflateReset,exports.inflateReset2=inflateReset2,exports.inflateResetKeep=inflateResetKeep,exports.inflateInit=function(strm){return inflateInit2(strm,15)},exports.inflateInit2=inflateInit2,exports.inflate=function(strm,flush){var state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,opts,n,here=0,hbuf=new utils.Buf8(4),order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR;12===(state=strm.state).mode&&(state.mode=13),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(0===state.wrap){state.mode=13;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){hbuf[state.check=0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),bits=hold=0,state.mode=2;break}if(state.flags=0,state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=30;break}if(8!=(15&hold)){strm.msg="unknown compression method",state.mode=30;break}if(bits-=4,len=8+(15&(hold>>>=4)),0===state.wbits)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=30;break}state.dmax=1<<len,strm.adler=state.check=1,state.mode=512&hold?10:12,bits=hold=0;break;case 2:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,8!=(255&state.flags)){strm.msg="unknown compression method",state.mode=30;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=30;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),bits=hold=0,state.mode=3;case 3:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0)),bits=hold=0,state.mode=4;case 4:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),bits=hold=0,state.mode=5;case 5:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),bits=hold=0}else state.head&&(state.head.extra=null);state.mode=6;case 6:if(1024&state.flags&&(have<(copy=state.length)&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Array(state.head.extra_len)),utils.arraySet(state.head.extra,input,next,copy,len)),512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=7;case 7:if(2048&state.flags){if(0===have)break inf_leave;for(copy=0;len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len)),len&&copy<have;);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=8;case 8:if(4096&state.flags){if(0===have)break inf_leave;for(copy=0;len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len)),len&&copy<have;);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=9;case 9:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=30;break}bits=hold=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=12;break;case 10:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),bits=hold=0,state.mode=11;case 11:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,2;strm.adler=state.check=1,state.mode=12;case 12:if(5===flush||6===flush)break inf_leave;case 13:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=27;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,bits-=1,3&(hold>>>=1)){case 0:state.mode=14;break;case 1:if(fixedtables(state),state.mode=20,6===flush){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=17;break;case 3:strm.msg="invalid block type",state.mode=30}hold>>>=2,bits-=2;break;case 14:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=30;break}if(state.length=65535&hold,bits=hold=0,state.mode=15,6===flush)break inf_leave;case 15:state.mode=16;case 16:if(copy=state.length){if(have<copy&&(copy=have),left<copy&&(copy=left),0===copy)break inf_leave;utils.arraySet(output,input,next,copy,put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=12;break;case 17:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,286<state.nlen||30<state.ndist){strm.msg="too many length or distance symbols",state.mode=30;break}state.have=0,state.mode=18;case 18:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(0,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=30;break}state.have=0,state.mode=19;case 19:for(;state.have<state.nlen+state.ndist;){for(;here_op=(here=state.lencode[hold&(1<<state.lenbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=30;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=3+(7&(hold>>>=here_bits)),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=11+(127&(hold>>>=here_bits)),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=30;break}for(;copy--;)state.lens[state.have++]=len}}if(30===state.mode)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=30;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=30;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=30;break}if(state.mode=20,6===flush)break inf_leave;case 20:state.mode=21;case 21:if(6<=have&&258<=left){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,12===state.mode&&(state.back=-1);break}for(state.back=0;here_op=(here=state.lencode[hold&(1<<state.lenbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here_op=(here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)])>>>16&255,here_val=65535&here,!(last_bits+(here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=26;break}if(32&here_op){state.back=-1,state.mode=12;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=30;break}state.extra=15&here_op,state.mode=22;case 22:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=23;case 23:for(;here_op=(here=state.distcode[hold&(1<<state.distbits)-1])>>>16&255,here_val=65535&here,!((here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here_op=(here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)])>>>16&255,here_val=65535&here,!(last_bits+(here_bits=here>>>24)<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=30;break}state.offset=here_val,state.extra=15&here_op,state.mode=24;case 24:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=30;break}state.mode=25;case 25:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if((copy=state.offset-copy)>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;for(left<copy&&(copy=left),left-=copy,state.length-=copy;output[put++]=from_source[from++],--copy;);0===state.length&&(state.mode=21);break;case 26:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=21;break;case 27:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=30;break}bits=hold=0}state.mode=28;case 28:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=30;break}bits=hold=0}state.mode=29;case 29:ret=1;break inf_leave;case 30:ret=-3;break inf_leave;case 31:return-4;case 32:default:return Z_STREAM_ERROR}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<30&&(state.mode<27||4!==flush))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=31,-4):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(12===state.mode?128:0)+(20===state.mode||15===state.mode?256:0),(0===_in&&0===_out||4===flush)&&ret===Z_OK&&(ret=-5),ret)},exports.inflateEnd=function(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK},exports.inflateGetHeader=function(strm,head){var state;return strm&&strm.state?0==(2&(state=strm.state).wrap)?Z_STREAM_ERROR:((state.head=head).done=!1,Z_OK):Z_STREAM_ERROR},exports.inflateSetDictionary=function(strm,dictionary){var state,dictLength=dictionary.length;return strm&&strm.state?0!==(state=strm.state).wrap&&11!==state.mode?Z_STREAM_ERROR:11===state.mode&&adler32(1,dictionary,dictLength,0)!==state.check?-3:updatewindow(strm,dictionary,dictLength,dictLength)?(state.mode=31,-4):(state.havedict=1,Z_OK):Z_STREAM_ERROR},exports.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":75,"./adler32":77,"./crc32":79,"./inffast":82,"./inftrees":84}],84:[function(require,module,exports){"use strict";var utils=require("../utils/common"),lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(type,lens,lens_index,codes,table,table_index,work,opts){var incr,fill,low,mask,next,end,here_bits,here_op,here_val,bits=opts.bits,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,base=null,base_index=0,count=new utils.Buf16(16),offs=new utils.Buf16(16),extra=null,extra_index=0;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;1<=max&&0===count[max];max--);if(max<root&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),len=left=1;len<=15;len++)if(left<<=1,(left-=count[len])<0)return-1;if(0<left&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(0===type?(base=extra=work,end=19):1===type?(base=lbase,base_index-=257,extra=lext,extra_index-=257,end=256):(base=dbase,extra=dext,end=-1),len=min,next=table_index,drop=sym=huff=0,low=-1,mask=(used=1<<(curr=root))-1,1===type&&852<used||2===type&&592<used)return 1;for(;;){for(here_bits=len-drop,work[sym]<end?(here_op=0,here_val=work[sym]):work[sym]>end?(here_op=extra[extra_index+work[sym]],here_val=base[base_index+work[sym]]):(here_op=96,here_val=0),incr=1<<len-drop,min=fill=1<<curr;table[next+(huff>>drop)+(fill-=incr)]=here_bits<<24|here_op<<16|here_val|0,0!==fill;);for(incr=1<<len-1;huff&incr;)incr>>=1;if(0!==incr?(huff&=incr-1,huff+=incr):huff=0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(root<len&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,left=1<<(curr=len-drop);curr+drop<max&&!((left-=count[curr+drop])<=0);)curr++,left<<=1;if(used+=1<<curr,1===type&&852<used||2===type&&592<used)return 1;table[low=huff&mask]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0}},{"../utils/common":75}],85:[function(require,module,exports){"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],86:[function(require,module,exports){"use strict";var utils=require("../utils/common"),Z_BINARY=0,Z_TEXT=1;function zero(buf){for(var len=buf.length;0<=--len;)buf[len]=0}var STORED_BLOCK=0,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],static_ltree=new Array(2*(L_CODES+2));zero(static_ltree);var static_dtree=new Array(2*D_CODES);zero(static_dtree);var _dist_code=new Array(512);zero(_dist_code);var _length_code=new Array(256);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var static_l_desc,static_d_desc,static_bl_desc,base_dist=new Array(D_CODES);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=255&w,s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){s.bi_valid>Buf_size-length?(s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>Buf_size-s.bi_valid,s.bi_valid+=length-Buf_size):(s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length)}function send_code(s,c,tree){send_bits(s,tree[2*c],tree[2*c+1])}function bi_reverse(code,len){for(var res=0;res|=1&code,code>>>=1,res<<=1,0<--len;);return res>>>1}function gen_codes(tree,max_code,bl_count){var bits,n,next_code=new Array(MAX_BITS+1),code=0;for(bits=1;bits<=MAX_BITS;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[2*n+1];0!==len&&(tree[2*n]=bi_reverse(next_code[len]++,len))}}function init_block(s){var n;for(n=0;n<L_CODES;n++)s.dyn_ltree[2*n]=0;for(n=0;n<D_CODES;n++)s.dyn_dtree[2*n]=0;for(n=0;n<BL_CODES;n++)s.bl_tree[2*n]=0;s.dyn_ltree[2*END_BLOCK]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function bi_windup(s){8<s.bi_valid?put_short(s,s.bi_buf):0<s.bi_valid&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0}function smaller(tree,n,m,depth){var _n2=2*n,_m2=2*m;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k){for(var v=s.heap[k],j=k<<1;j<=s.heap_len&&(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)&&j++,!smaller(tree,v,s.heap[j],s.depth));)s.heap[k]=s.heap[j],k=j,j<<=1;s.heap[k]=v}function compress_block(s,ltree,dtree){var dist,lc,code,extra,lx=0;if(0!==s.last_lit)for(;dist=s.pending_buf[s.d_buf+2*lx]<<8|s.pending_buf[s.d_buf+2*lx+1],lc=s.pending_buf[s.l_buf+lx],lx++,0===dist?send_code(s,lc,ltree):(send_code(s,(code=_length_code[lc])+LITERALS+1,ltree),0!==(extra=extra_lbits[code])&&send_bits(s,lc-=base_length[code],extra),send_code(s,code=d_code(--dist),dtree),0!==(extra=extra_dbits[code])&&send_bits(s,dist-=base_dist[code],extra)),lx<s.last_lit;);send_code(s,END_BLOCK,ltree)}function build_tree(s,desc){var n,m,node,tree=desc.dyn_tree,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems,max_code=-1;for(s.heap_len=0,s.heap_max=HEAP_SIZE,n=0;n<elems;n++)0!==tree[2*n]?(s.heap[++s.heap_len]=max_code=n,s.depth[n]=0):tree[2*n+1]=0;for(;s.heap_len<2;)tree[2*(node=s.heap[++s.heap_len]=max_code<2?++max_code:0)]=1,s.depth[node]=0,s.opt_len--,has_stree&&(s.static_len-=stree[2*node+1]);for(desc.max_code=max_code,n=s.heap_len>>1;1<=n;n--)pqdownheap(s,tree,n);for(node=elems;n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[2*node]=tree[2*n]+tree[2*m],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[2*n+1]=tree[2*m+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1),2<=s.heap_len;);s.heap[--s.heap_max]=s.heap[1],function(s,desc){var h,n,m,bits,xbits,f,tree=desc.dyn_tree,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length,overflow=0;for(bits=0;bits<=MAX_BITS;bits++)s.bl_count[bits]=0;for(tree[2*s.heap[s.heap_max]+1]=0,h=s.heap_max+1;h<HEAP_SIZE;h++)max_length<(bits=tree[2*tree[2*(n=s.heap[h])+1]+1]+1)&&(bits=max_length,overflow++),tree[2*n+1]=bits,max_code<n||(s.bl_count[bits]++,xbits=0,base<=n&&(xbits=extra[n-base]),f=tree[2*n],s.opt_len+=f*(bits+xbits),has_stree&&(s.static_len+=f*(stree[2*n+1]+xbits)));if(0!==overflow){do{for(bits=max_length-1;0===s.bl_count[bits];)bits--;s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,overflow-=2}while(0<overflow);for(bits=max_length;0!==bits;bits--)for(n=s.bl_count[bits];0!==n;)max_code<(m=s.heap[--h])||(tree[2*m+1]!==bits&&(s.opt_len+=(bits-tree[2*m+1])*tree[2*m],tree[2*m+1]=bits),n--)}}(s,desc),gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),tree[2*(max_code+1)+1]=65535,n=0;n<=max_code;n++)curlen=nextlen,nextlen=tree[2*(n+1)+1],++count<max_count&&curlen===nextlen||(count<min_count?s.bl_tree[2*curlen]+=count:0!==curlen?(curlen!==prevlen&&s.bl_tree[2*curlen]++,s.bl_tree[2*REP_3_6]++):count<=10?s.bl_tree[2*REPZ_3_10]++:s.bl_tree[2*REPZ_11_138]++,prevlen=curlen,(count=0)===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4))}function send_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),n=0;n<=max_code;n++)if(curlen=nextlen,nextlen=tree[2*(n+1)+1],!(++count<max_count&&curlen===nextlen)){if(count<min_count)for(;send_code(s,curlen,s.bl_tree),0!=--count;);else 0!==curlen?(curlen!==prevlen&&(send_code(s,curlen,s.bl_tree),count--),send_code(s,REP_3_6,s.bl_tree),send_bits(s,count-3,2)):count<=10?(send_code(s,REPZ_3_10,s.bl_tree),send_bits(s,count-3,3)):(send_code(s,REPZ_11_138,s.bl_tree),send_bits(s,count-11,7));prevlen=curlen,(count=0)===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4)}}zero(base_dist);var static_init_done=!1;function _tr_stored_block(s,buf,stored_len,last){send_bits(s,(STORED_BLOCK<<1)+(last?1:0),3),function(s,buf,len,header){bi_windup(s),header&&(put_short(s,len),put_short(s,~len)),utils.arraySet(s.pending_buf,s.window,buf,len,s.pending),s.pending+=len}(s,buf,stored_len,!0)}exports._tr_init=function(s){static_init_done||(function(){var n,bits,length,code,dist,bl_count=new Array(MAX_BITS+1);for(code=length=0;code<LENGTH_CODES-1;code++)for(base_length[code]=length,n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code;for(_length_code[length-1]=code,code=dist=0;code<16;code++)for(base_dist[code]=dist,n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code;for(dist>>=7;code<D_CODES;code++)for(base_dist[code]=dist<<7,n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code;for(bits=0;bits<=MAX_BITS;bits++)bl_count[bits]=0;for(n=0;n<=143;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(;n<=255;)static_ltree[2*n+1]=9,n++,bl_count[9]++;for(;n<=279;)static_ltree[2*n+1]=7,n++,bl_count[7]++;for(;n<=287;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(gen_codes(static_ltree,L_CODES+1,bl_count),n=0;n<D_CODES;n++)static_dtree[2*n+1]=5,static_dtree[2*n]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}(),static_init_done=!0),s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},exports._tr_stored_block=_tr_stored_block,exports._tr_flush_block=function(s,buf,stored_len,last){var opt_lenb,static_lenb,max_blindex=0;0<s.level?(2===s.strm.data_type&&(s.strm.data_type=function(s){var n,black_mask=4093624447;for(n=0;n<=31;n++,black_mask>>>=1)if(1&black_mask&&0!==s.dyn_ltree[2*n])return Z_BINARY;if(0!==s.dyn_ltree[18]||0!==s.dyn_ltree[20]||0!==s.dyn_ltree[26])return Z_TEXT;for(n=32;n<LITERALS;n++)if(0!==s.dyn_ltree[2*n])return Z_TEXT;return Z_BINARY}(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=function(s){var max_blindex;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),max_blindex=BL_CODES-1;3<=max_blindex&&0===s.bl_tree[2*bl_order[max_blindex]+1];max_blindex--);return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex}(s),opt_lenb=s.opt_len+3+7>>>3,(static_lenb=s.static_len+3+7>>>3)<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&-1!==buf?_tr_stored_block(s,buf,stored_len,last):4===s.strategy||static_lenb===opt_lenb?(send_bits(s,2+(last?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,4+(last?1:0),3),function(s,lcodes,dcodes,blcodes){var rank;for(send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4),rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[2*bl_order[rank]+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)}(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),last&&bi_windup(s)},exports._tr_tally=function(s,dist,lc){return s.pending_buf[s.d_buf+2*s.last_lit]=dist>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&dist,s.pending_buf[s.l_buf+s.last_lit]=255&lc,s.last_lit++,0===dist?s.dyn_ltree[2*lc]++:(s.matches++,dist--,s.dyn_ltree[2*(_length_code[lc]+LITERALS+1)]++,s.dyn_dtree[2*d_code(dist)]++),s.last_lit===s.lit_bufsize-1},exports._tr_align=function(s){send_bits(s,2,3),send_code(s,END_BLOCK,static_ltree),function(s){16===s.bi_valid?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):8<=s.bi_valid&&(s.pending_buf[s.pending++]=255&s.bi_buf,s.bi_buf>>=8,s.bi_valid-=8)}(s)}},{"../utils/common":75}],87:[function(require,module,exports){"use strict";module.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],88:[function(require,module,exports){(function(process){"use strict";!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports={nextTick:function(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}}:module.exports=process}).call(this,require("_process"))},{_process:89}],89:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],90:[function(require,module,exports){(function(global){!function(root){var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return 1<parts.length&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)55296<=(value=string.charCodeAt(counter++))&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return 65535<value&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);baseMinusTMin*tMax>>1<delta;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for((basic=input.lastIndexOf(delimiter))<0&&(basic=0),j=0;j<basic;++j)128<=input.charCodeAt(j)&&error("not-basic"),output.push(input.charCodeAt(j));for(index=0<basic?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;inputLength<=index&&error("invalid-input"),codePoint=input.charCodeAt(index++),(base<=(digit=codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base)||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?tMin:bias+tMax<=k?tMax:k-bias));k+=base)w>floor(maxInt/(baseMinusT=base-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=initialN,bias=initialBias,j=delta=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)n<=(currentValue=input[j])&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;!(q<(t=k<=bias?tMin:bias+tMax<=k?tMax:k-bias));k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})},toUnicode:function(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}},freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;0<maxKeys&&maxKeys<len&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);0<=idx?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],92:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],93:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":91,"./encode":92}],94:[function(require,module,exports){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":95}],95:[function(require,module,exports){"use strict";var pna=require("process-nextick-args"),objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),options&&!1===options.readable&&(this.readable=!1),options&&!1===options.writable&&(this.writable=!1),this.allowHalfOpen=!0,options&&!1===options.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||pna.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}}),Duplex.prototype._destroy=function(err,cb){this.push(null),this.end(),pna.nextTick(cb,err)}},{"./_stream_readable":97,"./_stream_writable":99,"core-util-is":41,inherits:61,"process-nextick-args":88}],96:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":98,"core-util-is":41,inherits:61}],97:[function(require,module,exports){(function(process,global){"use strict";var pna=require("process-nextick-args");module.exports=Readable;var Duplex,isArray=require("isarray");Readable.ReadableState=ReadableState;require("events").EventEmitter;var EElistenerCount=function(emitter,type){return emitter.listeners(type).length},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};var util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];function ReadableState(options,stream){options=options||{};var isDuplex=stream instanceof(Duplex=Duplex||require("./_stream_duplex"));this.objectMode=!!options.objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,readableHwm=options.readableHighWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:isDuplex&&(readableHwm||0===readableHwm)?readableHwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){var er,state=stream._readableState;null===chunk?(state.reading=!1,function(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}(stream,state)):(skipChunkCheck||(er=function(state,chunk){var er;obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array||"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk"));var obj;return er}(state,chunk)),er?stream.emit("error",er):state.objectMode||chunk&&0<chunk.length?("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),addToFront?state.endEmitted?stream.emit("error",new Error("stream.unshift() after end event")):addChunk(stream,state,chunk,!0):state.ended?stream.emit("error",new Error("stream.push() after EOF")):(state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1))):addToFront||(state.reading=!1));return function(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}(state)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(err,cb){this.push(null),cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&((encoding=encoding||state.defaultEncoding)!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!=n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=function(n){return MAX_HWM<=n?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?pna.nextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,pna.nextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){return 0===state.length?null:(state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=function(n,list,hasStrings){var ret;n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?function(n,list){var p=list.head,c=1,ret=p.data;n-=ret.length;for(;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p).data=str.slice(nb);break}++c}return list.length-=c,ret}(n,list):function(n,list){var ret=Buffer.allocUnsafe(n),p=list.head,c=1;p.data.copy(ret),n-=p.data.length;for(;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p).data=buf.slice(nb);break}++c}return list.length-=c,ret}(n,list);return ret}(n,state.buffer,state.decoder),ret);var ret}function endReadable(stream){var state=stream._readableState;if(0<state.length)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,pna.nextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var ret,doRead=state.needReadable;return debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&debug("length less than watermark",doRead=!0),state.ended||state.reading?debug("reading or ended",doRead=!1):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state))),null===(ret=0<n?fromList(n,state):null)?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var endFn=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr?onend:unpipe;function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain())}function onend(){debug("onend"),dest.end()}state.endEmitted?pna.nextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=function(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}(src);dest.on("drain",ondrain);var cleanedUp=!1;var increasedAwaitDrain=!1;function ondata(chunk){debug("ondata"),(increasedAwaitDrain=!1)!==dest.write(chunk)||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||1<state.pipesCount&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}return src.on("data",ondata),function(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes||(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo)),this;if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,unpipeInfo);return this}var index=indexOf(state.pipes,dest);return-1===index||(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo)),this},Readable.prototype.addListener=Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)!1!==this._readableState.flowing&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this):pna.nextTick(nReadingNextTick,this))}return res},Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,function(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,pna.nextTick(resume_,stream,state))}(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var _this=this,state=this._readableState,paused=!1;for(var i in stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&_this.push(chunk)}_this.push(null)}),stream.on("data",function(chunk){(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),state.objectMode&&null==chunk)||(state.objectMode||chunk&&chunk.length)&&(_this.push(chunk)||(paused=!0,stream.pause()))}),stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]));return this._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},this},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Readable._fromList=fromList}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":95,"./internal/streams/BufferList":100,"./internal/streams/destroy":101,"./internal/streams/stream":102,_process:89,"core-util-is":41,events:45,inherits:61,isarray:63,"process-nextick-args":88,"safe-buffer":107,"string_decoder/":116,util:15}],98:[function(require,module,exports){"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState={afterTransform:function(er,data){var ts=this._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return this.emit("error",new Error("write callback called multiple times"));ts.writechunk=null,(ts.writecb=null)!=data&&this.push(data),cb(er);var rs=this._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.on("prefinish",prefinish)}function prefinish(){var _this=this;"function"==typeof this._flush?this._flush(function(er,data){done(_this,er,data)}):done(this,null,null)}function done(stream,er,data){if(er)return stream.emit("error",er);if(null!=data&&stream.push(data),stream._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(stream._transformState.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0},Transform.prototype._destroy=function(err,cb){var _this2=this;Duplex.prototype._destroy.call(this,err,function(err2){cb(err2),_this2.emit("close")})}},{"./_stream_duplex":95,"core-util-is":41,inherits:61}],99:[function(require,module,exports){(function(process,global,setImmediate){"use strict";var pna=require("process-nextick-args");function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){!function(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;for(;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=corkReq:state.corkedRequestsFree=corkReq}(_this,state)}}module.exports=Writable;var Duplex,asyncWrite=!process.browser&&-1<["v0.10","v0.9."].indexOf(process.version.slice(0,5))?setImmediate:pna.nextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};var realHasInstance,destroyImpl=require("./internal/streams/destroy");function nop(){}function WritableState(options,stream){Duplex=Duplex||require("./_stream_duplex"),options=options||{};var isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,writableHwm=options.writableHighWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:isDuplex&&(writableHwm||0===writableHwm)?writableHwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var noDecode=(this.destroyed=!1)===options.decodeStrings;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){!function(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(function(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}(state),er)!function(stream,state,sync,er,cb){--state.pendingcb,sync?(pna.nextTick(cb,er),pna.nextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,stream.emit("error",er)):(cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er),finishMaybe(stream,state))}(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function afterWrite(stream,state,finished,cb){finished||function(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0,allBuffers=!0;entry;)(buffer[count]=entry).isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state),state.bufferedRequestCount=0}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.bufferedRequestCount--,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&stream.emit("error",err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function finishMaybe(stream,state){var need=needFinish(state);return need&&(!function(stream,state){state.prefinished||state.finalCalled||("function"==typeof stream._final?(state.pendingcb++,state.finalCalled=!0,pna.nextTick(callFinal,stream,state)):(state.prefinished=!0,stream.emit("prefinish")))}(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"))),need}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||this===Writable&&(object&&object._writableState instanceof WritableState)}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var obj,state=this._writableState,ret=!1,isBuf=!state.objectMode&&(obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array);return isBuf&&!Buffer.isBuffer(chunk)&&(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),isBuf?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?function(stream,cb){var er=new Error("write after end");stream.emit("error",er),pna.nextTick(cb,er)}(this,cb):(isBuf||function(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),pna.nextTick(cb,er),valid=!1),valid}(this,state,chunk,cb))&&(state.pendingcb++,ret=function(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=function(state,chunk,encoding){state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding));return chunk}(state,chunk,encoding);chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk)}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;ret||(state.needDrain=!0);if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}(this,state,isBuf,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,encoding=chunk=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!=chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||function(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?pna.nextTick(cb):stream.once("finish",cb));state.ended=!0,stream.writable=!1}(this,state,cb)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){this.end(),cb(err)}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("timers").setImmediate)},{"./_stream_duplex":95,"./internal/streams/destroy":101,"./internal/streams/stream":102,_process:89,"core-util-is":41,inherits:61,"process-nextick-args":88,"safe-buffer":107,timers:118,"util-deprecate":122}],100:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer,util=require("util");module.exports=function(){function BufferList(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BufferList),this.head=null,this.tail=null,this.length=0}return BufferList.prototype.push=function(v){var entry={data:v,next:null};0<this.length?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var src,target,offset,ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)src=p.data,target=ret,offset=i,src.copy(target,offset),i+=p.data.length,p=p.next;return ret},BufferList}(),util&&util.inspect&&util.inspect.custom&&(module.exports.prototype[util.inspect.custom]=function(){var obj=util.inspect({length:this.length});return this.constructor.name+" "+obj})},{"safe-buffer":107,util:15}],101:[function(require,module,exports){"use strict";var pna=require("process-nextick-args");function emitErrorNT(self,err){self.emit("error",err)}module.exports={destroy:function(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;return readableDestroyed||writableDestroyed?cb?cb(err):!err||this._writableState&&this._writableState.errorEmitted||pna.nextTick(emitErrorNT,this,err):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?(pna.nextTick(emitErrorNT,_this,err),_this._writableState&&(_this._writableState.errorEmitted=!0)):cb&&cb(err)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":88}],102:[function(require,module,exports){module.exports=require("events").EventEmitter},{events:45}],103:[function(require,module,exports){module.exports=require("./readable").PassThrough},{"./readable":104}],104:[function(require,module,exports){(((exports=module.exports=require("./lib/_stream_readable.js")).Stream=exports).Readable=exports).Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":95,"./lib/_stream_passthrough.js":96,"./lib/_stream_readable.js":97,"./lib/_stream_transform.js":98,"./lib/_stream_writable.js":99}],105:[function(require,module,exports){module.exports=require("./readable").Transform},{"./readable":104}],106:[function(require,module,exports){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":99}],107:[function(require,module,exports){var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");var buf=Buffer(size);return void 0!==fill?"string"==typeof encoding?buf.fill(fill,encoding):buf.fill(fill):buf.fill(0),buf},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},{buffer:17}],108:[function(require,module,exports){(function(process,global){!function(global,undefined){"use strict";if(!global.setImmediate){var registerImmediate,html,channel,messagePrefix,onGlobalMessage,nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global,"[object process]"==={}.toString.call(global.process)?registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}:!function(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage("","*"),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}()?global.MessageChannel?((channel=new MessageChannel).port1.onmessage=function(event){runIfPresent(event.data)},registerImmediate=function(handle){channel.port2.postMessage(handle)}):doc&&"onreadystatechange"in doc.createElement("script")?(html=doc.documentElement,registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}):registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}:(messagePrefix="setImmediate$"+Math.random()+"$",onGlobalMessage=function(event){event.source===global&&"string"==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))},global.addEventListener?global.addEventListener("message",onGlobalMessage,!1):global.attachEvent("onmessage",onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}),attachTo.setImmediate=function(callback){"function"!=typeof callback&&(callback=new Function(""+callback));for(var args=new Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++},attachTo.clearImmediate=clearImmediate}function clearImmediate(handle){delete tasksByHandle[handle]}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{!function(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(undefined,args)}}(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}}("undefined"==typeof self?void 0===global?this:global:self)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:89}],109:[function(require,module,exports){module.exports=Stream;var EE=require("events").EventEmitter;function Stream(){EE.call(this)}require("inherits")(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),(Stream.Stream=Stream).prototype.pipe=function(dest,options){var source=this;function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&!1===options.end||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:45,inherits:61,"readable-stream/duplex.js":94,"readable-stream/passthrough.js":103,"readable-stream/readable.js":104,"readable-stream/transform.js":105,"readable-stream/writable.js":106}],110:[function(require,module,exports){(function(global){var ClientRequest=require("./lib/request"),response=require("./lib/response"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(opts,cb){opts="string"==typeof opts?url.parse(opts):extend(opts);var defaultProtocol=-1===global.location.protocol.search(/^https?:$/)?"http:":"",protocol=opts.protocol||defaultProtocol,host=opts.hostname||opts.host,port=opts.port,path=opts.path||"/";host&&-1!==host.indexOf(":")&&(host="["+host+"]"),opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path,opts.method=(opts.method||"GET").toUpperCase(),opts.headers=opts.headers||{};var req=new ClientRequest(opts);return cb&&req.on("response",cb),req},http.get=function(opts,cb){var req=http.request(opts,cb);return req.end(),req},http.ClientRequest=ClientRequest,http.IncomingMessage=response.IncomingMessage,http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.globalAgent=new http.Agent,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":112,"./lib/response":113,"builtin-status-codes":18,url:120,xtend:129}],111:[function(require,module,exports){(function(global){exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream),exports.writableStream=isFunction(global.WritableStream),exports.abortController=isFunction(global.AbortController),exports.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),exports.blobConstructor=!0}catch(e){}var xhr;function getXHR(){if(void 0!==xhr)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else xhr=null;return xhr}function checkTypeSupport(type){var xhr=getXHR();if(!xhr)return!1;try{return xhr.responseType=type,xhr.responseType===type}catch(e){}return!1}var haveArrayBuffer=void 0!==global.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);function isFunction(value){return"function"==typeof value}exports.arraybuffer=exports.fetch||haveArrayBuffer&&checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=exports.fetch||!!getXHR()&&isFunction(getXHR().overrideMimeType),exports.vbArray=isFunction(global.VBArray),xhr=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],112:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability"),inherits=require("inherits"),response=require("./response"),stream=require("readable-stream"),toArrayBuffer=require("to-arraybuffer"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates;var ClientRequest=module.exports=function(opts){var preferBinary,self=this;stream.Writable.call(self),self._opts=opts,self._body=[],self._headers={},opts.auth&&self.setHeader("Authorization","Basic "+new Buffer(opts.auth).toString("base64")),Object.keys(opts.headers).forEach(function(name){self.setHeader(name,opts.headers[name])});var useFetch=!0;if("disable-fetch"===opts.mode||"requestTimeout"in opts&&!capability.abortController)preferBinary=!(useFetch=!1);else if("prefer-streaming"===opts.mode)preferBinary=!1;else if("allow-wrong-content-type"===opts.mode)preferBinary=!capability.overrideMimeType;else{if(opts.mode&&"default"!==opts.mode&&"prefer-fast"!==opts.mode)throw new Error("Invalid value for opts.mode");preferBinary=!0}self._mode=function(preferBinary,useFetch){return capability.fetch&&useFetch?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&preferBinary?"arraybuffer":capability.vbArray&&preferBinary?"text:vbarray":"text"}(preferBinary,useFetch),self._fetchTimer=null,self.on("finish",function(){self._onFinish()})};inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(name,value){var lowerName=name.toLowerCase();-1===unsafeHeaders.indexOf(lowerName)&&(this._headers[lowerName]={name:name,value:value})},ClientRequest.prototype.getHeader=function(name){var header=this._headers[name.toLowerCase()];return header?header.value:null},ClientRequest.prototype.removeHeader=function(name){delete this._headers[name.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var self=this;if(!self._destroyed){var opts=self._opts,headersObj=self._headers,body=null;"GET"!==opts.method&&"HEAD"!==opts.method&&(body=capability.arraybuffer?toArrayBuffer(Buffer.concat(self._body)):capability.blobConstructor?new global.Blob(self._body.map(function(buffer){return toArrayBuffer(buffer)}),{type:(headersObj["content-type"]||{}).value||""}):Buffer.concat(self._body).toString());var headersList=[];if(Object.keys(headersObj).forEach(function(keyName){var name=headersObj[keyName].name,value=headersObj[keyName].value;Array.isArray(value)?value.forEach(function(v){headersList.push([name,v])}):headersList.push([name,value])}),"fetch"===self._mode){var signal=null;if(capability.abortController){var controller=new AbortController;signal=controller.signal,self._fetchAbortController=controller,"requestTimeout"in opts&&0!==opts.requestTimeout&&(self._fetchTimer=global.setTimeout(function(){self.emit("requestTimeout"),self._fetchAbortController&&self._fetchAbortController.abort()},opts.requestTimeout))}global.fetch(self._opts.url,{method:self._opts.method,headers:headersList,body:body||void 0,mode:"cors",credentials:opts.withCredentials?"include":"same-origin",signal:signal}).then(function(response){self._fetchResponse=response,self._connect()},function(reason){global.clearTimeout(self._fetchTimer),self._destroyed||self.emit("error",reason)})}else{var xhr=self._xhr=new global.XMLHttpRequest;try{xhr.open(self._opts.method,self._opts.url,!0)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}"responseType"in xhr&&(xhr.responseType=self._mode.split(":")[0]),"withCredentials"in xhr&&(xhr.withCredentials=!!opts.withCredentials),"text"===self._mode&&"overrideMimeType"in xhr&&xhr.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in opts&&(xhr.timeout=opts.requestTimeout,xhr.ontimeout=function(){self.emit("requestTimeout")}),headersList.forEach(function(header){xhr.setRequestHeader(header[0],header[1])}),self._response=null,xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress()}},"moz-chunked-arraybuffer"===self._mode&&(xhr.onprogress=function(){self._onXHRProgress()}),xhr.onerror=function(){self._destroyed||self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}}}},ClientRequest.prototype._onXHRProgress=function(){(function(xhr){try{var status=xhr.status;return null!==status&&0!==status}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var self=this;self._destroyed||(self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode,self._fetchTimer),self._response.on("error",function(err){self.emit("error",err)}),self.emit("response",self._response))},ClientRequest.prototype._write=function(chunk,encoding,cb){this._body.push(chunk),cb()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){this._destroyed=!0,global.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},ClientRequest.prototype.end=function(data,encoding,cb){"function"==typeof data&&(cb=data,data=void 0),stream.Writable.prototype.end.call(this,data,encoding,cb)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":111,"./response":113,_process:89,buffer:17,inherits:61,"readable-stream":104,"to-arraybuffer":119}],113:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability"),inherits=require("inherits"),stream=require("readable-stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(xhr,response,mode,fetchTimer){var self=this;if(stream.Readable.call(self),self._mode=mode,self.headers={},self.rawHeaders=[],self.trailers={},self.rawTrailers=[],self.on("end",function(){process.nextTick(function(){self.emit("close")})}),"fetch"===mode){if(self._fetchResponse=response,self.url=response.url,self.statusCode=response.status,self.statusMessage=response.statusText,response.headers.forEach(function(header,key){self.headers[key.toLowerCase()]=header,self.rawHeaders.push(key,header)}),capability.writableStream){var writable=new WritableStream({write:function(chunk){return new Promise(function(resolve,reject){self._destroyed?reject():self.push(new Buffer(chunk))?resolve():self._resumeFetch=resolve})},close:function(){global.clearTimeout(fetchTimer),self._destroyed||self.push(null)},abort:function(err){self._destroyed||self.emit("error",err)}});try{return void response.body.pipeTo(writable).catch(function(err){global.clearTimeout(fetchTimer),self._destroyed||self.emit("error",err)})}catch(e){}}var reader=response.body.getReader();!function read(){reader.read().then(function(result){if(!self._destroyed){if(result.done)return global.clearTimeout(fetchTimer),void self.push(null);self.push(new Buffer(result.value)),read()}}).catch(function(err){global.clearTimeout(fetchTimer),self._destroyed||self.emit("error",err)})}()}else{if(self._xhr=xhr,self._pos=0,self.url=xhr.responseURL,self.statusCode=xhr.status,self.statusMessage=xhr.statusText,xhr.getAllResponseHeaders().split(/\r?\n/).forEach(function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();"set-cookie"===key?(void 0===self.headers[key]&&(self.headers[key]=[]),self.headers[key].push(matches[2])):void 0!==self.headers[key]?self.headers[key]+=", "+matches[2]:self.headers[key]=matches[2],self.rawHeaders.push(matches[1],matches[2])}}),self._charset="x-user-defined",!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);charsetMatch&&(self._charset=charsetMatch[1].toLowerCase())}self._charset||(self._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){var resolve=this._resumeFetch;resolve&&(this._resumeFetch=null,resolve())},IncomingMessage.prototype._onXHRProgress=function(){var self=this,xhr=self._xhr,response=null;switch(self._mode){case"text:vbarray":if(xhr.readyState!==rStates.DONE)break;try{response=new global.VBArray(xhr.responseBody).toArray()}catch(e){}if(null!==response){self.push(new Buffer(response));break}case"text":try{response=xhr.responseText}catch(e){self._mode="text:vbarray";break}if(response.length>self._pos){var newData=response.substr(self._pos);if("x-user-defined"===self._charset){for(var buffer=new Buffer(newData.length),i=0;i<newData.length;i++)buffer[i]=255&newData.charCodeAt(i);self.push(buffer)}else self.push(newData,self._charset);self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE||!xhr.response)break;response=xhr.response,self.push(new Buffer(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":if(response=xhr.response,xhr.readyState!==rStates.LOADING||!response)break;self.push(new Buffer(new Uint8Array(response)));break;case"ms-stream":if(response=xhr.response,xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader;reader.onprogress=function(){reader.result.byteLength>self._pos&&(self.push(new Buffer(new Uint8Array(reader.result.slice(self._pos)))),self._pos=reader.result.byteLength)},reader.onload=function(){self.push(null)},reader.readAsArrayBuffer(response)}self._xhr.readyState===rStates.DONE&&"ms-stream"!==self._mode&&self.push(null)}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":111,_process:89,buffer:17,inherits:61,"readable-stream":104}],114:[function(require,module,exports){module.exports=function(stream){var rs=stream._readableState;return rs?rs.objectMode?stream.read():stream.read((state=rs,state.buffer.length?state.buffer.head?state.buffer.head.data.length:state.buffer[0].length:state.length)):null;var state}},{}],115:[function(require,module,exports){var defineProperty,stringFromCharCode,floor,fromCodePoint;String.fromCodePoint||(defineProperty=function(){try{var object={},$defineProperty=Object.defineProperty,result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}(),stringFromCharCode=String.fromCharCode,floor=Math.floor,fromCodePoint=function(_){var highSurrogate,lowSurrogate,codeUnits=[],index=-1,length=arguments.length;if(!length)return"";for(var result="";++index<length;){var codePoint=Number(arguments[index]);if(!isFinite(codePoint)||codePoint<0||1114111<codePoint||floor(codePoint)!=codePoint)throw RangeError("Invalid code point: "+codePoint);codePoint<=65535?codeUnits.push(codePoint):(highSurrogate=55296+((codePoint-=65536)>>10),lowSurrogate=codePoint%1024+56320,codeUnits.push(highSurrogate,lowSurrogate)),(index+1==length||16384<codeUnits.length)&&(result+=stringFromCharCode.apply(null,codeUnits),codeUnits.length=0)}return result},defineProperty?defineProperty(String,"fromCodePoint",{value:fromCodePoint,configurable:!0,writable:!0}):String.fromCodePoint=fromCodePoint)},{}],116:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(encoding){switch((encoding=""+encoding)&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function StringDecoder(encoding){var nb;switch(this.encoding=function(enc){var nenc=function(enc){if(!enc)return"utf8";for(var retried;;)switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase(),retried=!0}}(enc);if("string"!=typeof nenc&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}(encoding),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,nb=4;break;case"utf8":this.fillLast=utf8FillLast,nb=4;break;case"base64":this.text=base64Text,this.end=base64End,nb=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(nb)}function utf8CheckByte(byte){return byte<=127?0:byte>>5==6?2:byte>>4==14?3:byte>>3==30?4:byte>>6==2?-1:-2}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed,r=function(self,buf,p){if(128!=(192&buf[0]))return self.lastNeed=0,"�";if(1<self.lastNeed&&1<buf.length){if(128!=(192&buf[1]))return self.lastNeed=1,"�";if(2<self.lastNeed&&2<buf.length&&128!=(192&buf[2]))return self.lastNeed=2,"�"}}(this,buf);return void 0!==r?r:this.lastNeed<=buf.length?(buf.copy(this.lastChar,p,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(buf.copy(this.lastChar,p,0,buf.length),void(this.lastNeed-=buf.length))}function utf16Text(buf,i){if((buf.length-i)%2==0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(55296<=c&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=buf[buf.length-1],buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;return 0===n?buf.toString("base64",i):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=buf[buf.length-1]:(this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1]),buf.toString("base64",i,buf.length-n))}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}(exports.StringDecoder=StringDecoder).prototype.write=function(buf){if(0===buf.length)return"";var r,i;if(this.lastNeed){if(void 0===(r=this.fillLast(buf)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<buf.length?r?r+this.text(buf,i):this.text(buf,i):r||""},StringDecoder.prototype.end=function(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+"�":r},StringDecoder.prototype.text=function(buf,i){var total=function(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(0<=nb)return 0<nb&&(self.lastNeed=nb-1),nb;if(--j<i||-2===nb)return 0;if(0<=(nb=utf8CheckByte(buf[j])))return 0<nb&&(self.lastNeed=nb-2),nb;if(--j<i||-2===nb)return 0;if(0<=(nb=utf8CheckByte(buf[j])))return 0<nb&&(2===nb?nb=0:self.lastNeed=nb-3),nb;return 0}(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);return buf.copy(this.lastChar,0,end),buf.toString("utf8",i,end)},StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length)return buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length),this.lastNeed-=buf.length}},{"safe-buffer":107}],117:[function(require,module,exports){(function(process){var Transform=require("readable-stream/transform"),inherits=require("util").inherits,xtend=require("xtend");function DestroyableTransform(opts){Transform.call(this,opts),this._destroyed=!1}function noop(chunk,enc,callback){callback(null,chunk)}function through2(construct){return function(options,transform,flush){return"function"==typeof options&&(flush=transform,transform=options,options={}),"function"!=typeof transform&&(transform=noop),"function"!=typeof flush&&(flush=null),construct(options,transform,flush)}}inherits(DestroyableTransform,Transform),DestroyableTransform.prototype.destroy=function(err){if(!this._destroyed){this._destroyed=!0;var self=this;process.nextTick(function(){err&&self.emit("error",err),self.emit("close")})}},module.exports=through2(function(options,transform,flush){var t2=new DestroyableTransform(options);return t2._transform=transform,flush&&(t2._flush=flush),t2}),module.exports.ctor=through2(function(options,transform,flush){function Through2(override){if(!(this instanceof Through2))return new Through2(override);this.options=xtend(options,override),DestroyableTransform.call(this,this.options)}return inherits(Through2,DestroyableTransform),Through2.prototype._transform=transform,flush&&(Through2.prototype._flush=flush),Through2}),module.exports.obj=through2(function(options,transform,flush){var t2=new DestroyableTransform(xtend({objectMode:!0,highWaterMark:16},options));return t2._transform=transform,flush&&(t2._flush=flush),t2})}).call(this,require("_process"))},{_process:89,"readable-stream/transform":105,util:124,xtend:129}],118:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":89,timers:118}],119:[function(require,module,exports){var Buffer=require("buffer").Buffer;module.exports=function(buf){if(buf instanceof Uint8Array){if(0===buf.byteOffset&&buf.byteLength===buf.buffer.byteLength)return buf.buffer;if("function"==typeof buf.buffer.slice)return buf.buffer.slice(buf.byteOffset,buf.byteOffset+buf.byteLength)}if(Buffer.isBuffer(buf)){for(var arrayCopy=new Uint8Array(buf.length),len=buf.length,i=0;i<len;i++)arrayCopy[i]=buf[i];return arrayCopy.buffer}throw new Error("Argument must be a Buffer")}},{buffer:17}],120:[function(require,module,exports){"use strict";var punycode=require("punycode"),util=require("./util");function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},exports.resolveObject=function(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative},exports.format=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)},exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)127<part.charCodeAt(j)?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&0<result.host.indexOf("@"))&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||1<srcPath.length)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;0<=i;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&0<result.host.indexOf("@"))&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":121,punycode:90,querystring:93}],121:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}],122:[function(require,module,exports){(function(global){function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=function(fn,msg){if(config("noDeprecation"))return fn;var warned=!1;return function(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],123:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments)},{dup:12}],124:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments)},{"./support/isBuffer":123,_process:89,dup:13,inherits:61}],125:[function(require,module,exports){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=weakMapPermitHostObjects);var doubleWeakMapCheckSilentFailure=!1;if("function"==typeof WeakMap){var HostWeakMap=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var testMap=new HostWeakMap,testObject=Object.freeze({});if(testMap.set(testObject,1),1===testMap.get(testObject))return module.exports=WeakMap;doubleWeakMapCheckSilentFailure=!0}}Object.prototype.hasOwnProperty;var gopn=Object.getOwnPropertyNames,defProp=Object.defineProperty,isExtensible=Object.isExtensible,HIDDEN_NAME="weakmap:ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var ab=new ArrayBuffer(25),u8s=new Uint8Array(ab);crypto.getRandomValues(u8s),HIDDEN_NAME="weakmap:rand:"+Array.prototype.map.call(u8s,function(u8){return(u8%36).toString(36)}).join("")+"___"}if(defProp(Object,"getOwnPropertyNames",{value:function(obj){return gopn(obj).filter(isNotHiddenName)}}),"getPropertyNames"in Object){var originalGetPropertyNames=Object.getPropertyNames;defProp(Object,"getPropertyNames",{value:function(obj){return originalGetPropertyNames(obj).filter(isNotHiddenName)}})}!function(){var oldFreeze=Object.freeze;defProp(Object,"freeze",{value:function(obj){return getHiddenRecord(obj),oldFreeze(obj)}});var oldSeal=Object.seal;defProp(Object,"seal",{value:function(obj){return getHiddenRecord(obj),oldSeal(obj)}});var oldPreventExtensions=Object.preventExtensions;defProp(Object,"preventExtensions",{value:function(obj){return getHiddenRecord(obj),oldPreventExtensions(obj)}})}();var calledAsFunctionWarningDone=!1,nextId=0,OurWeakMap=function(){this instanceof OurWeakMap||calledAsFunctionWarning();var keys=[],values=[],id=nextId++;return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(function(key,opt_default){var index,hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord?hiddenRecord[id]:opt_default:0<=(index=keys.indexOf(key))?values[index]:opt_default})},has___:{value:constFunc(function(key){var hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord:0<=keys.indexOf(key)})},set___:{value:constFunc(function(key,value){var index,hiddenRecord=getHiddenRecord(key);return hiddenRecord?hiddenRecord[id]=value:0<=(index=keys.indexOf(key))?values[index]=value:(index=keys.length,values[index]=value,keys[index]=key),this})},delete___:{value:constFunc(function(key){var index,lastIndex,hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord&&delete hiddenRecord[id]:!((index=keys.indexOf(key))<0||(lastIndex=keys.length-1,keys[index]=void 0,values[index]=values[lastIndex],keys[index]=keys[lastIndex],keys.length=lastIndex,values.length=lastIndex,0))})}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function(key,opt_default){return this.get___(key,opt_default)},writable:!0,configurable:!0},has:{value:function(key){return this.has___(key)},writable:!0,configurable:!0},set:{value:function(key,value){return this.set___(key,value)},writable:!0,configurable:!0},delete:{value:function(key){return this.delete___(key)},writable:!0,configurable:!0}}),"function"==typeof HostWeakMap?function(){function DoubleWeakMap(){this instanceof OurWeakMap||calledAsFunctionWarning();var dset,hmap=new HostWeakMap,omap=void 0,enableSwitching=!1;return dset=doubleWeakMapCheckSilentFailure?function(key,value){return hmap.set(key,value),hmap.has(key)||(omap||(omap=new OurWeakMap),omap.set(key,value)),this}:function(key,value){if(enableSwitching)try{hmap.set(key,value)}catch(e){omap||(omap=new OurWeakMap),omap.set___(key,value)}else hmap.set(key,value);return this},Object.create(OurWeakMap.prototype,{get___:{value:constFunc(function(key,opt_default){return omap?hmap.has(key)?hmap.get(key):omap.get___(key,opt_default):hmap.get(key,opt_default)})},has___:{value:constFunc(function(key){return hmap.has(key)||!!omap&&omap.has___(key)})},set___:{value:constFunc(dset)},delete___:{value:constFunc(function(key){var result=!!hmap.delete(key);return omap&&omap.delete___(key)||result})},permitHostObjects___:{value:constFunc(function(token){if(token!==weakMapPermitHostObjects)throw new Error("bogus call to permitHostObjects___");enableSwitching=!0})}})}doubleWeakMapCheckSilentFailure&&"undefined"!=typeof Proxy&&(Proxy=void 0),DoubleWeakMap.prototype=OurWeakMap.prototype,module.exports=DoubleWeakMap,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),module.exports=OurWeakMap)}function weakMapPermitHostObjects(map){map.permitHostObjects___&&map.permitHostObjects___(weakMapPermitHostObjects)}function isNotHiddenName(name){return!("weakmap:"==name.substr(0,"weakmap:".length)&&"___"===name.substr(name.length-3))}function getHiddenRecord(key){if(key!==Object(key))throw new TypeError("Not an object: "+key);var hiddenRecord=key[HIDDEN_NAME];if(hiddenRecord&&hiddenRecord.key===key)return hiddenRecord;if(isExtensible(key)){hiddenRecord={key:key};try{return defProp(key,HIDDEN_NAME,{value:hiddenRecord,writable:!1,enumerable:!1,configurable:!1}),hiddenRecord}catch(error){return}}}function constFunc(func){return func.prototype=null,Object.freeze(func)}function calledAsFunctionWarning(){calledAsFunctionWarningDone||"undefined"==typeof console||(calledAsFunctionWarningDone=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],126:[function(require,module,exports){(function(process,global,Buffer){"use strict";var through=require("through2"),duplexify=require("duplexify"),WS=require("ws");module.exports=function(target,protocols,options){var stream,socket,isBrowser="browser"===process.title,isNative=!!global.WebSocket,socketWrite=isBrowser?function socketWriteBrowser(chunk,enc,next){if(socket.bufferedAmount>bufferSize)return void setTimeout(socketWriteBrowser,bufferTimeout,chunk,enc,next);coerceToBuffer&&"string"==typeof chunk&&(chunk=new Buffer(chunk,"utf8"));try{socket.send(chunk)}catch(err){return next(err)}next()}:function(chunk,enc,next){coerceToBuffer&&"string"==typeof chunk&&(chunk=new Buffer(chunk,"utf8"));socket.send(chunk,next)},proxy=through.obj(socketWrite,function(done){socket.close(),done()});protocols&&!Array.isArray(protocols)&&"object"==typeof protocols&&(options=protocols,protocols=null,("string"==typeof options.protocol||Array.isArray(options.protocol))&&(protocols=options.protocol));options||(options={});var bufferSize=options.browserBufferSize||524288,bufferTimeout=options.browserBufferTimeout||1e3;"object"==typeof target?socket=target:(socket=isNative&&isBrowser?new WS(target,protocols):new WS(target,protocols,options)).binaryType="arraybuffer";socket.readyState===WS.OPEN?stream=proxy:(stream=duplexify.obj(),socket.onopen=function(){stream.setReadable(proxy),stream.setWritable(proxy),stream.emit("connect")});(stream.socket=socket).onclose=function(){stream.end(),stream.destroy()},socket.onerror=function(err){stream.destroy(err)},socket.onmessage=function(event){var data=event.data;data=data instanceof ArrayBuffer?new Buffer(new Uint8Array(data)):new Buffer(data);proxy.push(data)},proxy.on("close",function(){socket.close()});var coerceToBuffer=options.binary||void 0===options.binary;return stream}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{_process:89,buffer:17,duplexify:43,through2:117,ws:127}],127:[function(require,module,exports){var ws=null;ws="undefined"!=typeof WebSocket?WebSocket:"undefined"!=typeof MozWebSocket?MozWebSocket:window.WebSocket||window.MozWebSocket,module.exports=ws},{}],128:[function(require,module,exports){module.exports=function wrappy(fn,cb){if(fn&&cb)return wrappy(fn)(cb);if("function"!=typeof fn)throw new TypeError("need wrapper function");Object.keys(fn).forEach(function(k){wrapper[k]=fn[k]});return wrapper;function wrapper(){for(var args=new Array(arguments.length),i=0;i<args.length;i++)args[i]=arguments[i];var ret=fn.apply(this,args),cb=args[args.length-1];return"function"==typeof ret&&ret!==cb&&Object.keys(cb).forEach(function(k){ret[k]=cb[k]}),ret}}},{}],129:[function(require,module,exports){module.exports=function(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};var hasOwnProperty=Object.prototype.hasOwnProperty},{}],"/lib/http2-cache.js":[function(require,module,exports){!function(root){if("undefined"==typeof XMLHttpRequest)throw new Error("XMLHttpRequest is not supported.");if(void 0===XMLHttpRequest.configuration){var Configuration=require("./configuration.js");(0,require("./xhr.js").enableXHROverH2)(XMLHttpRequest,new Configuration({debug:!1}))}}()},{"./configuration.js":4,"./xhr.js":9}]},{},[])("/lib/http2-cache.js")});
